;------------------------------------------------------------------------------
; Ugluk
Object IsengardUgluk
    ; *** ART Parameters ***

    ; ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
    ; This is required for garrisoned objects - please put in all objects.
    ButtonImage = HIUgluk

    ; SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
    SelectPortrait = HPUgluk
   
    Draw = W3DScriptedModelDraw ModuleTag_DRAW

    StaticModelLODMode = No ; Will append M or L to the skin name depending on GameLOD
        
        OkToChangeModelColor = No
        
        ;ExtraPublicBone = arrrow
        
		DefaultModelConditionState
			Model               = iuugluk_skn
		End

		ModelConditionState = WEAPONSET_HERO_MODE
			;ParticleSysBone = BAT_RIBS BladeMaster FollowBone:Yes
		End
		
		AnimationState			= PACKING_TYPE_1
			StateName		= SPELL
			Animation           
				AnimationName     = KUKng_SKL.KUKng_SPCA
				AnimationMode     = ONCE
			End
		End
		
		AnimationState			= PACKING_TYPE_2
			StateName		= SPELL
			Animation           
				AnimationName     = KUKng_SKL.KUKng_LVLA
				AnimationMode     = ONCE
			End
			;FXEvent	= Frame:30 Name: FX_UglukHeadHuntStart
		End
		
		IdleAnimationState
			StateName				= Idle
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLB
				AnimationPriority	= 4
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLC
				AnimationPriority	= 1
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLD
				AnimationPriority = 1
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Animation
				AnimationName       = KUKng_SKL.KUKng_IDLE
				AnimationPriority = 1
				AnimationBlendTime	= 10
				AnimationMode       = ONCE
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE		
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") end
			EndScript	
		End
				
;		AnimationState				=	DYING BURNINGDEATH
;			Animation
;				AnimationName		=	KUKng_SKL.KUKng_DTHA
;				AnimationMode		=	ONCE
;				AnimationBlendTime	=	10
;			End
;		End
		

		AnimationState = DYING
			Animation
				AnimationName       = KUKng_SKL.KUKng_DTHA
				AnimationMode       = ONCE
			End
		End
		
;		AnimationState				=	BURNINGDEATH
;			Animation
;				AnimationName		=	KUKng_SKL.KUKng_MFDA
;				AnimationMode		=	LOOP
;				Distance			=	90
;			End
;		End

		AnimationState = FREEFALL
			Animation
				AnimationName = KUKng_SKL.KUKng_FLYA
				AnimationMode = LOOP
			End
			Flags = RANDOMSTART
		End
		
		AnimationState = STUNNED_FLAILING
			Animation
				AnimationName = KUKng_SKL.KUKng_FLYA
				AnimationMode = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags = RANDOMSTART
		End

		AnimationState				=	DYING SPLATTED
			Animation
				AnimationName		=	KUKng_SKL.KUKng_LNDA
				AnimationMode		=	ONCE
			End
		End

		AnimationState = STUNNED_STANDING_UP
			Animation
				AnimationName = KUKng_SKL.KUKng_GTPA
				AnimationMode = ONCE
			End
		End		

		AnimationState			= STUNNED 
			Animation
				AnimationName   = KUKng_SKL.KUKng_LNDA
				AnimationMode   = ONCE
			End
		End

		AnimationState = MOVING FIRING_OR_PREATTACK_A
			Animation
				AnimationName = KUKng_SKL.KUKng_RUNB
				AnimationMode = LOOP
			End
			
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End
				
		AnimationState = FIRING_OR_PREATTACK_A
			Animation
				AnimationName = KUKng_SKL.KUKng_ATKA
				AnimationMode = ONCE
			End
			Animation
				AnimationName = KUKng_SKL.KUKng_ATKB
				AnimationMode = ONCE
			End
			Animation
				AnimationName = KUKng_SKL.KUKng_ATKC
				AnimationMode = ONCE
			End
			Animation
				AnimationName = KUKng_SKL.KUKng_SPCB
				AnimationMode = ONCE
			End
		End

		AnimationState = MOVING
			Animation
				AnimationName = KUKng_SKL.KUKng_RUNB
				AnimationMode = LOOP
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End

		; --------- Click and Hit Reactions ------------
		AnimationState = HIT_REACTION HIT_LEVEL_1
			Animation = Hit_Level_1_a
				AnimationName = KUKng_SKL.KUKng_HITA
				AnimationMode = ONCE
			End
		End
			
		AnimationState = LEVELED
			Animation = Hit_Level_1_a
				AnimationName = KUKng_SKL.KUKng_LVLA
				AnimationMode = ONCE
			End
		End			
			
;		AnimationState = ENGAGED
;			Animation
;				AnimationName = KUKng_SKL.KUKng_APPA
;				AnimationMode = LOOP
;			End
;		End
		
		
		AnimationState = EMOTION_CELEBRATING
			Animation
				AnimationName = KUKng_SKL.KUKng_CHRA
				AnimationMode = LOOP
			End
		End
		
		AnimationState							= EMOTION_TAUNTING
			Animation							= TNTA
				AnimationName					= KUKng_SKL.KUKng_TNTA
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
		End
				
		; AnimationState = RAISING_FLAG
		; 	Animation
		; 		AnimationName = KUKng_SKL.KUKng_CHRA
		; 		AnimationMode = LOOP
		; 	End
		; End

		AnimationState = SELECTED
			Animation
				AnimationName = KUKng_SKL.KUKng_ATNB
				AnimationMode = LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
			EndScript			
		End
		
    	TransitionState = TRANS_Idle_to_Selected
		Animation = ATNA
			AnimationName		= KUKng_SKL.KUKng_ATNA
			AnimationMode		= ONCE
			AnimationBlendTime	= 10
		End
    	End
    
    	TransitionState = TRANS_Selected_to_Idle
		Animation = ATNF
			AnimationName		= KUKng_SKL.KUKng_ATNC
			AnimationMode		= ONCE
			AnimationBlendTime	= 10
		End
    	End
    	
    	
		; --- Morgul Blade Weapon anim
		AnimationState        = SPECIAL_WEAPON_ONE
			StateName		= Attacking
			Animation             = SPCB
				AnimationName       = KUKng_SKL.KUKng_SPCB
				AnimationMode       = ONCE
			End
		End
		
		AnimationState			= SPECIAL_POWER_1
			StateName		= SPECIAL_POWER_1
			Animation           
				AnimationName     = KUKng_SKL.KUKng_SPCD
				AnimationMode     = ONCE
			End
		End
		
		AnimationState			= SPECIAL_POWER_2
			StateName		= SPECIAL_POWER_2
			Animation           
				AnimationName     = KUKng_SKL.KUKng_SPCA
				AnimationMode     = ONCE
			End
		End
    	
	End


    ; ***DESIGN parameters ***
    Side = Isengard
    EditorSorting = UNIT
    ThreatLevel = 4.0
    ThingClass = CHARACTER_UNIT
    BuildCost         = M_UGLUK_BUILDCOST
    BuildTime         = M_UGLUK_BUILDTIME
    BountyValue			= SAF_BOLG_BOUNTY_VALUE

    DisplayMeleeDamage = M_UGLUK_DAMAGE	

    MaxSimultaneousOfType = 1
  
    TransportSlotCount = 1
    WeaponSet
        Conditions = None
        Weapon = PRIMARY    UglukWeapon
    End
    WeaponSet
        Conditions = WEAPONSET_HERO_MODE
        Weapon = PRIMARY    UglukCarnageWeapon
    End

    ArmorSet
        Conditions      = None
        Armor           = HeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = M_VISION_STANDARD_MELEE
    ShroudClearingRange = M_SHROUD_CLEAR_STANDARD

    DisplayName = OBJECT:IsengardUgluk
    RecruitText        = CONTROLBAR:IsengardUglukRecruit
    ReviveText        = CONTROLBAR:IsengardUglukRevive
    Hotkey            = CONTROLBAR:IsengardUglukHotkey
    CrushableLevel = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
    CrusherLevel = 0 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles

    CommandSet = IsengardUglukCommandSet
    CommandPoints = 0


    ; *** AUDIO Parameters ***;

    VoiceAttack            = UglukVoiceAttack
    VoiceAttack2            = OrcVoiceAttack2
    VoiceAttackAir            = UglukVoiceAttack
    VoiceAttackAir2            = OrcVoiceAttack2
    ;VoiceAttackCharge        = LurtzVoiceAttackCharge
    VoiceAttackMachine        = UglukVoiceAttack
    ;VoiceAttackStructure        = LurtzVoiceAttackBuilding
    ;VoiceFear             = LurtzVoiceHelpMe
    ;VoiceCreated            = CampOrcCreateLurtz    ;LurtzVoiceSalute        ;this conflicts with his respawn dialogue line -- rehooked to spawn FX
    ;VoiceFullyCreated         = CampOrcCreateLurtz    ;LurtzVoiceSalute        ;this conflicts with his respawn dialogue line -- rehooked to spawn FX
    VoiceGuard            = UglukVoiceMove
    VoiceMove            = UglukVoiceMove
    VoiceMove2            = OrcVoiceMove2
    ;VoiceMoveToCamp        = LurtzVoiceMoveCamp
    VoiceMoveWhileAttacking        = UglukVoiceMove
    VoicePriority            = 66
    VoiceSelect            = UglukVoiceSelect
    VoiceSelect2            = HeroVoiceSelect2
    ;VoiceSelectBattle         = LurtzVoiceSelectBattle
    
    ;VoiceEnterStateAttackCharge    = LurtzVoiceEnterStateAttackCharge
    
    SoundImpact            = ImpactHorse

    EvaEventDamagedOwner        = UnitUnderAttack         ;Eva event to trigger when unit is damaged
    ;EvaEventDieOwner        = LurtzDie                ;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU    ;Tie into LargeGroupAudio system
        Key = Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound: ArrowDrawBow        Animation: IULurtz_SKL.IULurtz_CRPL        Frames: 0
        AnimationSound = Sound: ArrowDrawBow        Animation: IULurtz_SKL.IULurtz_ATKA1    Frames: 4
        AnimationSound = Sound: ArrowDrawBow        Animation: IULurtz_SKL.IULurtz_ATKA2    Frames: 17
        AnimationSound = Sound: ImpactSword02        Animation: IULurtz_SKL.IULurtz_ATKC        Frames: 21 37
        AnimationSound = Sound: ImpactSword02        Animation: IULurtz_SKL.IULurtz_ATKI        Frames: 28 49
        AnimationSound = Sound: ImpactSword02        Animation: IULurtz_SKL.IULurtz_ATKJ        Frames: 19 39
        AnimationSound = Sound: FootstepDirtA        Animation: IULurtz_SKL.IULurtz_RUNA        Frames: 10 20
        AnimationSound = Sound: FootstepDirtA        Animation: IULurtz_SKL.IULurtz_RUNB        Frames: 8 18
        AnimationSound = Sound: FootstepDirtA        Animation: IULurtz_SKL.IULurtz_RUNC        Frames: 10 20 31 41
        AnimationSound = Sound: FootstepDirtA        Animation: IULurtz_SKL.IULurtz_RUND        Frames: 8 18 27 37
        AnimationSound = Sound: BodyFallOrc            Animation: IULurtz_SKL.IULurtz_DIEA        Frames: 43
        AnimationSound = Sound: BodyFallOrc            Animation: IULurtz_SKL.IULurtz_LNDA        Frames: 3
        AnimationSound = Sound: BodyFallOrc            Animation: IULurtz_SKL.IULurtz_LNDB        Frames: 3
        AnimationSound = Sound: BodyFallGeneric2        Animation: IULurtz_SKL.IULurtz_DIEB        Frames: 82

        AnimationSound = Sound: WeaponSwitchBow        Animation: IULurtz_SKL.IULurtz_IDLL        Frames: 59
        AnimationSound = Sound: SwordShingDirty1        Animation: IULurtz_SKL.IULurtz_IDLM        Frames: 56

        AnimationSound = Sound: WeaponSwitchBow        Animation: IULurtz_SKL.IULurtz_IDLN        Frames: 10
        AnimationSound = Sound: SwordShingDirty1        Animation: IULurtz_SKL.IULurtz_IDLO        Frames: 3

        ;AnimationSound = Sound: ??????            Animation: IULurtz_SKL.IULurtz_TNTB        Frames: 28
    End


    ; *** ENGINEERING Parameters ***

    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY CAN_USE_SIEGE_TOWER URUK
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius             = M_EMOTION_CHEER_RADIUS
        MaxHealth                 = M_UGLUK_HEALTH    ;BALANCE Lurtz Health
        PermanentlyKilledByFilter    = NONE        ;Who kills me permanently?
        DodgePercent             = M_HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                = DYING ;STUNNED            ;Model condition to play when killed-to-respawn
        DeathFX                = FX_GenericEvilHeroDieToRespawn        ;FXList to play when killed-to-respawn
        DeathAnimationTime        = 6033 ; 1133            ;How long DeathAnim will take.
        InitialSpawnFX            = FX_GenericEvilInitialSpawn
        RespawnAnim                = LEVELED                ;Animation to play when respawning.
        RespawnFX                = FX_GenericEvilInitialSpawn            ;FXList to play when respawning.
        RespawnAnimationTime        = 2000                ;Time it takes for respawn to play.
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP        ;Respawn at this location -- and at it's exit production point if possible.
        ButtonImage                = HIUgluk_Res
    
    ;RespawnEntries determine the ruleset for how a character can be revived. Some units may automatically respawn, others
    ;may require a specific revive action performed on him. You can specify different values for each level... or use Level:Any
        RespawnRules =    AutoSpawn:No    Cost:600        Time:90000        Health:100%        ;DEFAULT VALUES
        RespawnEntry =    Level:2        Cost:700        Time:90000                    ;For other levels, only override what is different.
        RespawnEntry =    Level:3        Cost:800        Time:90000
        RespawnEntry =    Level:4        Cost:900        Time:90000
        RespawnEntry =    Level:5        Cost:1000        Time:120000
        RespawnEntry =    Level:6        Cost:1100        Time:120000
        RespawnEntry =    Level:7        Cost:1200        Time:120000
        RespawnEntry =    Level:8        Cost:1300        Time:120000
        RespawnEntry =    Level:9        Cost:1400        Time:120000
        RespawnEntry =    Level:10    Cost:1500        Time:120000
    End
	
    ;;; UGLUK SUPPER ;;;
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AthelasEnabler
        SpecialPowerTemplate = SpecialAbilityUglukSupper
        TriggeredBy = Upgrade_GenericUpgrade3
    End
	
    Behavior = SpecialPowerModule ModuleTag_AragornAthelas1
        SpecialPowerTemplate    = SpecialAbilityUglukSupper
        UpdateModuleStartsAttack  = Yes
        TriggerFX                = FX_UglukSupper
        SetModelCondition        = ModelConditionState:EMOTION_CELEBRATING
        SetModelConditionTime    = 2.1
        StartsPaused = Yes
    End
    
    Behavior = SpecialAbilityUpdate ModuleTag_AragornAthelasUpdate1
        SpecialPowerTemplate    = SpecialAbilityUglukSupper
        StartAbilityRange       = 1.6
        UnpackTime              = 1        ; Nothing to touching it
        PreparationTime         = 3        ; touching it to grabbing it
        PackTime                = 2096  ; whacking it to holding it nice
        AwardXPForTriggering    = 0
    End
	
	; Athelas needs to be first because the special power just turns on the first one it finds.  No time to fix it better.
    Behavior = AutoHealBehavior ModuleTag_AthelasHealing1
        StartsActive                = Yes    ; Active, as in no upgrade required
        ButtonTriggered                = Yes    ; But doesn't actually run on its own.
        HealingAmount                = 600
        Radius                    = 200
        HealOnlyOthers                = No
        SingleBurst                = Yes
        UnitHealPulseFX                = FX_UglukSupper
        KindOf                    = URUK
    End

    Behavior = AutoHealBehavior ModuleTag_UglukHealing
        StartsActive = Yes
        HealingAmount = M_HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = M_HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
		;HoldGroundCloseRangeDistance = 50
        AttackPriority                =     AttackPriority_Archer
    End

    LocomotorSet
        Locomotor = IsengardLurtzLocomotor
        Condition = SET_NORMAL 
        Speed     = M_NORMAL_EVIL_HERO_SPEED
    End
    
    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER 
        Speed     = 55
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime = 2000 ; (2 secs)
    End
    
    Behavior = DualWeaponBehavior ModuleTag_09
        SwitchWeaponOnCloseRangeDistance = 40
    End
    
    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes        = ALL 
        SinkDelay        = 6000
        SinkRate        = 1.5     ; in Dist/Sec
        DestructionDelay    = 11000
        Sound            = INITIAL LurtzVoiceDie
    End
    
    Behavior = SquishCollide ModuleTag_06
        ;nothing
    End

    ;;; AUTO ABILITY MODULE ;;;
    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehavior
    End        
    
    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2500 ; level 1 (light  damage)  hit reaction animations in frames (5 per sec)
        HitReactionThreshold1 = 0.0   ; level 1 (light  damage) threshold trigger
    End
    
    ;;; UGLUK PASSIVE LEADERSHIP ABILITY ;;;    
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_GenericUpgrade2
    End
    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate   
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End    
    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive    = No ;If no, requires upgrade to turn on.
        BonusName        = UglukPassiveLeadership
        TriggeredBy        = Upgrade_GenericUpgrade2
        RefreshDelay    = 2500
        Range            = 200
        ObjectFilter    = NONE +INFANTRY -STRUCTURE -BASE_FOUNDATION +HERO
    End

    ; -------------- Spawn Reinforcements ----------------- ;
    	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FaramirRangersEnabler1
        SpecialPowerTemplate = SuperweaponLurtzScouts
        TriggeredBy = Upgrade_GenericUpgrade5
    End
	
    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPower1
        SpecialPowerTemplate    = SuperweaponLurtzScouts
        OCL                        = OCL_LurtzScoutEgg
        CreateLocation       = USE_OWNER_OBJECT
        StartsPaused            = Yes
        SetModelCondition        = ModelConditionState:USER_1
        SetModelConditionTime    = 8.1
		TriggerFX			 = FX_GothmogSummon
    End
    ; ------------------------------ HeadHunter ------------------------------ ; 
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler
        SpecialPowerTemplate = SpecialAbilityTheodenGloriousCharge
        TriggeredBy = Upgrade_GenericUpgrade7
    End
    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate   
        SpecialPowerTemplate      = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
        AttributeModifier = UglukHeadHunterModifier
        AttributeModifierRange = 200
        AttributeModifierAffectsSelf = No
        AttributeModifierAffects = NONE +IsengardFighterHorde +IsengardFighter +HERO
        AttributeModifierFX = FX_TheodenGloriousChargeFX
    End
    
    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime              = 1000
        UnpackingVariation        = 1
        
        SpecialPowerTemplate    = SpecialAbilityTheodenGloriousCharge
         PreparationTime         = 0  
         PersistentPrepTime      = 0
         PackTime                = 1330
    End  
    ; ------------------------------------------------------------------------ ;
    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
	Shadow = SHADOW_DECAL
    ShadowSizeX = 19;
    ShadowSizeY = 19;
    ShadowTexture = ShadowI;
End
