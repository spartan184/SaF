Object GundabadUrshak
    ; *** ART Parameters ***
    
    ; SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
    SelectPortrait = HPUrshak
    ButtonImage = HIUrshak
    Draw = W3DScriptedModelDraw ModuleTag_DRAW
	    OkToChangeModelColor = Yes
	    StaticModelLODMode = yes

        DefaultModelConditionState
            Model            = wuSurshak_skn
        End
		ModelConditionState = WORLD_BUILDER
			Model = wuSurshak_skn
			Skeleton = KUKng_SKL
		End

        ; --- Idle Anims
        IdleAnimationState
            StateName = STATE_Idle
            Animation = IDLB
                AnimationName        = kukng_SKL.kukng_IDLB
                AnimationMode        = ONCE
                AnimationPriority    = 1
            End
            Animation = IDLE
                AnimationName        = kukng_SKL.kukng_IDLE
                AnimationMode        = ONCE
                AnimationPriority    = 1
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected"    then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") return end
            EndScript
        End	

        AnimationState        = SPECIAL_POWER_1
            Animation           
                AnimationName     = kukng_SKL.kukng_SPCD
                AnimationMode     = ONCE
            End
            FrameForPristineBonePositions = 58
            ;EnteringStateFX = FX_BoromirHorn
        End

        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = Attacking_throw
            Animation
                AnimationName        = kukng_SKL.kukng_SPCD
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 58
        End

        ; --- Stunned anims
        AnimationState                =    STUNNED_FLAILING 
            Flags                    =    RANDOMSTART
            Animation                =    kukng_FLYA
                AnimationName        =    kukng_SKL.kukng_FLYA
                AnimationMode        =    LOOP
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End
        
        ; --- Dying anims
        AnimationState                =    DYING SPLATTED
            Animation                =    kukng_LNDA
                AnimationName        =    kukng_SKL.kukng_LNDA
                AnimationMode        =    ONCE
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End
        
        AnimationState                =    DYING
            Animation                =    RUEomer_DIEA
                AnimationName        =    kukng_SKL.kukng_DTHA
                AnimationMode        =    ONCE
            End
        End
        
        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    RUEomer_GTPA
                AnimationName        =    kukng_SKL.kukng_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        
        AnimationState                =    STUNNED 
            Animation                =    RUEomer_LNDA
                AnimationName        =    kukng_SKL.kukng_LNDA
                AnimationMode        =    ONCE
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End
		
		AnimationState			= PACKING_TYPE_2
			StateName		= SPELL
			Animation           
				AnimationName     = KUKng_SKL.KUKng_SPCA
				AnimationMode     = ONCE
			End
		End		
        
        ; --- Moving Anims
        
        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = kukng_SKL.kukng_RUNA
                AnimationMode       = LOOP
            End
            ParticleSysBone        =    None InfantryDustTrails
            Flags               = RANDOMSTART 
        End
        
        AnimationState                = MOVING PANICKING
            Animation                = MFDA
                AnimationName        = kukng_SKL.kukng_MFDA
                AnimationMode        = LOOP
            End
            ParticleSysBone        =    None InfantryDustTrails
            Flags                    = RANDOMSTART
        End
        
        AnimationState = MOVING ATTACKING
            Animation                =    RUEomer_RUNB
                AnimationName        =    kukng_SKL.kukng_RUNA
                AnimationMode        =    LOOP
                Distance            =   50; 30
            End
            ParticleSysBone        =    None InfantryDustTrails
        End
            
        AnimationState                =    MOVING 
            Flags                    =    RANDOMSTART
            Animation                =    RUEomer_RUNA
                AnimationName        =    kukng_SKL.kukng_RUNB
                AnimationMode        =    LOOP
                Distance            =   30
            End
            ParticleSysBone        =    None InfantryDustTrails
        End

        ; Attacking Anims
        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation                =    ATKA
                AnimationName        =    kukng_SKL.kukng_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKB
                AnimationName        =    kukng_SKL.kukng_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKC
                AnimationName        =    kukng_SKL.kukng_ATKC
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            ParticleSysBone        =    None MeleeDust
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End
        
        ; ATTACKING
        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = kukng_SKL.kukng_IDLA
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE ; acts like an idle animation & keeps running the animations.
        End

        
        AnimationState                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    kukng_SKL.kukng_ATNB
                AnimationMode        =    LOOP
            End
            StateName = STATE_Selected
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle"    then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") return end
            EndScript
        End
        
        TransitionState = TRANS_Idle_to_Selected
            Animation = IDLF
                AnimationName        = kukng_SKL.kukng_ATNA ;RUEomer_SKL.RUEomer_IDLF
                AnimationMode        = ONCE
            End        
        End
        
        TransitionState = TRANS_Selected_to_Idle
            Animation            = ATNE
                AnimationName    = kukng_SKL.kukng_ATNC
                AnimationMode    = ONCE
            End        
        End
            
        ;----Emotion Animations
        AnimationState                =    EMOTION_CELEBRATING
                Animation           =    CHRA
                    AnimationName   =    kukng_SKL.kukng_CHRA
                    AnimationMode   =    ONCE
                End
                Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End
        
        AnimationState                    = EMOTION_ALERT EMOTION_MORALE_HIGH
            Animation                    = Taunting
                AnimationName            = kukng_SKL.kukng_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting
                AnimationName            = kukng_SKL.kukng_SPCC
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End
        
        ; READY IDLE
        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = kukng_SKL.kukng_IDLA
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE ; acts like an idle animation & keeps running the animations.
        End
        
        ; --------- Click and Hit Reactions ------------
        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_b
                AnimationName = kukng_SKL.kukng_HITA
                AnimationMode = ONCE
            End
        End	
    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOUNTED MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
            ParticleSysBone = None GenericSiegeTrailDust
        End
    End
    
    ; ***DESIGN parameters ***
    Side = Gundabad
    EditorSorting = UNIT
    ThreatLevel = 4.0
    TransportSlotCount = 1
    ThingClass = CHARACTER_UNIT
    BuildCost           = SAF_URSHAK_BUILDCOST
    BuildTime           = SAF_URSHAK_BUILDTIME
    BountyValue         = 20

    DisplayMeleeDamage = SAF_URSHAK_DAMAGE
    
    WeaponSet
        Conditions          = None
        Weapon              = PRIMARY        GundabadUrshakSword
        AutoChooseSources   = TERTIARY        NONE
    End
  
    ArmorSet
        Conditions      = None
        Armor           = GundabadUrshakArmor
        DamageFX        = None
    End
    
    VisionRange = M_VISION_STANDARD_HORSE                
    ShroudClearingRange = M_SHROUD_CLEAR_HERO    

    DisplayName        = OBJECT:GundabadUrshak
    RecruitText        = CONTROLBAR:GundabadUrshakRecruit
    ReviveText         = CONTROLBAR:GundabadUrshakRevive
    Hotkey             = CONTROLBAR:GundabadUrshakHotkey
    CrushableLevel = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
    CrusherLevel = 0 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles

    CommandSet = UrshakCommandSet
    CommandPoints = 0

    ; *** AUDIO Parameters ***;

	VoiceAttack								= GoblinKingVoiceAttack
	VoiceAttackCharge						= GoblinKingVoiceAttackCharge
	VoiceAttackMachine						= GoblinKingVoiceAttack
	VoiceAttackStructure					= GoblinKingVoiceAttackBuilding
	VoiceFear								= GoblinKingVoiceHelpMe
	VoiceGuard								= GoblinKingVoiceMove
	VoiceMove								= GoblinKingVoiceMove
	VoiceMoveToCamp							= GoblinKingVoiceMoveCamp
	VoiceMoveWhileAttacking					= GoblinKingVoiceDisengage
	VoicePriority							= 88
	VoiceRetreatToCastle					= GoblinKingVoiceRetreat
	VoiceSelect								= GoblinKingVoiceSelect
	VoiceSelectBattle 						= GoblinKingVoiceSelectBattle
	SoundImpact								= ImpactHorse
	UnitSpecificSounds
		VoiceGarrison						= GoblinKingVoiceMoveGarrison
	End

    EvaEventDamagedOwner     = UnitUnderAttack    ;Eva event to trigger when unit is damaged
    EvaEventDieOwner         = UrshakDie        ;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU            ; Tie into LargeGroupAudio system
        Key = Human Unit Infantry Hero
        UnitWeight = 2
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA			Animation:KUKng_SKL.KUKng_RUNA		Frames:4 15
		AnimationSound = Sound:FootstepDirtA			Animation:KUKng_SKL.KUKng_RUNB		Frames:5 15 26 36

		AnimationSound = Sound:TauntHumanHitShield		Animation:KUKng_SKL.KUKng_CHRB		Frames:22 32

        AnimationSound = Sound:BodyFallGenericNoArmor	Animation:KUKng_SKL.KUKng_DIEA		Frames:48
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:KUKng_SKL.KUKng_DIEB		Frames:18
		AnimationSound = Sound:BodyFallSoldier			Animation:KUKng_SKL.KUKng_LNDA		Frames:4
    End

    ; *** ENGINEERING Parameters ***

    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT ARMY_SUMMARY
    PathfindDiameter = 40.0
    
    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                 = M_EMOTION_CHEER_RADIUS
        MaxHealth                     = SAF_URSHAK_HEALTH    ;BALANCE Eomer Health
        PermanentlyKilledByFilter        = NONE        ;Who kills me permanently?
        DodgePercent                  = M_HERO_DODGE_PERCENT
    End
    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                = DYING ;STUNNED        ;Model condition to play when killed-to-respawn
        DeathFX                = FX_SaFEvilDieToRespawn    ;FXList to play when killed-to-respawn
        DeathAnimationTime        = 3333 ;1133        ;How long DeathAnim will take.
        InitialSpawnFX            = FX_UrshakInitialSpawn
        RespawnAnim                = LEVELED            ;Animation to play when respawning.
        RespawnFX                = FX_UrshakRespawn        ;FXList to play when respawning.
        RespawnAnimationTime        = 2000            ;Time it takes for respawn to play.
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP    ;Respawn at this location -- and at it's exit production point if possible.
        ButtonImage                = HIUrshakRes
        
        ;RespawnEntries determine the ruleset for how a character can be revived. Some units may automatically respawn, others
        ;may require a specific revive action performed on him. You can specify different values for each level... or use Level:Any
        RespawnRules =    AutoSpawn:No               Cost:700         Time:90000        Health:100%        ;DEFAULT VALUES ; Cost:600
        RespawnEntry =    Level:2                    Cost:800         Time:90000  ; 700; For other levels, only override what is different.
        RespawnEntry =    Level:3                    Cost:900         Time:90000  ; 800
        RespawnEntry =    Level:4                    Cost:1000        Time:90000  ; 900
        RespawnEntry =    Level:5                    Cost:1100        Time:120000 ; 1000
        RespawnEntry =    Level:6                    Cost:1300        Time:120000 ; 1100
        RespawnEntry =    Level:7                    Cost:1400        Time:120000 ; 1200
        RespawnEntry =    Level:8                    Cost:1500        Time:120000 ; 1300
        RespawnEntry =    Level:9                    Cost:1600        Time:120000 ; 1400
        RespawnEntry =    Level:10                   Cost:1700        Time:120000 ; 1500
    End

    Behavior = AutoHealBehavior ModuleTag_UrshakHealing
        StartsActive = Yes
        HealingAmount = M_HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = M_HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End
    
    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                = UrshakFunctions
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL 
        Speed     = M_SLOW_EVIL_HERO_SPEED
    End
      
    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime = 2533    ;msec        
    End  
      
    Behavior = AttributeModifierAuraUpdate ModuleTag_HeroRadiateFear
        StartsActive    = No ;If no, requires upgrade to turn on.
        BonusName        = HeroRadiateFear
        TriggeredBy        = Upgrade_HeroRadiateFear
        RefreshDelay    = 2000
        Range            = 120
        TargetEnemy        = Yes
        ObjectFilter    = ANY +ORC
    End  
    
    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL 
        SinkDelay = 3000
        SinkRate = 0.40     ; in Dist/Sec
        DestructionDelay = 8000
        Sound = INITIAL UrshakVoiceDie
    End
    
    Behavior = SquishCollide ModuleTag_06
    End

    ;-----------------------------------------------------------------------------
	; Gundabad Chieftan
	;-----------------------------------------------------------------------------
    Behavior = SpecialPowerModule ModuleTag_UrshakLeadershipUpdate   
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = No
    End    
    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive    = Yes
        BonusName        = UrshakPassiveLeadership
        RefreshDelay    = 2500
        Range            = 200
        ObjectFilter    = NONE +GundabadGoblinSwarmHorde ;+ORC +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO
    End

    ;-----------------------------------------------------------------------------
	; Dark Prophecy
	;-----------------------------------------------------------------------------    
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DarkProphecyEnabler
		SpecialPowerTemplate = SpecialAbilityUrshakDarkProphecy
		TriggeredBy = Upgrade_GenericUpgrade5
	End
    Behavior                 = OCLSpecialPower ModuleTag_UrshakDarkProphecySpawnObject
        SpecialPowerTemplate = SpecialAbilityUrshakDarkProphecy
        TriggerFX            = FX_SarumanDominateTrigger
        OCL                  = OCL_DarkProphecy
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
    End
    Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_DreadfangsCallUpdate
        SpecialPowerTemplate    = SpecialAbilityUrshakDarkProphecy
        UnpackTime              = 1 ;900 ;1 ;1700                                ; Drawing the horn
        PreparationTime         = 1                                        ; nothing
        PersistentPrepTime      = 1 ;1100 ;2200 ;1600                                ; Blowing
        PackTime                = 500 ;1 ;1666                                ; Putting horn away
        AwardXPForTriggering    = 0
    End

    ;-----------------------------------------------------------------------------
	; Shadow and Flame
	;-----------------------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SAFEnabler
		SpecialPowerTemplate = SpecialAbilityUrshakSAF
		TriggeredBy = Upgrade_GenericUpgrade8
	End
	Behavior = SpecialPowerModule ModuleTag_SAFStarter       
		SpecialPowerTemplate      = SpecialAbilityUrshakSAF
		UpdateModuleStartsAttack  = Yes
		StartsPaused		  	  = Yes	
        TriggerFX			        = FX_UrshakSAFTrigger
	End
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SAFWeaponUpdate   
		SpecialPowerTemplate    = SpecialAbilityUrshakSAF
		WhichSpecialWeapon		= 2
		SkipContinue			= Yes
		UnpackTime              = 1500 ;500 
		PackTime                = 2500	
		FreezeAfterTriggerDuration = 800
		AwardXPForTriggering    = 0		
		StartAbilityRange		= 100.0
		SpecialWeapon			= UrshakSAFWeapon
	End
    

	Behavior = AutoAbilityBehavior ModuleTag_SAFAutoAbility
	End	
    
    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 20;
    ShadowSizeY = 20;
    ShadowTexture = ShadowI;
End

;------------------------------------------------------------------------------
;Dark Prophecy object
Object DarkProphecy

    ; *** ART Parameters ***
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = none
        End
    End

    ; *** AUDIO Parameters ***
 
    ; ***DESIGN parameters ***
    DisplayName     = OBJECT:DarkProphecy
    Side            = Gundabad
    EditorSorting   = STRUCTURE

    ; *** ENGINEERING Parameters ***  
    RadarPriority       = NOT_ON_RADAR
    KindOf = NOT_AUTOACQUIRABLE PRELOAD SUMMONED IGNORES_SELECT_ALL UNATTACKABLE IGNORED_IN_GUI
  
    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 100000
    End
    
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 30000
        MaxLifetime = 30000
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                = DarkProphecyFunctions
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_UrshakDarkProphecyAntiLeadership
        StartsActive    = Yes ;If no, requires upgrade to turn on.
        BonusName        = UrshakDarkProphecyEffect        
        RefreshDelay    = 2500
        Range            = 100
        TargetEnemy        = Yes
        AntiCategory    = LEADERSHIP ; This means cancel all previous leadership bonuses
        AntiFX            = FX_AntiLeadership ; FX for anti category
        ObjectFilter    = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -BASE_FOUNDATION
    End

    
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay = 0
    End
End

;------------------------------------------------------------------------------
Object DarkProphecyEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE
    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay = 0
        OCL = FINAL OCL_DarkProphecyFinish
        Weapon = FINAL UrshakDarkProphecyStun
    End
End