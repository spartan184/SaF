;------------------------------------------------------------------------------
;
;    Sharku.ini
;
;------------------------------------------------------------------------------
; aka Sharku
Object IsengardSharku
    ; *** ART Parameters ***
    ButtonImage         = HISharku
    SelectPortrait        = HPSharku
    
    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        WadingParticleSys = EntRipples

      OkToChangeModelColor = Yes
      
        StaticModelLODMode = yes

        DefaultModelConditionState
            Model                    = IUSharku_SKN
            Skeleton                = IUWARGRIDR_SKL
        End

        ModelConditionState = COMING_OUT_OF_FACTORY
            Model                    = IUSharku_SKN
            Skeleton                = IUWARGRIDR_SKL
        End

;        ; -- Dreadfangï¿½s Call anims
;        AnimationState        = SPECIAL_POWER_1
;            Animation           
;                AnimationName     = IUWARGRIDR_TNTA
;                AnimationMode     = ONCE
;            End
;            ;-- Anim frame 30 - start howl
;            ;EnteringStateFX = FX_BoromirHorn
;        End
;
        ; -- Scent of Blood anims        
        AnimationState                        =    PACKING_TYPE_1
            StateName                        =    SPELL
            Animation                        =    CHRA
                AnimationName                =    IUWARGRIDR_CHRA
                AnimationSpeedFactorRange    =    0.842 0.842
                AnimationMode                =    ONCE
            End        
        End
        ; -------------- STUNNED ANIMS ----------------
        AnimationState                        = PASSENGER
            Animation                        = Grabbed
                AnimationName                = IUWARGRIDR_GBDA
                AnimationMode                = LOOP
            End
        End
        
        AnimationState                        = FREEFALL
            Animation                        = freefall
                AnimationName                = IUWARGRIDR_FLYB
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
            End
        End
        
        AnimationState                =    STUNNED_FLAILING 
            Animation                =    JustDie
                AnimationName       =    IUWARGRIDR_FLYB
                AnimationMode       =    LOOP
            End
        End

        AnimationState                =    DYING SPLATTED
            Animation                =    splatted
                AnimationName        =    IUWARGRIDR_LNDA
                AnimationMode        =    ONCE
            End
        End
        
        

        AnimationState                =    DYING
            Animation                =    JustDie
                AnimationName        =    IUWARGRIDR_DIEB
                AnimationMode        =    ONCE
            End
        End        
        
        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName       =    IUWARGRIDR_GTPA
                AnimationMode       =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        
        AnimationState                =    STUNNED 
            Animation                =    Land
                AnimationName       =    IUWARGRIDR_LNDA
                AnimationMode       =    ONCE
            End
        End

        ; -------------- MOVING ANIMS ---------------
;        AnimationState  = COMING_OUT_OF_FACTORY
;            Animation = Being_Built
;                AnimationName        = IUWARGRIDR_RUNA
;                AnimationMode        = LOOP
;                AnimationBlendTime    = 0
;            End
;        End        
        
        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation = TrotAndFire
                AnimationName = IUWARGRIDR_ATRA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
        End
        
        AnimationState                =    TURN_LEFT_HIGH_SPEED  
            Animation                =    MTurnLeft
                AnimationName        =    IUWARGRIDR_TNL1
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED
            Animation                =    MTurnRight
                AnimationName        =    IUWARGRIDR_TNR1
                AnimationMode        =    LOOP
            End
        End
        
        AnimationState                =    TURN_LEFT  
            Animation                =    TurnRight
                AnimationName        =    IUWARGRIDR_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    TURN_RIGHT 
            Animation                =    TurnRight
                AnimationName        =    IUWARGRIDR_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    MOVING ACCELERATE 
            Animation                =    Accelerate
                AnimationName        =    IUWARGRIDR_ACCL
                AnimationMode        =    ONCE
            End
        End
    
        AnimationState                =    MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    IUWARGRIDR_DECL
                AnimationMode        =    ONCE
            End
        End
        
        AnimationState                =    MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    IUWARGRIDR_BAKA
                AnimationMode        =    LOOP
            End
        End
        
        AnimationState                =    MOVING
            ShareAnimation            =    Yes
            Animation                =    RunA
                AnimationName        =    IUWARGRIDR_RUNA
                AnimationMode        =    LOOP
            End
        End
        
        ; ----------- ATTACKING ANIMS --------------        
        AnimationState                =    BETWEEN_FIRING_SHOTS_A
            Animation                =    BetweenFiringShots
                AnimationName        =    IUWARGRIDR_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =   10
          End
        End

        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation                =    AttackA3
                AnimationName        =    IUWARGRIDR_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
        ParticleSysBone = None MeleeDust
        End
        
        AnimationState                    = EMOTION_UNCONTROLLABLY_AFRAID
            Animation                    = FERA
                AnimationName            = IUWARGRIDR_FERA
                AnimationMode            = LOOP
            End
        End
                
        AnimationState                =    ATTACKING
            Animation                =    AttackA3
                AnimationName        =    IUWARGRIDR_ATKA
                AnimationMode        =    MANUAL
            End
        ParticleSysBone = None MeleeDust
        End

        ; ----------- WAR CHANT ANIMS -------------
        AnimationState = WAR_CHANT
            Animation = Chant
                AnimationName = IUWARGRIDR_TNTA
                AnimationMode = LOOP
            End
        End

        ; ----------- EMOTION ANIMS ---------------
        AnimationState                    = EMOTION_ALERT EMOTION_AFRAID
            Animation                    = Apprehensive
                AnimationName            = IUWARGRIDR_APPA
                AnimationMode            = LOOP
            End
        End
        
        AnimationState                    = EMOTION_AFRAID
            Animation                    = FERA
                AnimationName            = IUWARGRIDR_FERA
                AnimationMode            = LOOP
            End
        End
                
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = TNTA
                AnimationName            = IUWARGRIDR_PNTA
                AnimationMode            = LOOP
            End
            Flags                    = RANDOMSTART    
        End
        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = IUWARGRIDR_PNTA
                AnimationMode            = LOOP
            End
            Flags                    = RANDOMSTART    
        End
        AnimationState                    = EMOTION_CELEBRATING
            Animation                   = CHRA
                AnimationName            = IUWARGRIDR_CHRA
                AnimationMode            = ONCE
            End
            Flags                    = RANDOMSTART
        End
        
        ; ----------- IDLE ANIMS ---------------
        AnimationState                            = EMOTION_ALERT
            StateName                            = STATE_Ready 
            Animation                            = ALERT
                AnimationName                    = IUWargRidr_IDLA
                AnimationMode                    = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Ready") end
            EndScript    
        End
        
        ; ----------- SELECTED ANIMS --------------
        AnimationState                =    SELECTED
            SimilarRestart            =   Yes
            Animation                =    AtAttention
                AnimationName        =    IUWARGRIDR_ATNB
                AnimationMode        =    LOOP
            End
            StateName                = Selected
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("Idle_to_Selected") end
                if Prev == "STATE_Ready" then CurDrawableSetTransitionAnimState("Ready_to_Selected") end
            EndScript
        End

        IdleAnimationState
            Animation
                AnimationName        =    IUWARGRIDR_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    20
            End
            Animation
                AnimationName        =    IUWARGRIDR_IDLD
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    1
            End
            Animation
                AnimationName        =    IUWARGRIDR_IDLE
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    1
            End
            StateName                = Idle 
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Idle") end
            EndScript
        End

        ;------------ TRANSITION ANIMS ----------------
        TransitionState       = Selected_to_Idle
            Animation           = ATNE
                AnimationName        =    IUWARGRIDR_ATNE
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End
        
        TransitionState       = Idle_to_Selected
            Animation           = ATND
                AnimationName     = IUWARGRIDR_ATND
                AnimationMode   =    ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

        TransitionState       = Ready_to_Selected
            Animation           = ATNC
                AnimationName     = IUWARGRIDR_ATNC
                AnimationMode   =    ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

        TransitionState       = Selected_to_Ready
            Animation           = ATNCReverse
                AnimationName     = IUWARGRIDR_ATNC
                AnimationMode   =    ONCE_BACKWARDS
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End
        
    End
    
    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING USING_COMBO_LOCOMOTOR
        End
        AnimationState = MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING DECELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING
            ParticleSysBone = None GenericSiegeTrailDust
        End
    End


    ; ***DESIGN parameters ***
    Side                     = Isengard
    EditorSorting            = UNIT
    ThreatLevel              = 3.0
    ImmuneToShockwave        = Yes
    ThingClass               = CHARACTER_UNIT
    BuildCost                = M_SHARKU_BUILDCOST
    BuildTime                = M_SHARKU_BUILDTIME
    DisplayMeleeDamage       = M_SHARKU_DAMAGE
    TransportSlotCount       = 1
    
    WeaponSet
        Conditions           = NONE
        Weapon               = PRIMARY    SharkuSword
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    
    ArmorSet
        Conditions           = None
        Armor                = HeroArmorMounted
        DamageFX             = NormalDamageFX
    End

    VisionRange              = M_VISION_STANDARD_HORSE                
    ShroudClearingRange      = M_SHROUD_CLEAR_HERO                
    BountyValue              = M_ROHAN_THEODEN_BOUNTY_VALUE
    DisplayName              = OBJECT:IsengardSharku
    RecruitText              = CONTROLBAR:IsengardSharkuRecruit
    ReviveText               = CONTROLBAR:IsengardSharkuRevive
    Hotkey                   = CONTROLBAR:IsengardSharkuHotkey
    CrushableLevel           = 3
    CrusherLevel             = 1

    CrushWeapon              = WargCrush

    MinCrushVelocityPercent  = 45
    CrushDecelerationPercent = 25

    CrushKnockback           = 40
    CrushZFactor             = 1.0

    CommandSet               = IsengardSharkuCommandSet
    CommandPoints            = 0


    ; *** AUDIO Parameters ***;
    VoiceAttack                  = SharkuVoiceAttack
    VoiceAttackCharge            = SharkuVoiceAttackCharge
    VoiceAttackMachine           = SharkuVoiceAttack
    VoiceAttackStructure         = SharkuVoiceAttackBuilding
    VoiceFear                    = SharkuVoiceHelpMe
    VoiceGuard                   = SharkuVoiceMove
    VoiceMove                    = SharkuVoiceMove
    VoiceMoveToCamp              = SharkuVoiceMoveCamp
    VoiceMoveWhileAttacking      = SharkuVoiceDisengage
    VoicePriority                = 66
    VoiceRetreatToCastle         = SharkuVoiceRetreat
    VoiceSelect                  = SharkuVoiceSelect
    VoiceSelectBattle            = SharkuVoiceSelectBattle

    SoundAmbient                 = WargAmbienceVOX
    SoundImpact                  = ImpactHorse

    EvaEventDamagedOwner         = UnitUnderAttack
    EvaEventDieOwner             = SharkuDie

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:WargHowlAbility                Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA     Frames:27
        
        AnimationSound = Sound:WargMoveFootsteps         Animation:IUWARGRIDR_SKL.IUWARGRIDR_RUNA     Frames:0
        AnimationSound = Sound:WargMoveFootsteps         Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNL1     Frames:0
        AnimationSound = Sound:WargMoveFootsteps         Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNR1     Frames:0
        AnimationSound = Sound:WargMoveFootsteps         Animation:IUWARGRIDR_SKL.IUWARGRIDR_TRNL     Frames:0
        AnimationSound = Sound:WargMoveFootsteps         Animation:IUWARGRIDR_SKL.IUWARGRIDR_TRNR     Frames:0
        AnimationSound = Sound:WargMoveFootsteps         Animation:IUWARGRIDR_SKL.IUWARGRIDR_ACCL     Frames:0

        AnimationSound = Sound:WargTauntCallouts         Animation:IUWARGRIDR_SKL.IUWARGRIDR_ATND     Frames:7 
        AnimationSound = Sound:WargTauntCallouts         Animation:IUWARGRIDR_SKL.IUWARGRIDR_HWLA     Frames:17
        AnimationSound = Sound:WargTauntFootstep         Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA     Frames:7 12 64 73

        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA     Frames:25 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_RUNA     Frames:5 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNL1     Frames:5 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNR1     Frames:5 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_ACCL     Frames:5 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_ATNA     Frames:5 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_ATND     Frames:5 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_GTPA     Frames:5 101 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_HWLA     Frames:15 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_RDYA     Frames:5 
        AnimationSound = Sound:WargSaddleFoleySingles     Animation:IUWARGRIDR_SKL.IUWARGRIDR_RDYB     Frames:5

        AnimationSound = Sound:BuildingWargPitRiderDrop    Animation:IUWARGRIDR_SKL.IUWARGRIDR_BLDB    Frames:44

        AnimationSound = Sound:BodyFallOrc             Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEB    Frames:10
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEB    Frames:45
        AnimationSound = Sound:BodyFallOrc             Animation:IUWARGRIDR_SKL.IUWARGRIDR_LNDA    Frames:1 17
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Human Unit Infantry Hero
        UnitWeight = 2
    End

    ; *** ENGINEERING Parameters ***
    RadarPriority                        = UNIT
    KindOf                               = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY URUK
    PathfindDiameter                     = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                      = M_EMOTION_CHEER_RADIUS
        MaxHealth                        = M_SHARKU_HEALTH
        PermanentlyKilledByFilter        = NONE
           DodgePercent                  = M_HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                        = DYING
        DeathFX                          = FX_GenericEvilHeroDieToRespawn
        DeathAnimationTime               = 4000
        InitialSpawnFX                   = FX_SharkuInitialSpawn
        RespawnAnim                      = LEVELED
        RespawnFX                        = FX_SharkuRespawn
        RespawnAnimationTime             = 4000
        AutoRespawnAtObjectFilter        = NONE +CASTLE_KEEP
        ButtonImage                      = HISharku
        RespawnRules                     = AutoSpawn:No    Cost:500        Time:90000        Health:100%
        RespawnEntry                     = Level:2            Cost:600     Time:90000
        RespawnEntry                     = Level:3            Cost:700     Time:90000
        RespawnEntry                     = Level:4            Cost:800     Time:90000
        RespawnEntry                     = Level:5            Cost:900     Time:120000
        RespawnEntry                     = Level:6            Cost:1000    Time:120000
        RespawnEntry                     = Level:7            Cost:1100    Time:120000
        RespawnEntry                     = Level:8            Cost:1200    Time:120000
        RespawnEntry                     = Level:9            Cost:1300    Time:120000
        RespawnEntry                     = Level:10           Cost:1400    Time:120000
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehavior
    End        

    Behavior = AutoHealBehavior ModuleTag_TheodenHealing
        StartsActive                     = Yes
        HealingAmount                    = M_HERO_HEAL_AMOUNT
        HealingDelay                     = 1000
        StartHealingDelay                = M_HERO_HEAL_DELAY
        HealOnlyIfNotInCombat            = Yes
    End

    Behavior= AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle       = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate              = 500
        HoldGroundCloseRangeDistance     = 40
        AILuaEventsList                  = SharkuFunctions
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance            = 300
        TauntAndPointUpdateDelay         = 1000
        AddEmotion                       = Alert_Base
    End    

    LocomotorSet
        Locomotor                        = HeroHorseLocomotor
        Condition                        = SET_NORMAL 
        Speed                            = M_NORMAL_CAVALRY_HORDE_SPEED
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_HeroRadiateFear
        StartsActive                     = No
        BonusName                        = HeroRadiateFear
        TriggeredBy                      = Upgrade_HeroRadiateFear
        RefreshDelay                     = 2000
        Range                            = 120
        TargetEnemy                      = Yes
        ObjectFilter                     = ANY +ORC
    End    

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult                      = 1.0
    End

    Behavior = HeroDie ModuleTag_HeroDeath
        SpecialPowerTemplate             = SpecialAbilitySmite
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes                       = ALL 
        SinkDelay                        = 3000
        SinkRate                         = 0.40
        DestructionDelay                 = 8000
        Sound                            = INITIAL SharkuVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1            = 7
        HitReactionLifeTimer2            = 15
        HitReactionLifeTimer3            = 10

        HitReactionThreshold1            = 0.0
        HitReactionThreshold2            = 25.0
        HitReactionThreshold3            = 50.0
    End
    
    ; -- Leadership - Warg-rider Captain
    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                     = Yes
        BonusName                        = SharkuPassiveLeadership
        RefreshDelay                     = 2000
        Range                            = 200
        ObjectFilter                     = ANY +IsengardWargRider +GundabadWargRider -CAVALRY -INFANTRY -STRUCTURE -BASE_FOUNDATION -HERO
    End
    
    Behavior = SpecialPowerModule ModuleTag_SharkuLeadershipUpdate   
        SpecialPowerTemplate             = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack         = No
        StartsPaused                     = No
    End    

    ; -- Scent of Blood
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScentOfBloodEnabler
        SpecialPowerTemplate             = SpecialAbilityGolfimbulScentOfBlood
        TriggeredBy                      = Upgrade_GenericUpgrade3
    End
    Behavior = SpecialPowerModule ModuleTag_ScentOfBloodUpdate   
        SpecialPowerTemplate             = SpecialAbilityGolfimbulScentOfBlood
        UpdateModuleStartsAttack         = Yes
        StartsPaused                     = Yes
        AttributeModifier                = SharkuIntercept
        AttributeModifierRange           = 200
        AttributeModifierAffectsSelf     = Yes
        AttributeModifierAffects         = ANY +CAVALRY
        AttributeModifierFX              = FX_SharkuInterceptFX
    End

    Behavior = SpecialAbilityUpdate ModuleTag_ScentOfBloodAnimation
        UnpackTime                       = 500
        UnpackingVariation               = 1
        
        SpecialPowerTemplate             = SpecialAbilityGolfimbulScentOfBlood
         PreparationTime                 = 1
         PersistentPrepTime              = 2400
         PackTime                        = 100
    End

    ; -- Warg Summon
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SharkuWarg Summon
        SpecialPowerTemplate             = SuperweaponGothmogOrcs
        TriggeredBy                      = Upgrade_GenericUpgrade10
    End
    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPower1
        SpecialPowerTemplate             = SuperweaponGothmogOrcs
        OCL                              = OCL_WargSummonEgg
        CreateLocation                   = USE_OWNER_OBJECT
        StartsPaused                     = Yes
        SetModelCondition                = ModelConditionState:USER_1
        SetModelConditionTime            = 4.1
        TriggerFX                        = FX_SharkuPackLeader
    End
    
  Geometry            = CYLINDER
  GeometryMajorRadius = 8.0
  GeometryMinorRadius = 8.0
  GeometryHeight      = 19.2
  GeometryIsSmall     = Yes
  Shadow              = SHADOW_DECAL
  ShadowSizeX         = 19;
  ShadowSizeY         = 19;
  ShadowTexture       = ShadowI;
End

;------------------------------------------------------------------------------
; Warg Rider WargRiders
Object SharkuWargSlave
    ; *** ART Parameters ***
    ; NOTE: If you are updating any of the art parameters, you should really check
    ; GondorCavalryRiderless in FactionSubObject.ini and see if it needs to be updated
    
    ; This is required for garrisoned objects - please put in all objects.
    ButtonImage = BIWargPit_Riders

    SelectPortrait         = UPNeutral_Warg


    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes
        RandomTexture = IUWargSntryA.tga 0 IUWargSntryA.tga
        RandomTexture = IUWargSntryB.tga 0 IUWargSntryA.tga

        DefaultModelConditionState
            Model                    = IUWarg_SKN
            Skeleton                = IUWarg_SKL
        End

        ; -------------- STUNNED ANIMS ----------------
        AnimationState                        = PASSENGER
            Animation                        = Grabbed
                AnimationName                = IUWarg_GBDA
                AnimationMode                = LOOP
            End
        End
        
        AnimationState                        = FREEFALL
            Animation                        = freefall
                AnimationName                = IUWarg_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
            End
        End
        
        AnimationState                =    DYING SPLATTED
            Animation                =    splatted
                AnimationName        =    IUWarg_LNDA
                AnimationMode        =    ONCE
            End
        End
        
        AnimationState                =    STUNNED_FLAILING 
            Animation                =    JustDie
                AnimationName       =    IUWarg_FLYA
                AnimationMode       =    LOOP
            End
        End

        AnimationState                =    STUNNED 
            Animation                =    Land
                AnimationName       =    IUWarg_LNDA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName       =    IUWarg_GTPA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                =    DYING
            Animation                =    JustDie
                AnimationName        =    IUWarg_DIEA
                AnimationMode        =    ONCE
            End
        End        
        
        ; -------------- MOVING ANIMS ---------------
        AnimationState                =    TURN_LEFT_HIGH_SPEED  
            Animation                =    MTurnLeft
                AnimationName        =    IUWarg_TNL1
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED
            Animation                =    MTurnRight
                AnimationName        =    IUWarg_TNR1
                AnimationMode        =    LOOP
            End
        End
        
        AnimationState                =    TURN_LEFT  
            Animation                =    TurnRight
                AnimationName        =    IUWarg_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    TURN_RIGHT 
            Animation                =    TurnRight
                AnimationName        =    IUWarg_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    MOVING ACCELERATE 
            Animation                =    Accelerate
                AnimationName        =    IUWarg_ACCL
                AnimationMode        =    ONCE
            End
            ParticleSysBone                = None GenericSiegeTrailDust
        End
    
        AnimationState                =    MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    IUWarg_DECL
                AnimationMode        =    ONCE
            End
            ParticleSysBone                = None GenericSiegeTrailDust
        End
        
        AnimationState                =    MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    IUWarg_BAKA
                AnimationMode        =    LOOP
            End
        End
        
        AnimationState                =    MOVING
            ShareAnimation            =    Yes
            Animation                =    RunA
                AnimationName        =    IUWarg_RUNA
                AnimationMode        =    LOOP
            End
            ;ParticleSysBone            =    None CalvaryDustTrails  
        End
        
        ; ----------- ATTACKING ANIMS --------------        
        AnimationState                =    BETWEEN_FIRING_SHOTS_A
            Animation                =    BetweenFiringShots
                AnimationName        =    IUWarg_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =   10
            End
        End

        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation                =    AttackA3
                AnimationName        =    IUWarg_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
        End
        
        AnimationState                =    ATTACKING
            Animation                =    AttackA3
                AnimationName        =    IUWarg_ATKA
                AnimationMode        =    LOOP
                AnimationBlendTime    =   10
            End
        End

        ; ----------- WAR CHANT ANIMS -------------
        AnimationState = WAR_CHANT
            Animation = Chant
                AnimationName = IUWarg_TNTA
                AnimationMode = LOOP
            End
        End

        ; ----------- EMOTION ANIMS ---------------
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = TNTA
                AnimationName            = IUWarg_TNTA
                AnimationMode            = LOOP
            End
        End
        
        AnimationState                    = EMOTION_CELEBRATING
            Animation                   = CHRA
                AnimationName            = IUWarg_CHRA
                AnimationMode            = ONCE
            End
        End
        
        ; ----------- IDLE ANIMS ---------------
        AnimationState                            = EMOTION_ALERT
            StateName                            = STATE_Ready 
            Animation                            = ALERT
                AnimationName                    = IUWarg_IDLA
                AnimationMode                    = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Ready") end
            EndScript    
        End

        AnimationState                            = DEATH_2
            StateName                            = STATE_Ready 
            Animation                            = ALERT
                AnimationName                    = IUWarg_IDLA
                AnimationMode                    = LOOP
            End   
        End
        
        ; ----------- SELECTED ANIMS --------------
        AnimationState                =    SELECTED
            SimilarRestart            =   Yes
            Animation                =    AtAttention
                AnimationName        =    IUWarg_ATNB
                AnimationMode        =    LOOP
            End
            StateName                = Selected
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("Idle_to_Selected") end
                if Prev == "STATE_Ready" then CurDrawableSetTransitionAnimState("Ready_to_Selected") end
            EndScript
        End

        IdleAnimationState
            Animation
                AnimationName        =    IUWarg_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    20
            End
            Animation
                AnimationName        =    IUWarg_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    1
            End
            StateName                = Idle 
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Idle") end
            EndScript
        End

        ;------------ TRANSITION ANIMS ----------------
        TransitionState       = Selected_to_Idle
            Animation           = ATNE
                AnimationName        =    IUWarg_ATNC
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End
        
        TransitionState       = Idle_to_Selected
            Animation           = ATND
                AnimationName     = IUWarg_ATNA
                AnimationMode   =    ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

    End

    ; ***DESIGN parameters ***
    Side                     = Isengard
    EditorSorting            = UNIT
    ThreatLevel              = 2.0
    TransportSlotCount       = 1
    
    WeaponSet
        Conditions           = None 
        Weapon               = PRIMARY    WargRiderlessWeapon
    End
    
    ArmorSet
        Conditions           = None
        Armor                = CavalryArmor
        DamageFX             = NormalDamageFX
    End

      VisionRange            = M_CREEP_VISION                
      ShroudClearingRange    = M_CREEP_VISION

    BountyValue              = M_ISENGARD_WARGRIDER_BOUNTY_VALUE
    DisplayName              = OBJECT:Warg
    
    CrushableLevel           = 1 ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
    CrusherLevel             = 1
    CrushWeapon              = WargCrush
    MinCrushVelocityPercent  = 50
    CrushDecelerationPercent =20
    IsTrainable              = No

    CommandSet               = EmptyCommandSet
    
    ; ******** AUDIO Parameters ********;
    SoundAmbient                = WargAmbienceVOX
    SoundImpact                = ImpactHorse
    ;SoundMoveLoop                = WargMoveFootsteps
    ;SoundCrushing                = WargRiderCrushing         ; Sound made when crushing another unit underhoof



      EvaEnemyUnitSightedEvent = WargRiderCreepSighted ; Special event for wargs showing up. Helps distinguish the real enemies from random creeps
      
    EvaEventDamagedOwner            = UnitUnderAttack         ;Eva event to trigger when unit is damaged
    ;EvaEventDieOwner            = GroupWargRiderDie        ;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths
                                        ;For deaths you can respawn from, use the DeathFX

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWarg_SKL.IUWarg_RUNA Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_TNL1 Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_TNR1 Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_TRNL Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_TRNR Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_ACCL Frames:0
;        AnimationSound = Sound:WargRiderTauntCallouts Animation:IUWarg_SKL.IUWarg_TNTA Frames:27
        AnimationSound = Sound:WargTauntCallouts Animation:IUWarg_SKL.IUWarg_TNTA Frames:26 Animation:IUWarg_SKL.IUWarg_ATND Frames:7 Animation:IUWarg_SKL.IUWarg_HWLA Frames:17
        AnimationSound = Sound:WargTauntFootstep Animation:IUWarg_SKL.IUWarg_TNTA Frames:7 12 64 73
        ;AnimationSound = Sound:WargSaddleFoleySingles Animation:IUWarg_SKL.IUWarg_TNTA Frames:25 Animation:IUWarg_SKL.IUWarg_RUNA Frames:5 Animation:IUWarg_SKL.IUWarg_TNL1 Frames:5 Animation:IUWarg_SKL.IUWarg_TNR1 Frames:5 Animation:IUWarg_SKL.IUWarg_ACCL Frames:5 Animation:IUWarg_SKL.IUWarg_ATNA Frames:5 Animation:IUWarg_SKL.IUWarg_ATND Frames:5 Animation:IUWarg_SKL.IUWarg_GTPA Frames:5 101 Animation:IUWarg_SKL.IUWarg_HWLA Frames:15 Animation:IUWarg_SKL.IUWarg_RDYA Frames:5 Animation:IUWarg_SKL.IUWarg_RDYB Frames:5
    End

    ; Tie into LargeGroupAudio system
    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Warg
    End


    ; *** ENGINEERING Parameters ***

    RadarPriority = UNIT
    ThingClass = CAVALRY_UNIT

    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY PATH_THROUGH_INFANTRY GRAB_AND_DROP HAS_HEALTH_BAR CREEP SCORE
    
    Body = ActiveBody BodyModuleTag
        MaxHealth         = 400                  
        ;RecoveryTime      = 10000
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
    End
        
    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList    =    WargRiderFunctions
    End

    LocomotorSet
        Locomotor = WargLocomotor
        Condition = SET_NORMAL 
        Speed     = 80 ;80
    End    

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime = 3800    ;msec
    End
    
    Behavior = SquishCollide ModuleTag_06
        ;nothing
    End

    Behavior = SlowDeathBehavior ModuleTag_08
        ; Die and don't spawn horse
        DeathTypes = ALL 
        SinkDelay = 5000
        SinkRate = 1.50     ; in Dist/Sec
        DestructionDelay = 17000
        Sound = INITIAL WargVoxDie
    End

    Behavior                =    SlowDeathBehavior ModuleTag_09
        DeathTypes            =    NONE +FADED
        FadeDelay = 0
        FadeTime = 8000
        DestructionDelay = 8000
        DeathFlags = DEATH_2
        FX = INITIAL FX_RohirrimAlliesUnsummon
    End
    
    Behavior = SlavedUpdate ModuleTag_Slave
        GuardMaxRange        = 250
        GuardWanderRange    = 45
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 15
    GeometryMinorRadius = 15
    GeometryHeight = 20.0
    GeometryIsSmall = No

    Shadow = SHADOW_DECAL
    ShadowSizeX = 30;
    ShadowSizeY = 20;
    ShadowTexture = ShadowI;

End
ChildObject SharkuWargSlave_Summoned SharkuWargSlave
    IsTrainable = No
    CommandPoints = 0
    EquivalentTo = SharkuWargSlave
    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 75000
        MaxLifetime        = 75000
        DeathType        = FADED
    End 
End
Object SummonWargEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE
    
    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay = 2000
        OCL = FINAL OCL_SpawnSharkuWargs
    End
End

;------------------------------------------------------------------------------
Object SharkuWargSlave_SummonedHorde

      ; This is required for garrisoned objects - please put in all objects.
    ButtonImage        = BIWargPit_Riders
    SelectPortrait    = UPNeutral_Warg

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None ;InvisHrdeTmp5x1
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End        
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End
    
    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:Warg
    
    WeaponSet
        Conditions = None 
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder        ; Spear
        Weapon        = SECONDARY    NormalMissileHordeRangefinder    ; Bow
    End


    ; *** AUDIO Parameters ***;
    ; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
    ; are always passed through to members


    BuildCost = 0        
    BuildTime = 0            
    VisionRange = M_VISION_STANDARD_HORSE         
    CommandPoints = 0
    IsTrainable = No
    CommandSet = WargSummonHordeCommandSet
          
    FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
    FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
    CrushableLevel = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
    CrusherLevel = 1 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
    MinCrushVelocityPercent = 30 ; Has to be moving at at least 50% of full speed.
    CrushDecelerationPercent = 35 ; Lose 20 percent of max velocity when crushing.
    CrushKnockback = 50  ; how hard we knock back crushed units.
    CrushZFactor = 1.0  ; How much we knock upwards.
        
    
    TransportSlotCount = 1
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY SUMMONED;UNATTACKABLE 
    
    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End
    
    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    M_INFANTRY_TAUNT_POINT_RADIUS        ; max distance to taunted/pointed objet
        TauntAndPointUpdateDelay    =    1000    ; how often scan (milliseconds)
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    NONE +RohanOathbreakerHordeSmall +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorFellBeast +MordorWitchKingOnFellBeast +MordorBalrog +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorMumakil ;Must be SCARY kindof as well.
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker; +MordorWitchKing +MordorWitchKingOnFellBeast
        PointAt                =    NONE +GondorGwaihir 
        HeroScanDistance        =    150
        FearScanDistance        =    M_CAVALRY_FEAR_SCAN_RADIUS ;250

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base    
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End    
    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained = 
        InitialPayload = SharkuWargSlave_Summoned 5
        Slots = 5
        PassengerFilter = NONE +CAVALRY +IsengardBannerOrc
        ShowPips = No
        RandomOffset = X:15 Y:4
        
        ; Banner Carrier info        
        BannerCarriersAllowed    = IsengardBannerOrc                                        ; types of units that are allowed as banner carriers
        BannerCarrierPosition    = UnitType:IsengardWargRider    Pos:X:40.0 Y:0.0        ; (DEFAULT) position of banner carrier
        
        RankInfo = RankNumber:1 UnitType:SharkuWargSlave_Summoned Position:X:0 Y:0        Position:X:30 Y:20        Position:X:30 Y:-20        Position:X:-30 Y:-20        Position:X:-30 Y:20 

        ThisFormationIsTheMainFormation = Yes    ;Used to determine which armorset to use (and anything else we want!)
                
        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 65; How far the hordes can move from the center of the horde when melee attacking.        
;        AttributeModifiers = IsengardWargSkirmish
    End
    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End    
    Behavior = SpecialPowerModule ModuleTag_HowlUpdate   
        SpecialPowerTemplate      = SpecialAbilityWargHowl
        UpdateModuleStartsAttack  = No
        AttributeModifier = IsengardWargHowl
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects = ANY +CAVALRY  ;
        AttributeModifierFX = FX_WargHowl
    End
    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 75000
        MaxLifetime        = 75000
        DeathType        = FADED
    End 
    LocomotorSet
        Locomotor     = WargCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = M_NORMAL_CAVALRY_HORDE_SPEED
    End
    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End    
    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End