;------------------------------------------------------------------------------
;Isengard Archer Isengard Uruk Crossbow UrukHaiCrossbowman
Object IsengardDunlandArcher
    ; *** ART Parameters ***

    ; This is required for garrisoned objects - please put in all objects.
    ButtonImage = UIDunlendingArcher
	SelectPortrait         = UPDunlendingArcher
	;SelectPortrait         = SP_Haradrim
	; *** ART Parameters ***
	;note all file names are MUHaradim, not MUHaradrim, so as not to exceed character limits
	Draw = W3DHordeModelDraw ModuleTag_01
		StaticModelLODMode		= Yes ; Will append M or L to the skin name depending on GameLOD
		OkToChangeModelColor	= Yes		
		LodOptions							= LOW
			AllowMultipleModels				= ALLOW_MULTIPLE_MODELS_LOW
			MaxRandomTextures				= MAX_RANDOM_TEXTURES_LOW
			MaxRandomAnimations				= MAX_RANDOM_ANIMATIONS_LOW
			MaxAnimFrameDelta				= MAX_ANIM_FRAME_DELTA_LOW
		End		
		LodOptions							= MEDIUM
			AllowMultipleModels				= ALLOW_MULTIPLE_MODELS_MED
			MaxRandomTextures				= MAX_RANDOM_TEXTURES_MED
			MaxRandomAnimations				= MAX_RANDOM_ANIMATIONS_MED
			MaxAnimFrameDelta				= MAX_ANIM_FRAME_DELTA_MED
		End
		
		LodOptions							= HIGH
			AllowMultipleModels				= ALLOW_MULTIPLE_MODELS_HIGH
			MaxRandomTextures				= MAX_RANDOM_TEXTURES_HIGH
			MaxRandomAnimations				= MAX_RANDOM_ANIMATIONS_HIGH
			MaxAnimFrameDelta				= MAX_ANIM_FRAME_DELTA_HIGH
		End
		WadingParticleSys = WaterRipplesTrail  ; used when the unit is wading in shallow water.
		DefaultModelConditionState
			Model = iuNdunarch_skn
			;Skeleton = MUHaradim_SKL
			WeaponLaunchBone = PRIMARY ARRROW
			WeaponLaunchBone = SECONDARY ARRROW
		End
		ModelConditionState				= RIDER2
			Model = iuNdunarch_skn
			;Skeleton = MUHaradim_SKL
			WeaponLaunchBone = PRIMARY ARRROW
			WeaponLaunchBone = SECONDARY ARRROW
		End
;================== ANIMATIONS ==============================================================		
;----------- Flying through air -------
		AnimationState						= THROWN_PROJECTILE WEAPONSTATE_CLOSE_RANGE
			Animation						= FLYA
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode				= LOOP
			End
		End
		AnimationState						= THROWN_PROJECTILE
			Animation						= FLYA
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode				= LOOP
			End
		End
		AnimationState						= PASSENGER FREEFALL WEAPONSTATE_CLOSE_RANGE
			Animation						= FLLB
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode				= LOOP
			End
			StateName						= Sword
		End
		AnimationState						= PASSENGER FREEFALL
		Animation						= FLLA
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode				= LOOP
			End
			StateName						= Bow
		End
		AnimationState						= FREEFALL WEAPONSTATE_CLOSE_RANGE
			StateName						= STATE_Freefall
			Animation						= FLYB
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
				AnimationSpeedFactorRange	= 0.7	0.7
			End
		End
		AnimationState						= FREEFALL
			SimilarRestart					= Yes
			StateName						= STATE_Freefall
			Animation						= FLYA
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
				AnimationSpeedFactorRange	= 0.65	0.65
			End
		End
		AnimationState					=	STUNNED_FLAILING 
			Animation					=	StunFlail
				AnimationName			=	GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
;----------- Dying -------
		AnimationState						= DYING DEATH_2
			Animation
				AnimationName				= GUFaramir_SKL.GUFaramir_IDLA
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
		End
		AnimationState						= DYING SPLATTED WEAPONSTATE_CLOSE_RANGE
			Animation						= Splattered
				AnimationName				= GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING SPLATTED
			Animation						= Splattered
				AnimationName				= GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING WEAPONSTATE_CLOSE_RANGE DEATH_2
			Animation						= Die
				AnimationName				= GUFaramir_SKL.GUFaramir_IDLA
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING DEATH_2
			Animation						= Die
				AnimationName				= GUFaramir_SKL.GUFaramir_IDLC
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING WEAPONSTATE_CLOSE_RANGE
			Animation						= Die
				AnimationName				= GUFaramir_SKL.GUFaramir_DIEA
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING
			Animation						= Die
				AnimationName				= GUFaramir_SKL.GUFaramir_DIEC
				AnimationMode				= ONCE
			End
		End
;------ Stunned anims -----------
		AnimationState						= STUNNED_STANDING_UP WEAPONSTATE_CLOSE_RANGE
			Animation						= GTPA
				AnimationName				= GUFaramir_SKL.GUFaramir_GTPB
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 1.5 1.5
			End
		End
		AnimationState						= STUNNED_STANDING_UP 
			Animation						= GTPA
				AnimationName				= GUFaramir_SKL.GUFaramir_GTPA
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 1.5 1.5
			End
		End
		AnimationState						= STUNNED WEAPONSTATE_CLOSE_RANGE
			Animation						= Stun
				AnimationName				= GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode				= ONCE
			End
		End
		AnimationState						= STUNNED 
			Animation						= Stun
				AnimationName				= GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode				= ONCE
			End
		End

; --------- MOVING ------------	
		AnimationState					= MOVING EMOTION_TERROR
			Animation					= Terror
				AnimationName			= GUFaramir_SKL.guithil_runa
				AnimationMode			= LOOP
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		
		AnimationState						= MOVING WEAPONSTATE_CLOSE_RANGE
			StateName						= STATE_Sword
			Animation						= RunWithSword
				AnimationName				= GUFaramir_SKL.GUFaramir_RUNB
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
			EndScript
		End
		AnimationState						= MOVING
			StateName						= STATE_Bow
			Animation						= RunWithSword
				AnimationName				= GUFaramir_SKL.guithil_runa
				AnimationSpeedFactorRange = 1.0 1.3
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End
;============================================FIXED SHOOTING ANIMATiONS=============================				
		AnimationState                    =    PREATTACK_A 
            StateName                    =    STATE_Firing
            Animation                    =    ReadyToDrawn
                AnimationName            =    GUFaramir_SKL.guithil_atka1
                AnimationMode            =    ONCE
            End
        End
        AnimationState                    =    FIRING_OR_RELOADING_A 
            StateName                    =    STATE_Firing
            Animation                    =    LooseReloadDraw
                AnimationName            =    GUFaramir_SKL.guithil_atka2
                AnimationMode            =    ONCE
                ;AnimationSpeedFactorRange = 1.1 1.1
            End
        End
        AnimationState                    =    CONTINUOUS_FIRE_MEAN
            Animation                    =    HangFrameWhileCoasting
                AnimationName            =    GUFaramir_SKL.guithil_atka2
                AnimationMode            =    MANUAL
            End
        End
        AnimationState                        = CONTINUOUS_FIRE_SLOW
            Animation                        = PutAwayArrow
                AnimationName                = GUFaramir_SKL.guithil_atka3
                AnimationMode                = ONCE
            End
        End	

		AnimationState                    =    PREATTACK_B WEAPONLOCK_SECONDARY
            StateName                    =    STATE_Firing
            Animation                    =    ReadyToDrawn
                AnimationName            =    GUFaramir_SKL.guithil_atka1
                AnimationMode            =    ONCE
            End
        End
        AnimationState                    =    FIRING_OR_RELOADING_B 
            StateName                    =    STATE_Firing
            Animation                    =    LooseReloadDraw
                AnimationName            =    GUFaramir_SKL.guithil_atka2
                AnimationMode            =    ONCE
                ;AnimationSpeedFactorRange = 1.1 1.1
            End
        End
        AnimationState                    =    CONTINUOUS_FIRE_MEAN WEAPONLOCK_SECONDARY
            Animation                    =    HangFrameWhileCoasting
                AnimationName            =    GUFaramir_SKL.guithil_atka2
                AnimationMode            =    MANUAL
            End
        End
        AnimationState                        = CONTINUOUS_FIRE_SLOW WEAPONLOCK_SECONDARY
            Animation                        = PutAwayArrow
                AnimationName                = GUFaramir_SKL.guithil_atka3
                AnimationMode                = ONCE
            End
        End	

		
; --------- Click and Hit Reactions ------------	
;------------- EMOTIONS ------------------------------------------------
		AnimationState						= EMOTION_AFRAID WEAPONSTATE_CLOSE_RANGE
			ShareAnimation					= Yes
			StateName						= STATE_Sword
			Animation						= FearWithSword
				AnimationName				= GUFaramir_SKL.gufaramir_fear
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
			EndScript
		End
		AnimationState						= EMOTION_AFRAID
			ShareAnimation					= Yes
			StateName						= STATE_Bow
			Animation						= FERA
				AnimationName				= GUFaramir_SKL.gufaramir_fear
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState				=	WEAPONSTATE_CLOSE_RANGE
			StateName				=	STATE_READY
			Animation				=	ready
				AnimationName		=	GUFaramir_SKL.GUFaramir_idla
				AnimationMode		=	LOOP
				AnimationBlendTime	=	20
			End
		End
		AnimationState				= LEVELED WEAPONSTATE_CLOSE_RANGE
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRC
				AnimationMode		= ONCE
			End
		End
		AnimationState				= LEVELED 						
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode		= ONCE
			End
		End
		AnimationState				=	EMOTION_TAUNTING WEAPONSET_TOGGLE_1
			Animation
				AnimationName		=	GUFaramir_SKL.GUFaramir_TNTC
				AnimationMode		=	ONCE
			End
			Animation
				AnimationName		=	GUFaramir_SKL.GUFaramir_TNTD
				AnimationMode		=	ONCE
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End
		AnimationState				=	EMOTION_TAUNTING
			Animation
				AnimationName		=	GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode		=	LOOP
			End
		End
		AnimationState				=	EMOTION_CELEBRATING WEAPONSTATE_CLOSE_RANGE
				Animation           =	CHRC
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRC
					AnimationMode   =	ONCE
					AnimationPriority	=	10
				End
				Animation           =	CHRD
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRD
					AnimationMode   =	ONCE
					AnimationPriority	=	5
				End
				Flags				=	RESTART_ANIM_WHEN_COMPLETE		
			End
		AnimationState				=	EMOTION_CELEBRATING
				Animation           =	CHRD
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRD
					AnimationMode   =	LOOP
				End
			End
		AnimationState				=	EMOTION_ALERT WEAPONSTATE_CLOSE_RANGE
			StateName				=	STATE_READY
			Animation				=	ready
				AnimationName		=	GUFaramir_SKL.GUFaramir_idla
				AnimationMode		=	LOOP
				AnimationBlendTime	=	20
			End
		End
		AnimationState				=	SELECTED 
			StateName				=	STATE_Selected_Bow
			Animation				=	ATNB
				AnimationName		=	GUFaramir_SKL.GUFaramir_ATNB
				AnimationMode		=	LOOP
				AnimationBlendTime  = 15
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_Idle_Bow"	then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
				if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
			EndScript
		End		
		AnimationState						= SELECTED
			StateName						= STATE_Selected
			Animation						= Selected
				AnimationName				= GUFaramir_SKL.GUFaramir_ATNB
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow_Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
			EndScript
		End
		IdleAnimationState
			StateName						= STATE_Bow_Idle
			Animation						= IdleBowC
				AnimationName				= GUFaramir_SKL.GUFaramir_IDLC
				AnimationMode				= ONCE
				AnimationPriority			= 6
			End
			Flags							= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_AttentionToIdle") end
			EndScript
		End
		TransitionState = TRANS_IdleToAttentionSword
			Animation = ANTD
				AnimationName		= GUFaramir_SKL.GUFaramir_ANTD
				AnimationMode		= ONCE
				AnimationSpeedFactorRange	= 0.6 0.6
			End		
		End
		TransitionState = TRANS_AttentionToIdleSword
			Animation			= ATNF
				AnimationName	= GUFaramir_SKL.GUFaramir_ATNF
				AnimationMode	= ONCE
				AnimationSpeedFactorRange	= 0.6 0.6
			End		
		End	
		TransitionState = TRANS_IdleToAttentionBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.GUFaramir_ATNC
				AnimationMode		= ONCE
				AnimationSpeedFactorRange	= 0.6 0.6
			End		
		End
		TransitionState = TRANS_CaptainBowToAttentionBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.GUFaramir_ATNC
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationSpeedFactorRange = 0.9 0.9
			End		
		End
		TransitionState = TRANS_AttentionToIdleBow
			Animation			= ATNA
				AnimationName	= GUFaramir_SKL.GUFaramir_ATND
				AnimationMode	= ONCE
				AnimationSpeedFactorRange	= 0.9 0.9
			End		
		End	
		TransitionState       = TRANS_BowToSword
			Animation           = GUFaramir_STHA
				AnimationName     = GUFaramir_SKL.GUFaramir_STHA 
				AnimationMode     = ONCE
			End
		End
		TransitionState       = TRANS_SwordToBow
			Animation           = GUFaramir_STHB
				AnimationName     = GUFaramir_SKL.GUFaramir_STHB 
				AnimationMode     = ONCE
			End
		End	
		TransitionState       		= TRANS_BowToSword_Running
			Animation           	= DrawSwords
				AnimationName       = GUFaramir_SKL.GUFaramir_STHD
				AnimationMode       = ONCE
			End
		End
		TransitionState       		= TRANS_SwordToBow_Running
			Animation           	= DrawBow
				AnimationName       = GUFaramir_SKL.GUFaramir_STHC
				AnimationMode       = ONCE
			End
		End
	End

    ; ***DESIGN parameters ***
    Side          = Isengard
    EditorSorting = UNIT
    ThreatLevel   = 1.0
    ThingClass    = HORDE_UNIT
    EmotionRange  = 240
    CommandPoints = 2

    TransportSlotCount = 1
    
    WeaponSet
      Conditions = None 
      Weapon = PRIMARY    IsengardArcherBow
      Weapon = SECONDARY    IsengardArcherBowFireArrow
      AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
      AutoChooseSources = SECONDARY NONE
    End
      
    ArmorSet
      Conditions      = None
      Armor           = ArcherArmor
      DamageFX        = NormalDamageFX
    End
    ArmorSet
      Conditions      = PLAYER_UPGRADE
      Armor           = ArcherHeavyArmor
      DamageFX        = NormalDamageFX    
    End
      
    ; This is required so that the build phase lasts as long as the anim.
    BuildFadeInOnCreateTime = 0 ;1.5 ;temporarily set to 0
    
    CommandSet IsengardUrukCrossbowHordeCommandSet
    
    ShroudClearingRange = M_SHROUD_CLEAR_STANDARD
    VisionRange = M_ISENGARD_DUNLAND_ARCHER_VISION_RANGE

    BountyValue = M_ISENGARD_DUNLAND_ARCHER_BOUNTY_VALUE
    DisplayName = OBJECT:IsengardDunlandArcher
    CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
    CrusherLevel = 0 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
    CrushRevengeWeapon = RangedInfantryCrushRevenge


    ; *** AUDIO Parameters ***;
    VoiceAttack								          = DunlendingVoiceAttack
    VoiceAttackCharge						        = DunlendingVoiceAttackCharge
    VoiceAttackMachine						      = DunlendingVoiceAttack
    VoiceAttackStructure					      = DunlendingVoiceAttackBuilding
    VoiceCreated							          = DunlendingVoiceSalute
    VoiceFullyCreated 						      = DunlendingVoiceSalute
    VoiceGuard								          = DunlendingVoiceMove
    VoiceMove								            = DunlendingVoiceMove
    VoiceMoveToCamp							        = DunlendingVoiceMoveCamp
    VoiceMoveWhileAttacking					    = DunlendingVoiceDisengage
    VoicePriority							          = 32
    VoiceRetreatToCastle					      = DunlendingVoiceRetreat		
    VoiceSelect								          = DunlendingVoiceSelect
    VoiceSelectBattle 						      = DunlendingVoiceSelectBattle			
    VoiceAmbushed                       = DunlendingVoiceAmbushed
    VoiceEnterStateAttack					      = DunlendingVoiceEnterStateAttack
    VoiceEnterStateAttackCharge				  = DunlendingVoiceEnterStateAttackCharge
    VoiceEnterStateAttackMachine			  = DunlendingVoiceEnterStateAttack
    VoiceEnterStateAttackStructure			= DunlendingVoiceEnterStateAttackBuilding
    VoiceEnterStateMove						      = DunlendingVoiceEnterStateMove
    VoiceEnterStateMoveToCamp				    = DunlendingVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking		= DunlendingVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle			= DunlendingVoiceEnterStateRetreat		
      
    SoundImpact                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison            = DunlendingVoiceGarrison
    End

    EvaEventDamagedOwner            = UnitUnderAttack         ;Eva event to trigger when unit is damaged

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU                ;Tie into LargeGroupAudio system
        Key = Human Unit
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:FootstepDirtA		Animation:GUFaramir_SKL.GUFaramir_RUNA		Frames:2 12
		AnimationSound = Sound:FootstepDirtA		Animation:GUFaramir_SKL.iudunarch_runa		Frames:2 12
		AnimationSound = Sound:FootstepDirtA		Animation:GUFaramir_SKL.GUFaramir_RUNB		Frames:2 12
		AnimationSound = Sound:WeaponSwitchBow		Animation:GUFaramir_SKL.GUFaramir_ATKC		Frames:18
		AnimationSound = Sound:SwordShingClean1		Animation:GUFaramir_SKL.GUFaramir_STHA		Frames:21
		AnimationSound = Sound:SwordIntoScabbard1		Animation:GUFaramir_SKL.GUFaramir_STHB		Frames:11
		AnimationSound = Sound:WeaponSwitchBow		Animation:GUFaramir_SKL.GUFaramir_STHB		Frames:28
		AnimationSound = Sound:SwordIntoScabbard1		Animation:GUFaramir_SKL.GUFaramir_STHC		Frames:2
		AnimationSound = Sound:WeaponSwitchBow		Animation:GUFaramir_SKL.GUFaramir_STHC		Frames:3
		AnimationSound = Sound:SwordShingClean1		Animation:GUFaramir_SKL.GUFaramir_STHD		Frames:6
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:GUFaramir_SKL.GUFaramir_DIEA		Frames:88
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:GUFaramir_SKL.GUFaramir_DIEB		Frames:85
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:GUFaramir_SKL.GUFaramir_DIEC		Frames:49
		AnimationSound = Sound:BodyFallSoldier		Animation:GUFaramir_SKL.GUFaramir_LNDA		Frames:3
		AnimationSound = Sound:BodyFallSoldier		Animation:GUFaramir_SKL.GUFaramir_LNDB		Frames:2
	End


  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER CAN_USE_SIEGE_TOWER SCORE THROWN_OBJECT ARCHER ATTACK_NEEDS_LINE_OF_SIGHT GRAB_AND_DROP
 
  Body = ActiveBody ModuleTag_02
    CheerRadius       = M_EMOTION_CHEER_RADIUS
    MaxHealth         = M_ISENGARD_DUNLAND_ARCHER_HEALTH                ;BALANCE Isengard Crossbowman Health
    MaxHealthDamaged  = M_ISENGARD_DUNLAND_ARCHER_HEALTH_DAMAGED        
    ;RecoveryTime      = M_ISENGARD_URUKCROSSBOW_HEALTH_RECOVERY_TIME    
  End

;------------------------------------------------------------------------
;------------ Fire Arrow Rank 2 Ability -------------------------------
;------------------------------------------------------------------------
	
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnpauseLeadership2
        SpecialPowerTemplate = SpecialAbilityFireArrowVolley
        TriggeredBy = Upgrade_GenericUpgrade2
    End
    Behavior = SpecialPowerModule ModuleTag_FireArrowUser_1_Start
		SpecialPowerTemplate      = SpecialAbilityFireArrowVolley
		StartsPaused			= Yes
		AttributeModifier = FireArrowsUSER_1
		AttributeModifierRange = 50
		AttributeModifierAffectsSelf = Yes
		AttributeModifierAffects = NONE +IsengardDunlandArcherHorde
	End	
	Behavior = WeaponModeSpecialPowerUpdate ModuleTag_SwitchToWeaponset1
		SpecialPowerTemplate	= SpecialAbilityFireArrowVolley
		Duration				= 10000
		LockWeaponSlot            = SECONDARY
		StartsPaused			= Yes
	End
	Behavior = SpecialAbilityUpdate ModuleTag_FireArrowUpdate
	    SpecialPowerTemplate    = SpecialAbilityFireArrowVolley
        UnpackTime              = 1
        UnpackingVariation        = 2      
		AwardXPForTriggering		= 0		
		TriggerSound				= UpgradeFlamingArrows
    End	
          
	Behavior = WeaponSetUpgrade ModuleTag_ImprovedArrowsmithing
		TriggeredBy = Upgrade_ImprovedArrowsmithing2
	End	 
    
    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2800 ; level 1 (light  damage)  hit reaction animations in ms
        HitReactionLifeTimer2 = 3600 ; level 2 (medium damage)  hit reaction animations in ms

        HitReactionThreshold1 = 0.0   ; level 1 (light  damage) threshold trigger
        HitReactionThreshold2 = 50.0  ; level 2 (medium damage) threshold trigger
    End
    
  Behavior = AIUpdateInterface ModuleTag_03
    AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
    CanAttackWhileContained        =    Yes
    AILuaEventsList                =    IsengardDunlandArcherFunctions ;IsengardArcherFunctions
    MaxCowerTime                =    5000
    MinCowerTime                =    3000
    AttackPriority                =     AttackPriority_Archer
  End
  
  LocomotorSet
    Locomotor   = HumanLocomotor
    Condition   = SET_NORMAL
    Speed       = M_NORMAL_EVIL_FAST_MEMBER_SPEED
  End

  Behavior = PhysicsBehavior ModuleTag_04
    GravityMult = 1.0
    ShockStandingTime = 1200    ;msec
  End 
  
  Behavior = SlowDeathBehavior ModuleTag_05
    DeathTypes = ALL -KNOCKBACK
    SinkDelay = 3000
    SinkRate = 1.40     ; in Dist/Sec
    DestructionDelay = 8000
    Sound = INITIAL DunlendingVoiceDie            ;UrukCrossbowmanVoiceDie
  End
 
  Behavior = SquishCollide ModuleTag_06
    ;nothing
  End
 
  Behavior = SlowDeathBehavior ModuleTag_07
    ; Same as normal death, but no sound (sound already played by SoundImpact = ... )
    DeathTypes = NONE +KNOCKBACK
    SinkDelay = 3000
    SinkRate = 1.40     ; in Dist/Sec
    DestructionDelay = 8000
    ;Sound = INITIAL UrukVoiceDie
  End
  
  ; IsengardUrukCrossbow
  Behavior = HordeMemberCollide ModuleTag_HMC
    ;nothing
  End
 
  Behavior = BezierProjectileBehavior ModuleTag_08 ; Module starts asleep, and wakes up when thrown.
    ; 
    FirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
    SecondHeight = 24
    FirstPercentIndent = 30% ; Percentage of shot distance control points are placed
    SecondPercentIndent = 70%
    TumbleRandomly = Yes

    CrushStyle = Yes ; I don't detonate, I just hit
    DieOnImpact = Yes
    BounceCount = 1   ; When I hit the ground, I'll arc again
    BounceDistance = 40 ; this far
    BounceFirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
    BounceSecondHeight = 24
    BounceFirstPercentIndent = 20% ; Percentage of shot distance control points are placed
    BounceSecondPercentIndent = 80%

    GroundHitFX       = FX_ThrownRockGroundHit
    GroundBounceFX    = FX_ThrownRockBounceHit
  End

  Geometry = CYLINDER
  GeometryMajorRadius = 8.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 19.2
  GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 19;
  ShadowSizeY = 19;
  ShadowTexture = ShadowI;
End
