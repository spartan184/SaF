;------------------------------------------------------------------------------
;
;    warg.ini Used for Sharku Summon
;
;------------------------------------------------------------------------------
;------------------------------------------------------------------------------
; Warg 
Object SharkuWargSlave
    ; *** ART Parameters ***
    ; NOTE: If you are updating any of the art parameters, you should really check
    ; GondorCavalryRiderless in FactionSubObject.ini and see if it needs to be updated
    
    ; This is required for garrisoned objects - please put in all objects.
    ButtonImage = BIWargPit_Riders

    SelectPortrait         = UPNeutral_Warg


    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes
        RandomTexture = IUWargSntryA.tga 0 IUWargSntryA.tga
        RandomTexture = IUWargSntryB.tga 0 IUWargSntryA.tga

        DefaultModelConditionState
            Model                    = IUWarg_SKN
            Skeleton                = IUWarg_SKL
        End

        ; -------------- STUNNED ANIMS ----------------
        AnimationState                        = PASSENGER
            Animation                        = Grabbed
                AnimationName                = IUWarg_GBDA
                AnimationMode                = LOOP
            End
        End
        
        AnimationState                        = FREEFALL
            Animation                        = freefall
                AnimationName                = IUWarg_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
            End
        End
        
        AnimationState                =    DYING SPLATTED
            Animation                =    splatted
                AnimationName        =    IUWarg_LNDA
                AnimationMode        =    ONCE
            End
        End
        
        AnimationState                =    STUNNED_FLAILING 
            Animation                =    JustDie
                AnimationName       =    IUWarg_FLYA
                AnimationMode       =    LOOP
            End
        End

        AnimationState                =    STUNNED 
            Animation                =    Land
                AnimationName       =    IUWarg_LNDA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName       =    IUWarg_GTPA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                =    DYING
            Animation                =    JustDie
                AnimationName        =    IUWarg_DIEA
                AnimationMode        =    ONCE
            End
        End        
        
        ; -------------- MOVING ANIMS ---------------
        AnimationState                =    TURN_LEFT_HIGH_SPEED  
            Animation                =    MTurnLeft
                AnimationName        =    IUWarg_TNL1
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED
            Animation                =    MTurnRight
                AnimationName        =    IUWarg_TNR1
                AnimationMode        =    LOOP
            End
        End
        
        AnimationState                =    TURN_LEFT  
            Animation                =    TurnRight
                AnimationName        =    IUWarg_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    TURN_RIGHT 
            Animation                =    TurnRight
                AnimationName        =    IUWarg_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    MOVING ACCELERATE 
            Animation                =    Accelerate
                AnimationName        =    IUWarg_ACCL
                AnimationMode        =    ONCE
            End
            ParticleSysBone                = None GenericSiegeTrailDust
        End
    
        AnimationState                =    MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    IUWarg_DECL
                AnimationMode        =    ONCE
            End
            ParticleSysBone                = None GenericSiegeTrailDust
        End
        
        AnimationState                =    MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    IUWarg_BAKA
                AnimationMode        =    LOOP
            End
        End
        
        AnimationState                =    MOVING
            ShareAnimation            =    Yes
            Animation                =    RunA
                AnimationName        =    IUWarg_RUNA
                AnimationMode        =    LOOP
            End
            ;ParticleSysBone            =    None CalvaryDustTrails  
        End
        
        ; ----------- ATTACKING ANIMS --------------        
        AnimationState                =    BETWEEN_FIRING_SHOTS_A
            Animation                =    BetweenFiringShots
                AnimationName        =    IUWarg_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =   10
            End
        End

        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation                =    AttackA3
                AnimationName        =    IUWarg_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
        End
        
        AnimationState                =    ATTACKING
            Animation                =    AttackA3
                AnimationName        =    IUWarg_ATKA
                AnimationMode        =    LOOP
                AnimationBlendTime    =   10
            End
        End

        ; ----------- WAR CHANT ANIMS -------------
        AnimationState = WAR_CHANT
            Animation = Chant
                AnimationName = IUWarg_TNTA
                AnimationMode = LOOP
            End
        End

        ; ----------- EMOTION ANIMS ---------------
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = TNTA
                AnimationName            = IUWarg_TNTA
                AnimationMode            = LOOP
            End
        End
        
        AnimationState                    = EMOTION_CELEBRATING
            Animation                   = CHRA
                AnimationName            = IUWarg_CHRA
                AnimationMode            = ONCE
            End
        End
        
        ; ----------- IDLE ANIMS ---------------
        AnimationState                            = EMOTION_ALERT
            StateName                            = STATE_Ready 
            Animation                            = ALERT
                AnimationName                    = IUWarg_IDLA
                AnimationMode                    = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Ready") end
            EndScript    
        End

        AnimationState                            = DEATH_2
            StateName                            = STATE_Ready 
            Animation                            = ALERT
                AnimationName                    = IUWarg_IDLA
                AnimationMode                    = LOOP
            End   
        End
        
        ; ----------- SELECTED ANIMS --------------
        AnimationState                =    SELECTED
            SimilarRestart            =   Yes
            Animation                =    AtAttention
                AnimationName        =    IUWarg_ATNB
                AnimationMode        =    LOOP
            End
            StateName                = Selected
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("Idle_to_Selected") end
                if Prev == "STATE_Ready" then CurDrawableSetTransitionAnimState("Ready_to_Selected") end
            EndScript
        End

        IdleAnimationState
            Animation
                AnimationName        =    IUWarg_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    20
            End
            Animation
                AnimationName        =    IUWarg_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    1
            End
            StateName                = Idle 
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Idle") end
            EndScript
        End

        ;------------ TRANSITION ANIMS ----------------
        TransitionState       = Selected_to_Idle
            Animation           = ATNE
                AnimationName        =    IUWarg_ATNC
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End
        
        TransitionState       = Idle_to_Selected
            Animation           = ATND
                AnimationName     = IUWarg_ATNA
                AnimationMode   =    ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

    End

    ; ***DESIGN parameters ***
    Side                     = Isengard
    EditorSorting            = UNIT
    ThreatLevel              = 2.0
    TransportSlotCount       = 1
    
    WeaponSet
        Conditions           = None 
        Weapon               = PRIMARY    WargRiderlessWeapon
    End
    
    ArmorSet
        Conditions           = None
        Armor                = CavalryArmor
        DamageFX             = NormalDamageFX
    End

      VisionRange            = M_CREEP_VISION                
      ShroudClearingRange    = M_CREEP_VISION

    BountyValue              = M_ISENGARD_WARGRIDER_BOUNTY_VALUE
    DisplayName              = OBJECT:Warg
    
    CrushableLevel           = 1 ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
    CrusherLevel             = 1
    CrushWeapon              = WargCrush
    MinCrushVelocityPercent  = 50
    CrushDecelerationPercent =20
    IsTrainable              = No

    CommandSet               = EmptyCommandSet
    
    ; ******** AUDIO Parameters ********;
    SoundAmbient                = WargAmbienceVOX
    SoundImpact                = ImpactHorse
    ;SoundMoveLoop                = WargMoveFootsteps
    ;SoundCrushing                = WargRiderCrushing         ; Sound made when crushing another unit underhoof



      EvaEnemyUnitSightedEvent = WargRiderCreepSighted ; Special event for wargs showing up. Helps distinguish the real enemies from random creeps
      
    EvaEventDamagedOwner            = UnitUnderAttack         ;Eva event to trigger when unit is damaged
    ;EvaEventDieOwner            = GroupWargRiderDie        ;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths
                                        ;For deaths you can respawn from, use the DeathFX

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWarg_SKL.IUWarg_RUNA Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_TNL1 Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_TNR1 Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_TRNL Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_TRNR Frames:0
        AnimationSound = Sound:WargMoveFootsteps Animation:IUWARG_SKL.IUWARG_ACCL Frames:0
;        AnimationSound = Sound:WargRiderTauntCallouts Animation:IUWarg_SKL.IUWarg_TNTA Frames:27
        AnimationSound = Sound:WargTauntCallouts Animation:IUWarg_SKL.IUWarg_TNTA Frames:26 Animation:IUWarg_SKL.IUWarg_ATND Frames:7 Animation:IUWarg_SKL.IUWarg_HWLA Frames:17
        AnimationSound = Sound:WargTauntFootstep Animation:IUWarg_SKL.IUWarg_TNTA Frames:7 12 64 73
        ;AnimationSound = Sound:WargSaddleFoleySingles Animation:IUWarg_SKL.IUWarg_TNTA Frames:25 Animation:IUWarg_SKL.IUWarg_RUNA Frames:5 Animation:IUWarg_SKL.IUWarg_TNL1 Frames:5 Animation:IUWarg_SKL.IUWarg_TNR1 Frames:5 Animation:IUWarg_SKL.IUWarg_ACCL Frames:5 Animation:IUWarg_SKL.IUWarg_ATNA Frames:5 Animation:IUWarg_SKL.IUWarg_ATND Frames:5 Animation:IUWarg_SKL.IUWarg_GTPA Frames:5 101 Animation:IUWarg_SKL.IUWarg_HWLA Frames:15 Animation:IUWarg_SKL.IUWarg_RDYA Frames:5 Animation:IUWarg_SKL.IUWarg_RDYB Frames:5
    End

    ; Tie into LargeGroupAudio system
    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Warg
    End


    ; *** ENGINEERING Parameters ***

    RadarPriority = UNIT
    ThingClass = CAVALRY_UNIT

    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY PATH_THROUGH_INFANTRY GRAB_AND_DROP HAS_HEALTH_BAR CREEP SCORE
    
    Body = ActiveBody BodyModuleTag
        MaxHealth         = 400                  
        ;RecoveryTime      = 10000
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
    End
        
    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList    =    WargRiderFunctions
    End

    LocomotorSet
        Locomotor = WargLocomotor
        Condition = SET_NORMAL 
        Speed     = 80 ;80
    End    

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime = 3800    ;msec
    End
    
    Behavior = SquishCollide ModuleTag_06
        ;nothing
    End

    Behavior = SlowDeathBehavior ModuleTag_08
        ; Die and don't spawn horse
        DeathTypes = ALL 
        SinkDelay = 5000
        SinkRate = 1.50     ; in Dist/Sec
        DestructionDelay = 17000
        Sound = INITIAL WargVoxDie
    End

    Behavior                =    SlowDeathBehavior ModuleTag_09
        DeathTypes            =    NONE +FADED
        FadeDelay = 0
        FadeTime = 8000
        DestructionDelay = 8000
        DeathFlags = DEATH_2
        FX = INITIAL FX_RohirrimAlliesUnsummon
    End
    
    Behavior = SlavedUpdate ModuleTag_Slave
        GuardMaxRange        = 250
        GuardWanderRange    = 45
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 15
    GeometryMinorRadius = 15
    GeometryHeight = 20.0
    GeometryIsSmall = No

    Shadow = SHADOW_DECAL
    ShadowSizeX = 30;
    ShadowSizeY = 20;
    ShadowTexture = ShadowI;

End
ChildObject SharkuWargSlave_Summoned SharkuWargSlave
    IsTrainable = No
    CommandPoints = 0
    EquivalentTo = SharkuWargSlave
    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 75000
        MaxLifetime        = 75000
        DeathType        = FADED
    End 
End
Object SummonWargEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE
    
    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay = 2000
        OCL = FINAL OCL_SpawnSharkuWargs
    End
End

;------------------------------------------------------------------------------
Object SharkuWargSlave_SummonedHorde

      ; This is required for garrisoned objects - please put in all objects.
    ButtonImage        = BIWargPit_Riders
    SelectPortrait    = UPNeutral_Warg

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None ;InvisHrdeTmp5x1
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End        
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End
    
    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:Warg
    
    WeaponSet
        Conditions = None 
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder        ; Spear
        Weapon        = SECONDARY    NormalMissileHordeRangefinder    ; Bow
    End


    ; *** AUDIO Parameters ***;
    ; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
    ; are always passed through to members


    BuildCost = 0        
    BuildTime = 0            
    VisionRange = M_VISION_STANDARD_HORSE         
    CommandPoints = 0
    IsTrainable = No
    CommandSet = WargSummonHordeCommandSet
          
    FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
    FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
    CrushableLevel = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
    CrusherLevel = 1 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
    MinCrushVelocityPercent = 30 ; Has to be moving at at least 50% of full speed.
    CrushDecelerationPercent = 35 ; Lose 20 percent of max velocity when crushing.
    CrushKnockback = 50  ; how hard we knock back crushed units.
    CrushZFactor = 1.0  ; How much we knock upwards.
        
    
    TransportSlotCount = 1
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY SUMMONED;UNATTACKABLE 
    
    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End
    
    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    M_INFANTRY_TAUNT_POINT_RADIUS        ; max distance to taunted/pointed objet
        TauntAndPointUpdateDelay    =    1000    ; how often scan (milliseconds)
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    NONE +RohanOathbreakerHordeSmall +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorFellBeast +MordorWitchKingOnFellBeast +MordorBalrog +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorMumakil ;Must be SCARY kindof as well.
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker; +MordorWitchKing +MordorWitchKingOnFellBeast
        PointAt                =    NONE +GondorGwaihir 
        HeroScanDistance        =    150
        FearScanDistance        =    M_CAVALRY_FEAR_SCAN_RADIUS ;250

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base    
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End    
    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained = 
        InitialPayload = SharkuWargSlave_Summoned 5
        Slots = 5
        PassengerFilter = NONE +CAVALRY +IsengardBannerOrc
        ShowPips = No
        RandomOffset = X:15 Y:4
        
        ; Banner Carrier info        
        BannerCarriersAllowed    = IsengardBannerOrc                                        ; types of units that are allowed as banner carriers
        BannerCarrierPosition    = UnitType:IsengardWargRider    Pos:X:40.0 Y:0.0        ; (DEFAULT) position of banner carrier
        
        RankInfo = RankNumber:1 UnitType:SharkuWargSlave_Summoned Position:X:0 Y:0        Position:X:30 Y:20        Position:X:30 Y:-20        Position:X:-30 Y:-20        Position:X:-30 Y:20 

        ThisFormationIsTheMainFormation = Yes    ;Used to determine which armorset to use (and anything else we want!)
                
        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 65; How far the hordes can move from the center of the horde when melee attacking.        
;        AttributeModifiers = IsengardWargSkirmish
    End
    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End    
    Behavior = SpecialPowerModule ModuleTag_HowlUpdate   
        SpecialPowerTemplate      = SpecialAbilityWargHowl
        UpdateModuleStartsAttack  = No
        AttributeModifier = IsengardWargHowl
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects = ANY +CAVALRY  ;
        AttributeModifierFX = FX_WargHowl
    End
    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 75000
        MaxLifetime        = 75000
        DeathType        = FADED
    End 
    LocomotorSet
        Locomotor     = WargCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = M_NORMAL_CAVALRY_HORDE_SPEED
    End
    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End    
    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End