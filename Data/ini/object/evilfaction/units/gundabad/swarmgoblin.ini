;------------------------------------------------------------------------------
; aka Goblin Swordsman
Object GundabadSwarmGoblin
  ; *** ART Parameters ***

    ; This is required for garrisoned objects - please put in all objects.
    ButtonImage = BuildingNoArt
  
  Draw = W3DHordeModelDraw ModuleTag_01

    OkToChangeModelColor = Yes
      
    StaticModelLODMode = Yes
    ; specify options for static LODs
    LodOptions    = LOW
        AllowMultipleModels        =    M_ALLOW_MULTIPLE_MODELS_LOW
        MaxRandomTextures        =    M_MAX_RANDOM_TEXTURES_LOW
        MaxRandomAnimations        =    M_MAX_RANDOM_ANIMATIONS_LOW
        MaxAnimFrameDelta        =    0 ;These guys are out of a horde more often than in, so they need permission to diverge.
    End
    
    LodOptions    = MEDIUM
        AllowMultipleModels        =    M_ALLOW_MULTIPLE_MODELS_MED
        MaxRandomTextures        =    M_MAX_RANDOM_TEXTURES_MED
        MaxRandomAnimations        =    M_MAX_RANDOM_ANIMATIONS_MED
        MaxAnimFrameDelta        =    0 ;These guys are out of a horde more often than in, so they need permission to diverge.
    End
    
    LodOptions    = HIGH
        AllowMultipleModels        =    M_ALLOW_MULTIPLE_MODELS_HIGH
        MaxRandomTextures        =    M_MAX_RANDOM_TEXTURES_HIGH
        MaxRandomAnimations        =    M_MAX_RANDOM_ANIMATIONS_HIGH
        MaxAnimFrameDelta        =    0 ;These guys are out of a horde more often than in, so they need permission to diverge.
    End
        
        RandomTexture = MUGundgob01.tga 0 MUGundgob01.tga
        RandomTexture = MGundgob02.tga 0 MUGundgob01.tga


    DefaultModelConditionState
      Model = MUGundgob_SKN
      Skeleton = MUGblnSwrd_SKL
    End

;;==================== ANIMATIONS ================================================================
;;-------------------- FLYING & DYING ------------------------------------------------------------
;;======= FALLING

        AnimationState                        = PASSENGER
            Animation                        = Wiggling
                AnimationName                = MUGblnSwrd_FLLA
                AnimationMode                = LOOP
            End
        End
        
        AnimationState                        = THROWN_PROJECTILE
            StateName                        = STATE_Flying
            Animation                        = Thrown
                AnimationName                = MUGblnSwrd_FLYA
                AnimationMode                = LOOP
            End
        End
        
        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = MUGblnSwrd_FLYB
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.7    0.7
            End
        End
        
        AnimationState                        = STUNNED_FLAILING
            StateName                        = STATE_Flying
            Animation                        = ready_for_sweet_landing
                AnimationName                = MUGblnSwrd_FLYA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
                AnimationBlendTime            = 0
            End
            Animation                        = flying
                AnimationName                = MUGblnSwrd_FLYB
                AnimationMode                = LOOP
                AnimationPriority            = 10
                AnimationSpeedFactorRange    = 0.9 1.1
                AnimationBlendTime            = 0
            End
            Flags                            = RANDOMSTART
        End
        
        AnimationState                        = DYING SPLATTED
            Animation                        = splat
                AnimationName                = MUGblnSwrd_LNDB
                AnimationMode                = ONCE
            End
        End


        
;;======= DYING

        AnimationState                        = DYING AFLAME
            StateName                        = STATE_Dead.
            Animation                        = Flaming_Death
                AnimationName                = MUGblnSwrd_MFDA
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = DYING
            StateName                        = STATE_Dead.
            Animation                        = Dying_1
                AnimationName                = MUGblnSwrd_DIEA
                AnimationMode                = ONCE
            End
            Animation                        = Dying_2
                AnimationName                = MUGblnSwrd_DIEB
                AnimationMode                = ONCE
            End
            Animation                        = landb
                AnimationName                = MUGblnSwrd_LNDB
                AnimationMode                = ONCE
            End
            Animation                        = landc
                AnimationName                = MUGblnSwrd_LNDC
                AnimationMode                = ONCE
            End
            BeginScript
                Preva = CurDrawablePrevAnimation()
                if Preva == "ready_for_sweet_landing" then return "landc" 
                elseif Preva == "flying" then return "landb"
                elseif GetClientRandomNumberReal(0,1) > 0.50 then return "Dying_1"
                else return "Dying_2" end
            EndScript
        End
        
        AnimationState                        = STUNNED_STANDING_UP
            StateName                        = STATE_Ready
            Animation                        = standing_back_up
                AnimationName                = MUGblnSwrd_GTPA
                AnimationMode                = ONCE
                
            End
            Animation                        = already_up
                AnimationName                = MUGblnSwrd_IDLB
                AnimationMode                = LOOP
                AnimationBlendTime            = 20
            End
            BeginScript
                if CurDrawablePrevAnimation() == "sweet_landing"
                then
                    return "already_up"
                else
                    return "standing_back_up"
                end
            EndScript
        End
                
        AnimationState                        = STUNNED
            StateName                        = STATE_Stunned
            Animation                        = splatted_on_ground
                AnimationName                = MUGblnSwrd_LNDC
                AnimationMode                = ONCE
            End
            Animation                        = sweet_landing
                AnimationName                = MUGblnSwrd_LNDA
                AnimationMode                = ONCE
            End
            BeginScript
                if CurDrawablePrevAnimation() == "ready_for_sweet_landing"
                then
                    return "sweet_landing"
                else
                    return "splatted_on_ground"
                end
            EndScript
        End

        

  ;;------------------ MOVING -----------------------------------------------------------------------
  
  
  
        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation = TrotAndFire
                AnimationName = MUGblnSwrd_ATRA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
            ;ParticleSysBone = None InfantryDustTrails
        End
    
        AnimationState                        = MOVING BACKING_UP
            Animation                        = BackingUp
                AnimationName                = MUGblnSwrd_BAKA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
            End
            Animation                        = BackingUp
                AnimationName                = MUGblnSwrd_BAKB
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
            End
            Flags                            = RANDOMSTART
        End
        
        AnimationState                        = MOVING EMOTION_TERROR
            ShareAnimation                    = Yes
            Animation                        = Moving_1
                AnimationName                = MUGblnSwrd_RUNA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
                Distance                    = 20
            End
;            Animation                        = Moving_3
;                AnimationName                = MUGblnSwrd_RUNC
;                AnimationMode                = LOOP
;                AnimationSpeedFactorRange    = 0.9 1.1
;            End
            Flags                            = RANDOMSTART
            ParticleSysBone                    = None InfantryDustTrails
        End
        
        AnimationState                        = MOVING
            StateName                        = STATE_Running
            ShareAnimation                    = Yes
            Animation                        = Moving_1
                AnimationName                = MUGblnSwrd_RUNA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
                Distance                    = 20
            End
;            Animation                        = Moving_3
;                AnimationName                = MUGblnSwrd_RUNC
;                AnimationMode                = LOOP
;                AnimationSpeedFactorRange    = 0.9 1.1
;                Distance                    = 10
;            End
            Flags                            = RANDOMSTART
            ParticleSysBone                    = None InfantryDustTrails
        End
        
;;------------------ ATTACKING ------------------------------------------------------------
        
        AnimationState                        = FIRING_OR_PREATTACK_A
            StateName                        = STATE_Ready
            Animation                        = ATKA
                AnimationName                = MUGblnSwrd_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes    
            End
        ParticleSysBone = None MeleeDust
        End
        
;;------------------ EMOTIONS ------------------------------------------------------------

        AnimationState                        = EMOTION_AFRAID
            Animation                        = FERA
                AnimationName                = MUGblnSwrd_FERA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
            End
            ;Flags                            = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                        = EMOTION_TAUNTING
            Animation                        = TNTA
                AnimationName                = MUGblnSwrd_TNTA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
            End
            ;Flags                            = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                        = EMOTION_POINTING
            Animation                        = Pointing1
                AnimationName                = MUGblnSwrd_PNTA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
            End
        End
        AnimationState                        = EMOTION_CELEBRATING
            Animation                        = CHRA
                AnimationName                = MUGblnSwrd_CHRA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
            End
        End
        AnimationState                        = EMOTION_ALERT
            Animation                        = IDLB
                AnimationName                = MUGblnSwrd_IDLB
                AnimationMode                = LOOP
            End
        End
        
;;------------------ SELECTED STATE --------------------------------------------------------


;;------------------ IDLE STATE ------------------------------------------------------------
        
        IdleAnimationState
            StateName                        = Idle
            Animation                        = IDLA
                AnimationName                = MUGblnSwrd_IDLA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.9 1.1
                AnimationPriority            = 20
            End
            Animation                        = IDLC
                AnimationName                = MUGblnSwrd_IDLC
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.9 1.1
            End
        End
        
;;-------------------- TRANSITIONS ---------------------------------------------------------
 
;;------------------------------------------------------------------------------------------    
  End

  ; ***DESIGN parameters ***
  Side = Gundabad
  EditorSorting = UNIT
  ThreatLevel = 1.0
  ThingClass = HORDE_UNIT
  CommandPoints = 1

  TransportSlotCount = 1
  WeaponSet
    Conditions = None 
    Weapon = PRIMARY    GundabadGoblinSword
    AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
  End
  ArmorSet
    Conditions      = None
    Armor           = GundabadSwarmArmor
    DamageFX        = NormalDamageFX
  End
  
    VisionRange = M_VISION_STANDARD_MELEE
    ShroudClearingRange = M_SHROUD_CLEAR_STANDARD

  DisplayName = OBJECT:GundabadSwarmGoblin
  CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CrusherLevel = 0 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
  BountyValue = SAF_GUNDABAD_GOBLIN_BOUNTY_VALUE
  CrushRevengeWeapon = BasicInfantryCrushRevenge
  CommandSet = GenericHordeMemberCommandSet

    ; *** AUDIO Parameters ***;

    VoiceAttack            = OrcFighterVoiceAttack
    VoiceAttack2            = OrcVoiceAttack2
    VoiceAttackCharge    = OrcFighterVoiceAttackCharge
    VoiceAttackStructure    = OrcFighterVoiceAttackBuilding
    VoiceCreated            = CampOrcCreateGundabadGoblinSwarm
    VoiceFullyCreated        = CampOrcCreateGundabadGoblinSwarm
    VoiceMove            = OrcFighterVoiceMove
    VoiceMove2            = OrcVoiceMove2
    VoiceMoveToCamp        = OrcFighterVoiceMoveCamp
    VoicePriority            = 10
    VoiceRetreatToCastle    = OrcFighterVoiceRetreat
    VoiceSelect            = OrcFighterVoiceSelect
    VoiceSelect2            = UrukSwordmanVoiceSelect2
    VoiceSelectBattle        = OrcFighterVoiceSelectBattle

    VoiceEnterStateAttack            = OrcFighterVoiceEnterStateAttack
    VoiceEnterStateAttackCharge    = OrcFighterVoiceEnterStateAttackCharge
    VoiceEnterStateAttackStructure    = OrcFighterVoiceEnterStateAttackBuilding
    VoiceEnterStateMove            = OrcFighterVoiceEnterStateMove
    VoiceEnterStateMoveToCamp    = OrcFighterVoiceEnterStateMoveCamp
    VoiceEnterStateRetreatToCastle    = OrcFighterVoiceEnterStateRetreat
    VoiceGuard                    = OrcFighterVoiceMove

    SoundImpact                    = ImpactHorse
    
    UnitSpecificSounds
        VoiceGarrison            = OrcFighterVoiceGarrison
        VoiceEnterUnitMordorMumakil    = OrcFighterVoiceEnterMumakil
        VoiceEnterUnitSlaughterHouse    = OrcFighterVoiceGarrisonSlaughterHouse
    End

    EvaEventDamagedOwner        = UnitUnderAttack

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
          MaxUpdateRangeCap = 800
            AnimationSound = Sound:BodyFallGeneric2    Animation:MUGblnSwrd_SKL.MUGblnSwrd_DIEA    Frames:10
            AnimationSound = Sound:BodyFallGeneric2    Animation:MUGblnSwrd_SKL.MUGblnSwrd_DIEB    Frames:7
            AnimationSound = Sound:BodyFallOrc        Animation:MUGblnSwrd_SKL.MUGblnSwrd_LNDB    Frames:3
            AnimationSound = Sound:BodyFallOrc        Animation:MUGblnSwrd_SKL.MUGblnSwrd_LNDB    Frames:0
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Goblin
    End


  ; *** ENGINEERING Parameters ***

  RadarPriority = UNIT
  KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER CAN_USE_SIEGE_TOWER SCORE THROWN_OBJECT ARMY_SUMMARY ORC GRAB_AND_DROP
 
  Body = ActiveBody ModuleTag_02
    MaxHealth         = SAF_GUNDABAD_GOBLIN_HEALTH            ;BALANCE Orc Warrior Health
    MaxHealthDamaged  = SAF_GUNDABAD_GOBLIN_HEALTH_DAMAGED
    ;RecoveryTime      = SAF_GUNDABAD_GOBLIN_HEALTH_RECOVERY_TIME
  End
 
  Behavior = AIUpdateInterface ModuleTag_03
    AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
    MoodAttackCheckRate        = 500
    AILuaEventsList                =    SwarmGoblinFunctions
    AttackPriority                =     AttackPriority_Infantry
  End

  LocomotorSet
    Locomotor     = HumanLocomotor
    Condition     = SET_NORMAL
    Speed         = M_NORMAL_EVIL_FAST_MEMBER_SPEED
  End

  Behavior = PhysicsBehavior ModuleTag_04
    GravityMult = 1.0
    ShockStunnedTimeLow        = 800    ;msec
    ShockStunnedTimeHigh    = 1000    ;msec
    ShockStandingTime        = 2133    ;msec
  End
 
  Behavior = SlowDeathBehavior ModuleTag_05
    DeathTypes = ALL -KNOCKBACK
    SinkDelay = 3000
    SinkRate = 0.40     ; in Dist/Sec
    DestructionDelay = 8000
    Sound = INITIAL GoblinVoiceDie            ;UrukDie
  End
 
  Behavior = SquishCollide ModuleTag_06
    ;nothing
  End
 
  Behavior = HordeMemberCollide ModuleTag_HMC
    ;nothing
  End 
 
  Behavior = SlowDeathBehavior ModuleTag_07
    ; Same as normal death, but no sound (sound already played by SoundImpact = ... )
    DeathTypes = NONE +KNOCKBACK
    SinkDelay = 3000
    SinkRate = 0.40     ; in Dist/Sec
    DestructionDelay = 8000
    Sound = INITIAL GoblinVoiceDie
  End
 
  Behavior = BezierProjectileBehavior ModuleTag_08 ; Module starts asleep, and wakes up when thrown.
    ; 
    FirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
    SecondHeight = 24
    FirstPercentIndent = 30% ; Percentage of shot distance control points are placed
    SecondPercentIndent = 70%
    TumbleRandomly = Yes

    CrushStyle = Yes ; I don't detonate, I just hit
    DieOnImpact = Yes
    BounceCount = 1   ; When I hit the ground, I'll arc again
    BounceDistance = 40 ; this far
    BounceFirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
    BounceSecondHeight = 24
    BounceFirstPercentIndent = 20% ; Percentage of shot distance control points are placed
    BounceSecondPercentIndent = 80%

    GroundHitFX       = FX_ThrownRockGroundHit
    GroundBounceFX    = FX_ThrownRockBounceHit
  End        
    
     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    M_INFANTRY_TAUNT_POINT_RADIUS        ; max distance to taunted/pointed objet
        TauntAndPointUpdateDelay    =    1000    ; how often scan (milliseconds)
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    NONE +RohanOathbreakerHordeSmall +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorFellBeast +MordorWitchKingOnFellBeast +MordorBalrog +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorMumakil ;Must be SCARY kindof as well.
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker; +MordorWitchKing +MordorWitchKingOnFellBeast
        PointAt                =    NONE +GondorGwaihir 
        HeroScanDistance        =    150
        FearScanDistance        =    M_INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base    
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End        
    
  Geometry = CYLINDER
  GeometryMajorRadius = 8.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 19.2
  GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 11;
  ShadowSizeY = 11;
  ShadowTexture = ShadowI;
End
