;------------------------------------------------------------------------------
Object RivendellStatue

	SelectPortrait  =  BPRivendellStatue

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		OkToChangeModelColor		= Yes
		StaticModelLODMode = No
		UseStandardModelNames		= Yes

		DefaultModelConditionState
			Model					= abstatue_skn
		End

    IdleAnimationState
      BeginScript
      Prev = CurDrawablePrevAnimationState()
      if Prev == "BeingConstructed" then 
          ; Don't play completed sound when canceling build-in-progress or when
          ; destroyed halfway
          if not CurDrawableModelcondition( "DYING" ) then 
          CurDrawablePlaySound("CampRivendellElfBuildGilGaladStatue")
        end
      end
      EndScript
    End
 
		ModelConditionState = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			Model					= abstatue_bld
			ParticleSysBone			= NONE BuildingContructDust
		End  
		AnimationState = ACTIVELY_BEING_CONSTRUCTED
			Animation
				AnimationName		= abstatue_bld.abstatue_bld
				AnimationMode		= MANUAL
			End
			StateName				= BeingConstructed
			BeginScript
				CurDrawablePlaySound("GondorBarracksBeginConstruction")
			EndScript
		End

		ModelConditionState = DAMAGED
			Model					= abstatue_d1
		End  
		AnimationState = DAMAGED
			EnteringStateFX			= FX_StatueDamaged
		End

		ModelConditionState = REALLYDAMAGED
			Model					= abstatue_d2
			ParticleSysBone FIRE01 FireBuildingLarge
			ParticleSysBone FIRE01 SmokeBuildingLarge
		End  
		AnimationState = REALLYDAMAGED
			; Animation	= RubbleAnimation
				; AnimationName		=	abstatue_d1.abstatue_d1
				; AnimationMode		=	ONCE	
	  		; End
			EnteringStateFX			= FX_StatueDamaged
		End

		ModelConditionState = RUBBLE
			Model					= abstatue_d2
			ParticleSysBone FIRE01 FireBuildingLarge
			ParticleSysBone FIRE01 SmokeBuildingLarge
		End
		AnimationState = RUBBLE
			; Animation	= RubbleAnimation
				; AnimationName		=	abstatue_d2.abstatue_d2
				; AnimationMode		=	ONCE	
	  		; End
	  		EnteringStateFX			= FX_StatueDamaged
		End

		ModelConditionState = POST_RUBBLE
			Model					= None
			ParticleSysBone NONE SmokeBuildingMediumRubble
		End

		ModelConditionState = POST_COLLAPSE
			Model					= None
			ParticleSysBone NONE SmokeBuildingMediumRubble
		End
	End

	; Draw module just for the hero FX.
	Draw = W3DScriptedModelDraw TheHealEffect
		ModelConditionState = NONE
			Model					= None
			ParticleSysBone NONE StatueHeroFX
		End
		ModelConditionState = ACTIVELY_BEING_CONSTRUCTED
			Model					= None
		End
	End

	; ***DESIGN parameters ***
	DisplayName			    = OBJECT:RivendellStatue
	Description			    = OBJECT:RivendellStatueDesc
	Side				        = Rivendell
	EditorSorting		    = STRUCTURE
	ThreatLevel			    = 1.0
	IsTrainable 		    = No
	CommandSet			    = SellableCommandSet
	PlacementViewAngle	= 0

	BuildCost			      = GONDOR_STATUE_BUILDCOST
	BuildTime			      = GONDOR_STATUE_BUILDTIME
	RefundValue			    = 50
	VisionRange			    = GONDOR_STATUE_VISION_RANGE
	ShroudClearingRange	= GONDOR_STATUE_SHROUD_CLEAR
	BountyValue			    = GONDOR_STATUE_BOUNTY_VALUE
	
	ArmorSet
		Conditions		    = None
		Armor			        = StructureArmor
	End

	; *** AUDIO Parameters ***
	VoiceSelect						        = GondorStatueSelect
	SoundOnDamaged					      = BuildingLightDamageStone
	SoundOnReallyDamaged			    = BuildingHeavyDamageStone

	VoiceSelectUnderConstruction	= BuildingGoodVoiceSelectUnderConstruction

	UnitSpecificSounds
		UnderConstruction			      = BuildingConstructionLoop  ; Built first time
		UnderRepairFromRubble		    = BuildingConstructionLoop	; Repaired from completely destroyed (not used???)
	End

	ClientBehavior                = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap			      = 800
		AnimationSound				      = Sound:StatueHeroicBuildStoneExplode	Animation:GPHealstue_A.GPHealstue_A		Frames:540
		AnimationSound				      = Sound:StatueHeroicBuildStoneDebris1	Animation:GPHealstue_A.GPHealstue_A		Frames:560
		AnimationSound				      = Sound:StatueHeroicBuildStoneDebris2	Animation:GPHealstue_A.GPHealstue_A		Frames:600
	End

	; *** ENGINEERING Parameters ***
	RadarPriority		    = STRUCTURE
	KindOf				      = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE MADE_OF_STONE CAN_SEE_THROUGH_STRUCTURE IGNORE_FOR_VICTORY NEED_BASE_FOUNDATION

	Body                      = StructureBody ModuleTag_05
		MaxHealth				        = GONDOR_STATUE_HEALTH
		MaxHealthDamaged		    = GONDOR_STATUE_HEALTH_DAMAGED
		MaxHealthReallyDamaged	= GONDOR_STATUE_HEALTH_REALLY_DAMAGED
	End
  
  Behavior                  = CastleMemberBehavior ModuleTag_CMB
  End
  
	Behavior                  = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
		DestructionDelay			  = 5000
	End

	Behavior                  = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero
		EffectRadius			      = 200 ; please update the decal size in experience lvl INI if you change this... the value there is about 2.2x the value here
		PingDelay				        = 2000;msec

		ModifierName			      = HeroicStatuePassiveLeadership
		ModifierName			      = HeroicStatuePassiveExperienceRateBonus
		
		AllowFilter				      = ANY +INFANTRY +CAVALRY -MACHINE -IMMOBILE -HERO   
	End
	
	Behavior                  = GettingBuiltBehavior GetBuiltBehaviorTag
		WorkerName					    = RivendellWorkerNoSelect
	End

	Behavior                  = StructureCollapseUpdate ModuleTag_Collapse
		MinCollapseDelay			  = 000
		MaxCollapseDelay			  = 000
		CollapseDamping				  = 0.5
		MaxShudder					    = 0.6
		MinBurstDelay				    = 250
		MaxBurstDelay				    = 800
		BigBurstFrequency			  = 4
		FXList						      = INITIAL FX_StructureMediumCollapse
		FXList						      = ALMOST_FINAL FX_StructureAlmostCollapse
		DestroyObjectWhenDone		= Yes
		CollapseHeight				  = 126
	End
	
	Behavior                  = CostModifierUpgrade ModuleTag_CostModifier
		LabelForPalantirString  = GUI:HERO_DISCOUNT
			StartsActive          = Yes ; Run on build complete, not upgrade
		ObjectFilter		        = ANY +HERO
		Percentage		          = 0%
		Percentage		          = -10%
		Percentage		          = -20%
		Percentage		          = -30%
	End

	Geometry						      = CYLINDER
	GeometryMajorRadius				= 12.0
	GeometryMinorRadius				= 12.0
	GeometryHeight					  = 70.0
	GeometryIsSmall					  = No
	Shadow							      = SHADOW_VOLUME
	BuildCompletion					  = PLACED_BY_PLAYER
	
	GeometryContactPoint      = X:-26		Y:27		Z:0			Repair
	GeometryContactPoint      = X:28		Y:-25		Z:0			Repair
	GeometryContactPoint      = X:5.576		Y:44.987	Z:0
	GeometryContactPoint      = X:-38.348	Y:-42.113	Z:0
	GeometryContactPoint      = X:-28.448	Y:-0.003	Z:75.14		Swoop
End