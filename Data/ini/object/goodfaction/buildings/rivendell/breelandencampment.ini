;------------------------------------------------------------------------------
;Bree-Land Structure
Object RivendellBreeLandEncampment
	
  SelectPortrait = BPRivendellEncampment
  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_Draw
  
	ExtraPublicBone = ARROW_01
	ExtraPublicBone = ARROW_02
	ExtraPublicBone = ARROW_03
	ExtraPublicBone = ARROW_04
	ExtraPublicBone = ARROW_05
	ExtraPublicBone = ARROW_06
	ExtraPublicBone = ARROW_07
	ExtraPublicBone = ARROW_08
  
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    
	DefaultModelConditionState
		Model = abbreecamp_skn
		WeaponLaunchBone = PRIMARY ARROW_
    End
		
		IdleAnimationState
			StateName					=   STATE_Idle
			Animation = IdleA
				AnimationName			=	abbreecamp_skl.abbreecamp_A1
				AnimationMode		=	ONCE 
				AnimationPriority		=	9
			End
			Flags               = RESTART_ANIM_WHEN_COMPLETE 
      BeginScript
      Prev = CurDrawablePrevAnimationState()
      if Prev == "BeingConstructed" then 
          ; Don't play completed sound when canceling build-in-progress or when
          ; destroyed halfway
          if not CurDrawableModelcondition( "DYING" ) then 
          CurDrawablePlaySound("CampRivendellElfBuildEncampment")
        end
      end
      EndScript
		End
		
		;--------------------------------------------------
		
		ModelConditionState   = AWAITING_CONSTRUCTION
			Model               = abbreecamp_bld
;			ParticleSysBone	  = NONE BuildingDoughnutCloud
		End
		AnimationState        = AWAITING_CONSTRUCTION
			Animation
				AnimationName	=abbreecamp_bld.abbreecamp_bld
				AnimationMode	= MANUAL
			End
			Flags				= START_FRAME_FIRST
		End
		
		ModelConditionState		=	ACTIVELY_BEING_CONSTRUCTED
			Model				=	abbreecamp_bld
			ParticleSysBone   = Chimney BuildingContructDust
		End;
		AnimationState        = ACTIVELY_BEING_CONSTRUCTED
			Animation
				AnimationName     = abbreecamp_bld.abbreecamp_bld
				AnimationMode     = MANUAL
			End
			Flags				= START_FRAME_FIRST
			StateName			= BeingConstructed
			BeginScript
				; CurDrawableHideSubObjectPermanently("V1")
				; CurDrawableHideSubObjectPermanently("V2")
				; CurDrawableHideSubObjectPermanently("OBJECT01")
				; CurDrawableHideSubObjectPermanently("OBJECT02")
				; CurDrawableHideSubObjectPermanently("OBJECT03")
				CurDrawablePlaySound("GondorBarracksBeginConstruction")
			EndScript
		End

    ;--damaged building

    ModelConditionState  = DAMAGED
      Model         = abbreecamp_D1
		ParticleSysBone FireSmall01 FireBuildingSmall
		ParticleSysBone FireSmall02 FireBuildingLarge
		ParticleSysBone FireSmall03 FireBuildingMedium
		ParticleSysBone FireSmall04 FireBuildingMedium
		ParticleSysBone FireSmall05 SmokeBuildingMedium
    End
    
    AnimationState = DAMAGED
		EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = abbreecamp_D2
		ParticleSysBone FireSmall01 SmokeBuildingMedium
		ParticleSysBone FireSmall02 FireBuildingLarge
		ParticleSysBone FireSmall03 FireBuildingMedium
		ParticleSysBone FireSmall04 FireBuildingMedium
		ParticleSysBone FireSmall05 FireBuildingLarge
    End
    
    AnimationState = REALLYDAMAGED
		EnteringStateFX	= FX_BuildingReallyDamaged
		Animation				=	RubbleAnimation
				AnimationName		=	abbreecamp_skl.abbreecamp_D2
				AnimationMode		=	ONCE
  		End
    End

    ModelConditionState  = RUBBLE
      Model         = abbreecamp_D2
      ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End
    
    AnimationState = RUBBLE
		EnteringStateFX	= FX_StructureMediumCollapse
		Animation				=	RubbleAnimation
				AnimationName		=	abbreecamp_D2.abbreecamp_D2
				AnimationMode		=	ONCE
  		End
    End

    ModelConditionState  = POST_RUBBLE
		 Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
    End

    ModelConditionState  = POST_COLLAPSE
		 Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
    End
	
	;ModelConditionState = USER_2
	;	ParticleSysBone = None PartyPipeSmoke ;FollowBone:Yes ;HouseColor:yes
	;	ParticleSysBone = None PartyPipeSmoke2 ;FollowBone:Yes ;HouseColor:yes		
    ;End

  End
  
  Draw = W3DFloorDraw ModuleTag_DrawFloor    
		StaticModelLODMode = Yes		; THIS NEEDS TO BE COMMENTED OUT WHEN ENGINEERING ENABLES LOD'S IN THE FLOOR DRAW
		ModelName = abbreecamp_bib
  End
  
	; ; Dedicated draw module just for the horde effects.
	; Draw = W3DScriptedModelDraw TheHordeEffects
		; DefaultModelConditionState
		; Model = None
		; End
		; AnimationState = UPGRADE_ECONOMY_BONUS
		; ParticleSysBone = None CalltheHordeSteam
		; ParticleSysBone	= None CalltheHordeCast
		; End
	; End  
    
  ; ***DESIGN parameters ***

	DisplayName         = OBJECT:RivendellEriadorEncampment
	Description 	      = OBJECT:RivendellEriadorEncampmentDesc
	Side                = Rivendell
	EditorSorting       = STRUCTURE
	ThreatLevel 		    = 1.0
	CommandSet          = RivendellEriadorEncampmentCommandSet
	BuildCost           = GONDOR_ARCHERYRANGE_BUILDCOST
	BuildTime           = GONDOR_ARCHERYRANGE_BUILDTIME
	BountyValue         = GONDOR_ARCHERYRANGE_BOUNTY_VALUE
	VisionRange         = GONDOR_ARCHER_VISION_RANGE          ; Shroud clearing distance
	ShroudClearingRange = GONDOR_ARCHERYRANGE_SHROUD_CLEAR
  
	ArmorSet
		Conditions        = None
		Armor             = StructureArmor
	End

	WeaponSet
		Conditions		= None
	End

  ; *** AUDIO Parameters ***
	VoiceSelect					          = RohanArcheryRangeSelect

	SoundAmbientDamaged			      = GenericFireMediumLoop
	SoundAmbientReallyDamaged	    = GenericFireLargeLoop
	SoundOnDamaged				        = BuildingLightDamageStone
	SoundOnReallyDamaged		      = BuildingHeavyDamageStone

	VoiceSelectUnderConstruction	= BuildingGoodVoiceSelectUnderConstruction
	
	UnitSpecificSounds
		UnderConstruction		        = BuildingConstructionLoop  	; Built first time
		UnderRepairFromRubble	      = BuildingConstructionLoop	; Repaired from completely destroyed (not used???)
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		; AnimationSound = Sound: GondorArcheryRangeHits1 Animation: GBArcheryN_SKL.GBArcheryN_IDLA Frames: 40                                                    
		; AnimationSound = Sound: GondorArcheryRangeHits2 Animation: GBArcheryN_SKL.GBArcheryN_IDLA Frames: 43                                                    
 		AnimationSound = Sound: GondorArcheryRangeArrowQuiver Animation:GBArcheryN_SKL.GBArcheryN_IDLA Frames: 56 58
		AnimationSound = Sound: GondorArcheryRangeBows Animation:GBArcheryN_SKL.GBArcheryN_IDLA Frames: 38 40 
		AnimationSound = Sound: GondorArcheryRangeDrawBow Animation:GBArcheryN_SKL.GBArcheryN_IDLA Frames: 15 17
 		AnimationSound = Sound: GondorArcheryRangeVoiceFire Animation:GBArcheryN_SKL.GBArcheryN_IDLA Frames: 26
 		AnimationSound = Sound: GondorArcheryRangeVoiceAim Animation:GBArcheryN_SKL.GBArcheryN_IDLA Frames: 80
 		AnimationSound = Sound: GondorArcheryRangeHits1 Animation:GBArcheryN_SKL.GBArcheryN_IDLA Frames: 42
 		AnimationSound = Sound: GondorArcheryRangeHits2 Animation:GBArcheryN_SKL.GBArcheryN_IDLA Frames: 44
	End

  ; *** ENGINEERING Parameters ***

	RadarPriority       = STRUCTURE
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE FS_FACTORY AUTO_RALLYPOINT MP_COUNT_FOR_VICTORY NEED_BASE_FOUNDATION ATTACK_NEEDS_LINE_OF_SIGHT CAN_ATTACK

	Behavior = GettingBuiltBehavior GetBuiltBehaviorTag
		WorkerName		    = RivendellWorkerNoSelect
	End

	Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
		AutoAcquireEnemiesWhenIdle	= Yes
		MoodAttackCheckRate			= 250
		;AILuaEventsList				= BreelandEncampmentFunctions		
	End

	Body = ActiveBody ModuleTag_05
		MaxHealth               = GONDOR_ARCHERYRANGE_HEALTH
		MaxHealthDamaged  		  = GONDOR_ARCHERYRANGE_HEALTH_DAMAGED
		MaxHealthReallyDamaged 	= GONDOR_ARCHERYRANGE_HEALTH_REALLY_DAMAGED

		DamageCreationList 		= OCL_BuildingDamageList01 CATAPULT_ROCK

		DamageCreationList 		= OCL_GBArcheryN_Chunk1 CATAPULT_ROCK FRONT_DESTROYED
		DamageCreationList 		= OCL_GBArcheryN_Chunk2 CATAPULT_ROCK BACK_DESTROYED
		DamageCreationList 		= OCL_GBArcheryN_Chunk3 CATAPULT_ROCK RIGHT_DESTROYED
		DamageCreationList 		= OCL_GBArcheryN_Chunk4 CATAPULT_ROCK LEFT_DESTROYED
	End 
 
 ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		;SetBonusModelConditionOnSpeedBonus = Yes ; set the UPGRADE_ECONOMY_BONUS if there is any production bonus
		;BonusForType			= DunedainRangerHorde GreyCompanyRangerHorde
		;SpeedBonusAudioLoop		 = CallTheHordeOrcPitLoop; Sound to play while bonus is active
	End
  
	Behavior = QueueProductionExitUpdate QueueProductionModuleTag
		;PlacementViewAngle	    = 180
		UnitCreatePoint		      = X:-36.0 Y:0.0 Z:0.0
		NaturalRallyPoint	      = X:119.0 Y:0.0 Z:0.0
		ExitDelay			          = 300
	End
  
	Behavior = SubObjectsUpgrade ModuleTag_HideAll
		TriggeredBy		          = Upgrade_StructureLevel1
		ShowSubObjects	        = OBJECT01 OBJECT02
		HideSubObjects	        = RANK2 RANK3
	End

  	Behavior                = SubObjectsUpgrade ModuleTag_ShowWalls 
		TriggeredBy		          = Upgrade_StructureLevel2
		ShowSubObjects	        = RANK2 OBJECT01 OBJECT02
		HideSubObjects	        = RANK3
	End

	Behavior = SubObjectsUpgrade ModuleTag_ShowPillars 
		TriggeredBy		          = Upgrade_StructureLevel3
		ShowSubObjects	        = RANK2 RANK3 OBJECT01 OBJECT02
	End

	Behavior = StructureCollapseUpdate ModuleTag_06
		MinCollapseDelay        = 000
		MaxCollapseDelay        = 000
		CollapseDamping         = .5
		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
		FXList                  = INITIAL   FX_StructureMediumCollapse
		FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
		DestroyObjectWhenDone	  = Yes
		CollapseHeight			    = 130
	End

	Behavior = GeometryUpgrade Geom_ModuleTag_HideAll
		TriggeredBy		          = Upgrade_StructureLevel1
		ShowGeometry	          = Geom_Orig
		HideGeometry	          = Geom_V1 Geom_V2
	End
	Behavior = GeometryUpgrade Geom_ModuleTag_ShowWalls 
		TriggeredBy		          = Upgrade_StructureLevel2
		ShowGeometry	          = Geom_Orig
		HideGeometry	          = Geom_V2 
	End
  Behavior = GeometryUpgrade Geom_ModuleTag_ShowFlagsAndTower 
		TriggeredBy		          = Upgrade_StructureLevel3
		ShowGeometry	          = Geom_Orig
		HideGeometry	          = Geom_V1 
	End

	Behavior = BuildingBehavior BuildingModuleTag
		NightWindowName         = N_Window
	End

	; --------------------------------------------------------------------------	
	; DANCING HOBBITS
	; --------------------------------------------------------------------------	

	; Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate   
		; SpecialPowerTemplate      = SpecialAbilityDancingHobbits
		; UpdateModuleStartsAttack  = No
		; StartsPaused = No
		; AttributeModifier = RivendellDancingHobbits
		; AttributeModifierRange = 200
		; AttributeModifierAffectsSelf = Yes
		; AttributeModifierAffects = NONE
		; ;AttributeModifierFX = FX_TheodenGloriousChargeFX
	; End
    ; Behavior = ObjectCreationUpgrade ModuleTag_RemoveUpgrades1
		; TriggeredBy = Upgrade_Drafted
		; RemoveUpgrade = Upgrade_SwitchToRockThrowing
    ; End
    ; Behavior = ObjectCreationUpgrade ModuleTag_RemoveUpgrades2
		; TriggeredBy = Upgrade_SwitchToRockThrowing
		; RemoveUpgrade = Upgrade_Drafted
    ; End	
	; Behavior = SpawnBehavior ModuleTag_SpawnDancingHobbits
		; TriggeredBy			= Upgrade_Drafted
		; SpawnNumber			= 6
		; InitialBurst		= 6
		; SpawnTemplateName	= RivendellDancingHobbit_Patrol
		; SpawnReplaceDelay	= 0
		; CanReclaimOrphans	= No
	; End

	;-------------------------------------------------------------------------
	
	;Scale					        = .8	
	Geometry				      = CYLINDER
  GeometryName			    = Geom_Orig
  GeometryMajorRadius		= 65.0	
	GeometryHeight			  = 45.0
	GeometryOffset			  = X:0 Y:0 Z:0
	GeometryIsSmall       = No
	Shadow                = SHADOW_VOLUME
	BuildCompletion     	= PLACED_BY_PLAYER
	GeometryContactPoint 	= X:0	Y:-14		Z:0			Repair
	GeometryContactPoint 	= X:-4		Y:-14		Z:0			Repair
	AttackContactPoint 		= X:45.25		Y:-51.752	Z:0
	AttackContactPoint 		= X:45.25		Y:51.752	Z:0
	GeometryContactPoint 	= X:-29.241		Y:-1.937	Z:44	Swoop
  HealthBoxHeightOffset	= -20.0
End
