Object GondorRanger
	Scale = .91
    SelectPortrait         = UPGondor_Ranger
    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes    
        ParticlesAttachedToAnimatedBones = Yes
			RandomTexture = guithilhood1.tga 0 guithilhood1.tga
			RandomTexture = guithilhood2.tga 0 guithilhood1.tga
			RandomTexture = guithilhood3.tga 0 guithilhood1.tga
			RandomTexture = guithilhood4.tga 0 guithilhood1.tga			
			RandomTexture = guithilmask1.tga 0 guithilhood1.tga
			RandomTexture = guithilmask2.tga 0 guithilhood1.tga
			RandomTexture = guithilmask3.tga 0 guithilhood1.tga
			RandomTexture = guithilmask4.tga 0 guithilhood1.tga
			RandomTexture = guithilrngr1.tga 0 guithilrngr1.tga
			RandomTexture = guithilrngr2.tga 0 guithilrngr1.tga
			RandomTexture = guithilrngr3.tga 0 guithilrngr1.tga
			RandomTexture = guithilrngr4.tga 0 guithilrngr1.tga
			RandomTexture = guithiltab1.tga 0 guithiltab1.tga
			RandomTexture = guithiltab2.tga 0 guithiltab1.tga
			RandomTexture = guithiltab3.tga 0 guithiltab1.tga
			RandomTexture = guithiltab4.tga 0 guithiltab1.tga
			RandomTexture = guithiltab5.tga 0 guithiltab1.tga
			RandomTexture = guithiltab6.tga 0 guithiltab1.tga
			RandomTexture = guithiltabhood1.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabhood2.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabhood3.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabhood4.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabhood5.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabhood6.tga 0 guithiltabhood1.tga			
			RandomTexture = guithiltabmask1.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabmask2.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabmask3.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabmask4.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabmask5.tga 0 guithiltabhood1.tga
			RandomTexture = guithiltabmask6.tga 0 guithiltabhood1.tga
		DefaultModelConditionState
			Model							= guithilrngr_skn
			WeaponLaunchBone				= PRIMARY ARROW
		End
		ModelConditionState			=	WEAPONSET_PLAYER_UPGRADE
			Model							= guithilrngr_skn
			WeaponLaunchBone				= PRIMARY ARROW
			WeaponLaunchBone				= SECONDARY ARROWNOCK
		End
		ModelConditionState			=	WEAPONLOCK_SECONDARY
			Model							= guithilrngr_skn
			WeaponLaunchBone				= PRIMARY ARROW
			WeaponLaunchBone				= SECONDARY ARROWNOCK
		End
		AnimationState						= THROWN_PROJECTILE WEAPONSTATE_CLOSE_RANGE
			Animation						= FLYA
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode				= LOOP
			End
		End
		AnimationState						= THROWN_PROJECTILE
			Animation						= FLYA
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode				= LOOP
			End
		End
		AnimationState						= PASSENGER FREEFALL WEAPONSTATE_CLOSE_RANGE
			Animation						= FLLB
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode				= LOOP
			End
			StateName						= Sword
		End
		AnimationState						= PASSENGER FREEFALL
		Animation						= FLLA
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode				= LOOP
			End
			StateName						= Bow
		End
		AnimationState						= FREEFALL WEAPONSTATE_CLOSE_RANGE
			StateName						= STATE_Freefall
			Animation						= FLYB
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
				AnimationSpeedFactorRange	= 0.7	0.7
			End
		End
		AnimationState						= FREEFALL
			SimilarRestart					= Yes
			StateName						= STATE_Freefall
			Animation						= FLYA
				AnimationName				= GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
				AnimationSpeedFactorRange	= 0.65	0.65
			End
		End
		AnimationState					=	STUNNED_FLAILING 
			Animation					=	StunFlail
				AnimationName			=	GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
		AnimationState						= DYING SPLATTED WEAPONSTATE_CLOSE_RANGE
			Animation						= Splattered
				AnimationName				= GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING SPLATTED
			Animation						= Splattered
				AnimationName				= GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING WEAPONSTATE_CLOSE_RANGE DEATH_2
			Animation						= Die
				AnimationName				= GUFaramir_SKL.GUFaramir_IDLA
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING DEATH_2
			Animation						= Die
				AnimationName				= GUFaramir_SKL.GUFaramir_IDLC
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING WEAPONSTATE_CLOSE_RANGE
			Animation						= Die
				AnimationName				= GUFaramir_SKL.GUFaramir_DIEA
				AnimationMode				= ONCE
			End
		End
		AnimationState						= DYING
			Animation						= Die
				AnimationName				= GUFaramir_SKL.GUFaramir_DIEC
				AnimationMode				= ONCE
			End
		End
		AnimationState						= STUNNED_STANDING_UP WEAPONSTATE_CLOSE_RANGE
			Animation						= GTPA
				AnimationName				= GUFaramir_SKL.GUFaramir_GTPB
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 1.5 1.5
			End
		End
		AnimationState						= STUNNED_STANDING_UP 
			Animation						= GTPA
				AnimationName				= GUFaramir_SKL.GUFaramir_GTPA
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 1.5 1.5
			End
		End
		AnimationState						= STUNNED WEAPONSTATE_CLOSE_RANGE
			Animation						= Stun
				AnimationName				= GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode				= ONCE
			End
		End
		AnimationState						= STUNNED 
			Animation						= Stun
				AnimationName				= GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode				= ONCE
			End
		End
		AnimationState        =  FIRING_OR_PREATTACK_C 
			Animation           = ATKD
				AnimationName     = GUFaramir_SKL.gumithilrS_atka  
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			Animation           = ATKE
				AnimationName     =  GUFaramir_SKL.gumithilrS_atkb 
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			Animation           = ATKE
				AnimationName     =  GUFaramir_SKL.gumithilrS_atkc 
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
    		StateName           = STATE_Sword
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_SwitchToSwords") end
			EndScript
		End
		AnimationState						= PREATTACK_A 
			StateName						= STATE_Firing
			Animation						= ReadyToDrawn
				AnimationName				= GUFaramir_SKL.guithil_atka1
				AnimationMode				= ONCE
				UseWeaponTiming				= Yes
				AnimationSpeedFactorRange	= 1.5 1.5
				AnimationBlendTime			= 10			
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState						= FIRING_OR_RELOADING_A
			StateName						= STATE_Firing
			Animation						= OneFrameOfShooting
				AnimationName				= GUFaramir_SKL.guithil_atka2
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 1.0 1.0 ;1.25 1.25
				AnimationBlendTime			= 0
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState						= PREATTACK_B WEAPONLOCK_SECONDARY
			StateName						= STATE_Firing
			Animation						= ReadyToDrawn
				AnimationName				= GUFaramir_SKL.guithil_atka1
				AnimationMode				= ONCE
				UseWeaponTiming				= Yes
				AnimationSpeedFactorRange	= 1.5 1.5
				AnimationBlendTime			= 10			
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState						= FIRING_OR_RELOADING_B WEAPONLOCK_SECONDARY
			StateName						= STATE_Firing
			Animation						= OneFrameOfShooting
				AnimationName				= GUFaramir_SKL.guithil_atka2
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 1.25 1.25
				AnimationBlendTime			= 0
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState					= MOVING EMOTION_TERROR
			Animation					= Terror
				AnimationName			= GUFaramir_SKL.GUFaramir_RUNA
				AnimationMode			= LOOP
				Distance				= 26
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		
		AnimationState						= MOVING WEAPONSTATE_CLOSE_RANGE
			StateName						= STATE_Sword
			Animation						= RunWithSword
				AnimationName				= GUFaramir_SKL.GUFaramir_RUNB
				AnimationMode				= LOOP
				Distance					= 28
			End
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
			EndScript
		End
		AnimationState						= MOVING
			StateName						= STATE_Bow
			Animation						= RunWithSword
				AnimationName				= GUFaramir_SKL.GUFaramir_RUNA
				AnimationMode				= LOOP
				Distance					= 28
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End
		AnimationState					=	CONTINUOUS_FIRE_MEAN
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUFaramir_SKL.guithil_atka2
				AnimationMode			=	MANUAL
				UseWeaponTiming			= Yes	
				AnimationBlendTime			= 10
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState                        = CONTINUOUS_FIRE_SLOW
            Animation                        = PutAwayArrow
                AnimationName                = GUFaramir_SKL.guithil_atka3
                AnimationMode                = ONCE
            End
        End
		AnimationState						= HIT_REACTION
			Animation						= Hit_Level_1_a
				AnimationName				= GUFaramir_SKL.GUFaramir_HITC
				AnimationMode				= ONCE
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState						= EMOTION_AFRAID WEAPONSTATE_CLOSE_RANGE
			ShareAnimation					= Yes
			StateName						= STATE_Sword
			Animation						= FearWithSword
				AnimationName				= GUFaramir_SKL.gufaramir_fear
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
			EndScript
		End
		AnimationState						= EMOTION_AFRAID
			ShareAnimation					= Yes
			StateName						= STATE_Bow
			Animation						= FERA
				AnimationName				= GUFaramir_SKL.gufaramir_fear
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState				= LEVELED WEAPONSET_TOGGLE_1	
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRC
				AnimationMode		= ONCE
			End
		End
		AnimationState				= LEVELED 						
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode		= ONCE
			End
		End
	AnimationState				=	EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
				Animation           =	CHRC
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRc
					AnimationMode   =	ONCE
					AnimationPriority	=	10
				End
				Animation           =	CHRD
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRD
					AnimationMode   =	ONCE
					AnimationPriority	=	5
				End
				Flags				=	RESTART_ANIM_WHEN_COMPLETE		
			End
		AnimationState				=	EMOTION_CELEBRATING
				Animation           =	CHRD
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRD
					AnimationMode   =	LOOP
				End
			End
		AnimationState				=	EMOTION_ALERT WEAPONSET_TOGGLE_1
			StateName				=	STATE_READY
			Animation				=	ready
				AnimationName		=	GUFaramir_SKL.guctdlgrd_idla
				AnimationMode		=	LOOP
				AnimationBlendTime	=	20
			End
		End
		AnimationState				=	SELECTED 
			StateName				=	STATE_Selected_Bow
			Animation				=	ATNB
				AnimationName		=	GUFaramir_SKL.GUFaramir_ATNB
				AnimationMode		=	LOOP
				AnimationBlendTime  = 15
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_Idle_Bow"	then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
				if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
			EndScript
		End		
		AnimationState						= SELECTED
			StateName						= STATE_Selected
			Animation						= Selected
				AnimationName				= GUFaramir_SKL.GUFaramir_ATNB
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow_Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
			EndScript
		End
		IdleAnimationState
			StateName						= STATE_Bow_Idle
			Animation						= IdleBowC
				AnimationName				= GUFaramir_SKL.GUFaramir_IDLC
				AnimationMode				= ONCE
				AnimationPriority			= 6
			End
			Flags							= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_AttentionToIdle") end
			EndScript
		End
		TransitionState = TRANS_IdleToAttentionSword
			Animation = ANTD
				AnimationName		= GUFaramir_SKL.GUFaramir_ANTD
				AnimationMode		= ONCE
				AnimationSpeedFactorRange	= 0.6 0.6
			End		
		End
		TransitionState = TRANS_AttentionToIdleSword
			Animation			= ATNF
				AnimationName	= GUFaramir_SKL.GUFaramir_ATNF
				AnimationMode	= ONCE
				AnimationSpeedFactorRange	= 0.6 0.6
			End		
		End	
		TransitionState = TRANS_IdleToAttentionBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.GUFaramir_ATNC
				AnimationMode		= ONCE
				AnimationSpeedFactorRange	= 0.6 0.6
			End		
		End
		TransitionState = TRANS_CaptainBowToAttentionBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.GUFaramir_ATNC
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationSpeedFactorRange = 0.9 0.9
			End		
		End
		TransitionState = TRANS_AttentionToIdleBow
			Animation			= ATNA
				AnimationName	= GUFaramir_SKL.GUFaramir_ATND
				AnimationMode	= ONCE
				AnimationSpeedFactorRange	= 0.9 0.9
			End		
		End	
		TransitionState       = TRANS_BowToSword
			Animation           = GUFaramir_STHA
				AnimationName     = GUFaramir_SKL.GUFaramir_STHA 
				AnimationMode     = ONCE
			End
		End
		TransitionState       = TRANS_SwordToBow
			Animation           = GUFaramir_STHB
				AnimationName     = GUFaramir_SKL.GUFaramir_STHB 
				AnimationMode     = ONCE
			End
		End	
		TransitionState       		= TRANS_BowToSword_Running
			Animation           	= DrawSwords
				AnimationName       = GUFaramir_SKL.GUFaramir_STHD
				AnimationMode       = ONCE
			End
		End
		TransitionState       		= TRANS_SwordToBow_Running
			Animation           	= DrawBow
				AnimationName       = GUFaramir_SKL.GUFaramir_STHC
				AnimationMode       = ONCE
			End
		End
	End
    Side = Gondor
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 4
    BountyValue = M_GONDOR_RANGER_BOUNTY_VALUE
    TransportSlotCount = 1
	WeaponSet
        Conditions = CLOSE_RANGE CONTESTING_BUILDING
        Weapon = PRIMARY    GondorRangerBow
		Weapon = TERTIARY   GondorRangerSword
        OnlyAgainst = PRIMARY STRUCTURE
    End
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    GondorRangerBow
        Weapon = SECONDARY   GondorRangerBowPower
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = SECONDARY NONE
	End
	WeaponSet
		Conditions = PLAYER_UPGRADE
		Weapon = PRIMARY    GondorRangerBow
        Weapon = SECONDARY   GondorRangerBowPower
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = SECONDARY NONE
	End
    ArmorSet
        Conditions      = None
        Armor           = RangerArmor
        DamageFX        = NormalDamageFX
    End
    VisionRange = M_VISION_STANDARD_MELEE
    ShroudClearingRange = M_SHROUD_CLEAR_STANDARD
    DisplayName = OBJECT:GondorRanger
    CrushableLevel = 0
    CrushRevengeWeapon = RangedInfantryCrushRevenge
    CommandSet = GondorRangerCommandSet
    VoiceAttack                    = RangerVoiceAttack
    VoiceAttackAir                = RangerVoiceAttack                
    VoiceAttackCharge                = RangerVoiceAttack
    VoiceAttackMachine            = RangerVoiceAttack
    VoiceAttackStructure            = RangerVoiceAttackBuilding
    VoiceEnterStateAttack            = RangerVoiceEnterStateAttack    
    VoiceEnterStateAttackCharge        = RangerVoiceEnterStateAttack
    VoiceEnterStateAttackMachine        = RangerVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackStructure    = RangerVoiceEnterStateAttackBuilding
    VoiceCreated                = RangerVoiceSalute
    VoiceFullyCreated             = RangerVoiceSalute        
    VoiceGuard                    = RangerVoiceMove
    VoiceMove                    = RangerVoiceMove        
    VoiceMoveToCamp                = RangerVoiceMoveCamp
    VoiceMoveWhileAttacking            = RangerVoiceDisengage
    VoiceEnterStateMove            = RangerVoiceEnterStateMove
    VoiceEnterStateMoveToCamp        = RangerVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking    = RangerVoiceEnterStateDisengage
    VoicePriority                = 43
    VoiceRetreatToCastle            = RangerVoiceRetreat
    VoiceEnterStateRetreatToCastle    = RangerVoiceEnterStateRetreat
    VoiceSelect                    = RangerVoiceSelect
    VoiceSelect2                = YeomanArcherVoiceSelect2
    VoiceSelectBattle             = RangerVoiceSelectBattle
    SoundImpact                    = ImpactHorse
    UnitSpecificSounds
        VoiceGarrison            = RangerVoiceGarrison              
    End
    EvaEventDamagedOwner = UnitUnderAttack
    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Human Unit Infantry Ranger
    End
    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:ArrowDrawBow                    Animation:GURanger_SKL.GURanger_ATKD1    Frames:7
        AnimationSound = Sound:ArrowDrawBow                    Animation:GURanger_SKL.GURanger_ATKD2    Frames:17
        AnimationSound = Sound:SwordShingClean1ForHordes         Animation:GURanger_SKL.GURanger_STHA     Frames:10
        AnimationSound = Sound:SwordIntoScabbard1ForHordes        Animation:GURanger_SKL.GURanger_STHB     Frames:6
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_LNDA    Frames:4
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_LNDB    Frames:5
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_DIEA    Frames:50
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_DIEB    Frames:51
    End
    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP ATTACK_NEEDS_LINE_OF_SIGHT ARCHER
    Body = ActiveBody ModuleTag_02
        CheerRadius       = M_EMOTION_CHEER_RADIUS
        MaxHealth         = M_GONDOR_RANGER_HEALTH
        MaxHealthDamaged  = M_GONDOR_RANGER_HEALTH_DAMAGED
    End
    Behavior = SpecialPowerModule ModuleTag_FireArrowUser_1
		SpecialPowerTemplate      = SpecialAbilityRank2
		UpdateModuleStartsAttack  = No
		AttributeModifier = FireArrowsUSER_1
		AttributeModifierAffectsSelf = Yes
		AttributeModifierAffects = NONE +GondorRanger +GondorRangerHorde +GondorRangerHordeAmbushFormation
		AttributeModifierFX = None
	End
	Behavior = WeaponModeSpecialPowerUpdate ModuleTag_SwitchToWeaponset1
		SpecialPowerTemplate	= SpecialAbilityRank2
		Duration				= 30000
		LockWeaponSlot			= SECONDARY
		StartsPaused			= No
	End	
    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        StopChaseDistance = 562
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 40
        CanAttackWhileContained    = Yes
        AILuaEventsList                =	IthilienRangerFunctions
        MinCowerTime                =    4000
        MaxCowerTime                =    6000
        AttackPriority                =     AttackPriority_Archer
    End
    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 1667
        HitReactionLifeTimer2 = 1667
        HitReactionLifeTimer3 = 1667
        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
        FastHitsResetReaction = Yes
    End
    Behavior = StealthUpdate StealthUpdateModuleTag
        StealthDelay                        = 2500
        FriendlyOpacityMin                    = M_STEALTH_FRIENDLY_OPACITY_MIN
        FriendlyOpacityMax                    = M_STEALTH_FRIENDLY_OPACITY_MAX
        PulseFrequency                        = 750
        StealthForbiddenConditions            = HORDEBRAIN_NOT_STEALTHED
        OrderIdleEnemiesToAttackMeUponReveal= Yes
        DetectedByAnyoneRange                = 120
        RevealWeaponSets                    = CLOSE_RANGE CONTESTING_BUILDING
        VoiceMoveToStealthyArea                = RangerVoiceMoveTrees
        VoiceEnterStateMoveToStealthyArea    = RangerVoiceEnterStateMoveTrees
    End
    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL 
        Speed     = 50
    End
    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = 50
    End
    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = 24
    End
	Behavior = WeaponSetUpgrade ModuleTag_ImprovedArrowsmithing
		TriggeredBy = Upgrade_ImprovedArrowsmithing
	End	   
    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End
    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 15000
        Sound = INITIAL HumanVoiceDie
    End
    Behavior = SquishCollide ModuleTag_06
    End
    Behavior = HordeMemberCollide ModuleTag_HMC
    End
    Behavior = SlowDeathBehavior ModuleTag_07
        DeathTypes = NONE +KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 15000
    End
	    
    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 8000
        DestructionDelay = 8000
        DeathFlags = DEATH_2
        FX = INITIAL FX_RohirrimAlliesUnsummon
    End
    Behavior = BezierProjectileBehavior ModuleTag_08
        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes
        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%
        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End
    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End
;; ----------------------------------------------------------------------------------------------
Object SummonGondorRangerEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE
    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay = 2000
        OCL = FINAL OCL_SpawnGondorRanger
    End
End
;; ----------------------------------------------------------------------------------------------
ChildObject GondorRanger_Summoned GondorRanger
    IsTrainable = No
    CommandPoints = 0
    EquivalentTo = GondorRanger
    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
    ; This one does the work, but the one in the horde displays the timer
        MinLifetime        = 75000 ; 180000
        MaxLifetime        = 75000 ; 180000
        DeathType        = FADED
    End
End
;; ----------------------------------------------------------------------------------------------
Object GondorRangerNoStealth
    SelectPortrait         = UPGondor_Ranger
    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes    
        StaticModelLODMode = Yes
        LodOptions    = LOW
            AllowMultipleModels        =    M_ALLOW_MULTIPLE_MODELS_LOW
            MaxRandomTextures        =    M_MAX_RANDOM_TEXTURES_LOW
            MaxRandomAnimations        =    M_MAX_RANDOM_ANIMATIONS_LOW
            MaxAnimFrameDelta        =    M_MAX_ANIM_FRAME_DELTA_LOW
        End
        LodOptions    = MEDIUM
            AllowMultipleModels        =    M_ALLOW_MULTIPLE_MODELS_MED
            MaxRandomTextures        =    M_MAX_RANDOM_TEXTURES_MED
            MaxRandomAnimations        =    M_MAX_RANDOM_ANIMATIONS_MED
            MaxAnimFrameDelta        =    M_MAX_ANIM_FRAME_DELTA_MED
        End
        LodOptions    = HIGH
            AllowMultipleModels        =    M_ALLOW_MULTIPLE_MODELS_HIGH
            MaxRandomTextures        =    M_MAX_RANDOM_TEXTURES_HIGH
            MaxRandomAnimations        =    M_MAX_RANDOM_ANIMATIONS_HIGH
            MaxAnimFrameDelta        =    M_MAX_ANIM_FRAME_DELTA_HIGH
        End
        DefaultModelConditionState
            Model                            = GURanger_SKNM
            WeaponLaunchBone                = PRIMARY ARROW
        End
        ModelConditionState                WEAPONSET_PLAYER_UPGRADE
            Model                            = GURanger_SKNM
            WeaponLaunchBone                = PRIMARY ARROW
            WeaponLaunchBone                = SECONDARY ARROWNOCK
            ParticleSysBone                    = FireArowTip arrowFire FollowBone:Yes
            ParticleSysBone                    = FireArowTip arrowFire FollowBone:Yes
        End
        ModelConditionState                WEAPONSET_TOGGLE_1
            Model                            = GURanger_SKNM
        End
        AnimationState                        = STUNNED_STANDING_UP 
            Animation                        = GTPA
                AnimationName                = GURanger_SKL.GURanger_GTPA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.7 1.1
            End
        End
        AnimationState                        = PASSENGER
            Animation                        = FLLA
                AnimationName                = GURanger_SKL.GURanger_FLLA
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
            StateName                        = Bow
        End
        AnimationState                        = THROWN_PROJECTILE
            Animation                        = FLYA
                AnimationName                = GURanger_SKL.GURanger_FLYA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = DYING SPLATTED
            Animation                        = Splattered
                AnimationName                = GURanger_SKL.GURanger_LNDA
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = STUNNED 
            Animation                        = Stun
                AnimationName                = GURanger_SKL.GURanger_LNDA
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = DYING
            Animation                        = Die
                AnimationName                = GURanger_SKL.GURanger_DIEA
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = MOVING WEAPONSET_TOGGLE_1
            StateName                        = STATE_Run_Sword
            Animation                        = RunWithSword
                AnimationName                = GURanger_SKL.GURanger_RUNB
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
            EndScript
        End
        AnimationState                        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName                        = STATE_Idle_Sword
            Animation                        = AttackWithSwordA
                AnimationName                = GURanger_SKL.GURanger_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = AttackWithSwordB
                AnimationName                = GURanger_SKL.GURanger_ATKB
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
            EndScript
        End
        AnimationState                        = DYING WEAPONSET_TOGGLE_1
            StateName                        = STATE_Dead_Sword
            Animation                        = DieWithSword
                AnimationName                = GURanger_SKL.GURanger_DIEB
                AnimationMode                = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
            EndScript
        End
        AnimationState                        = MOVING BACKING_UP WEAPONSET_PLAYER_UPGRADE
            StateName                        = STATE_Run_Bow
            ShareAnimation                    = Yes
            Animation                        = BackingUp
                AnimationName                = GURanger_SKL.GURanger_RUNC
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End
        AnimationState                        = MOVING DAMAGED WEAPONSET_PLAYER_UPGRADE
            StateName                        = STATE_Damaged_Walk_Bow
            ShareAnimation                    = Yes
            Animation                        = InjuredWalk
                AnimationName                = GURanger_SKL.GURanger_IWKA
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End
        AnimationState                        = MOVING PANICKING WEAPONSET_PLAYER_UPGRADE
            StateName                        = STATE_Run_Bow
            ShareAnimation                    = Yes
            Animation                        = RUNM
                AnimationName                = GURanger_SKL.GURanger_MFDA
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End
        AnimationState                        = MOVING WEAPONSET_PLAYER_UPGRADE
            StateName                        = STATE_Run_Bow
            ShareAnimation                    = Yes
            Animation                        = Run
                AnimationName                = GURanger_SKL.GURanger_RUNA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = .7 .7
            End
            Flags                            = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End
        AnimationState                        = MOVING BACKING_UP
            StateName                        = STATE_Run_Bow
            ShareAnimation                    = Yes
            Animation                        = BackingUp
                AnimationName                = GURanger_SKL.GURanger_RUNC
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART  
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End
        AnimationState                        = MOVING PANICKING
            StateName                        = STATE_Run_Bow
            ShareAnimation                    = Yes
            Animation                        = RUNM
                AnimationName                = GURanger_SKL.GURanger_MFDA
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End
        AnimationState                        = MOVING
            StateName                        = STATE_Run_Bow
            ShareAnimation                    = Yes
            Animation                        = Run
                AnimationName                = GURanger_SKL.GURanger_RUNA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = .7 .7
            End
            Flags                            = RANDOMSTART
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End
        AnimationState                        = PREATTACK_A 
            StateName                        = STATE_Firing
            Animation                        = ReadyToDrawn
                AnimationName                = GURanger_SKL.GURanger_ATKD1
                AnimationMode                = ONCE
                AnimationBlendTime            = 0
            End
        End
        AnimationState                        = FIRING_A
            StateName                        = STATE_Firing
            Animation                        = OneFrameOfShooting
                AnimationName                = GURanger_SKL.GURanger_ATKD2
                AnimationMode                = MANUAL
            End
        End
        AnimationState                        = RELOADING_A 
            StateName                        = STATE_Firing
            Animation                        = LooseReloadDraw
                AnimationName                = GURanger_SKL.GURanger_ATKD2
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = CONTINUOUS_FIRE_MEAN
            StateName                        = STATE_Firing
            Animation                        = HangFrameWhileCoasting
                AnimationName                = GURanger_SKL.GURanger_ATKD2
                AnimationMode                = MANUAL
            End
        End
        AnimationState                        = CONTINUOUS_FIRE_SLOW
            StateName                        = STATE_Idle_Bow
            Animation                        = PutAwayArrow
                AnimationName                = GURanger_SKL.GURanger_ATKD3
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = HIT_REACTION
            Animation                        = Hit_Level_1_a
                AnimationName                = GURanger_SKL.GURanger_HITA
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = EMOTION_AFRAID WEAPONSET_TOGGLE_1
            ShareAnimation                    = Yes
            Animation                        = &&FEAR WITH SWORD&&
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_AFRAID
            ShareAnimation                    = Yes
            StateName                        = STATE_Afraid
            Animation                        = FERA
                AnimationName                = GURanger_SKL.GURanger_FERA
                AnimationMode                = LOOP
            End
            Animation                        = FERB
                AnimationName                = GURanger_SKL.GURanger_FERB
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            Animation                        = &&TAUNT WITH SWORD&&
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_TAUNTING
            ShareAnimation                    = Yes
            Animation                        = Taunting
                AnimationName                = GURanger_SKL.GURanger_TNTA
                AnimationMode                = ONCE
            End
            Animation                        = Taunting2
                AnimationName                = GURanger_SKL.GURanger_TNTB
                AnimationMode                = ONCE
            End
            Flags                            = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                        = EMOTION_POINTING WEAPONSET_TOGGLE_1
            Animation                        = &&POINT WITH SWORD&&
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_POINTING
            Animation                        = Pointing1
                AnimationName                = GURanger_SKL.GURanger_PNTA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            Animation                        = &&CHEER WITH SWORD&&
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_CELEBRATING
            ShareAnimation                    = Yes
            Animation                        = CHRA
                AnimationName                = GURanger_SKL.GURanger_CHRA
                AnimationMode                = Once
            End
            Animation                        = CHRB
                AnimationName                = GURanger_SKL.GURanger_CHRB
                AnimationMode                = Once
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                        = EMOTION_ALERT
            Animation                        = IdleBowA
                AnimationName                = GURanger_SKL.GURanger_IDLA 
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = SELECTED WEAPONSET_TOGGLE_1
            StateName                        = STATE_Idle_Sword
            Animation                        = SwordIdle
                AnimationName                = GURanger_SKL.GURanger_IDLB
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = SELECTED
            StateName                        = STATE_Idle_Bow
            Animation                        = selected
                AnimationName                = GURanger_SKL.GURanger_IDLA 
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = WEAPONSET_TOGGLE_1
            StateName                        = STATE_Idle_Sword
            Animation                        = SwordIdle
                AnimationName                = GURanger_SKL.GURanger_IDLB
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
            EndScript
        End
        AnimationState                        = WEAPONSET_PLAYER_UPGRADE
            StateName                        = STATE_Idle_Bow
            Animation                        = IdleBow
                AnimationName                = GURanger_SKL.GURanger_IDLA 
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End
        IdleAnimationState
            StateName                        = STATE_Idle_Bow
            Animation                        = IdleBowG
                AnimationName                = GURanger_SKL.GURanger_IDLG
                AnimationMode                = ONCE
            End
            Animation                        = IdleBowF
                AnimationName                = GURanger_SKL.GURanger_IDLF 
                AnimationMode                = ONCE
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end    
            EndScript
        End
        TransitionState                        = TRANS_Bow_To_Sword
            Animation                        = DrawSwords
                AnimationName                = GURanger_SKL.GURanger_STHA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.9 1.1
            End
        End
        TransitionState                        = TRANS_Sword_To_Bow
            Animation                        = DrawBow
                AnimationName                = GURanger_SKL.GURanger_STHB
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.9 1.1
            End
        End
    End
    Side = Gondor
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 1
    BountyValue = M_GONDOR_RANGER_BOUNTY_VALUE
    TransportSlotCount = 1
    WeaponSet
        Conditions = None 
        Weapon = PRIMARY    GondorRangerBow
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    GondorRangerSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    ArmorSet
        Conditions      = None
        Armor           = ArcherArmor
        DamageFX        = NormalDamageFX
    End
    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = HeavyArmor
        DamageFX        = NormalDamageFX
    End
    VisionRange = M_VISION_STANDARD_MELEE
    ShroudClearingRange = M_SHROUD_CLEAR_STANDARD
    DisplayName = OBJECT:GondorRanger
    CrushableLevel = 0
    CrushRevengeWeapon = RangedInfantryCrushRevenge
    CommandSet = GondorRangerCommandSet
    VoiceAttack                    = RangerVoiceAttack
    VoiceAttackAir                = RangerVoiceAttack                
    VoiceAttackCharge                = RangerVoiceAttack
    VoiceAttackMachine            = RangerVoiceAttack
    VoiceAttackStructure            = RangerVoiceAttackBuilding
    VoiceEnterStateAttack            = RangerVoiceEnterStateAttack    
    VoiceEnterStateAttackCharge        = RangerVoiceEnterStateAttack
    VoiceEnterStateAttackMachine        = RangerVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackStructure    = RangerVoiceEnterStateAttackBuilding
    VoiceCreated                = RangerVoiceSalute
    VoiceFullyCreated             = RangerVoiceSalute        
    VoiceGuard                    = RangerVoiceMove
    VoiceMove                    = RangerVoiceMove        
    VoiceMoveToCamp                = RangerVoiceMoveCamp
    VoiceMoveWhileAttacking            = RangerVoiceDisengage
    VoiceEnterStateMove            = RangerVoiceEnterStateMove
    VoiceEnterStateMoveToCamp        = RangerVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking    = RangerVoiceEnterStateDisengage
    VoicePriority                = 43
    VoiceRetreatToCastle            = RangerVoiceRetreat
    VoiceEnterStateRetreatToCastle    = RangerVoiceEnterStateRetreat
    VoiceSelect                    = RangerVoiceSelect
    VoiceSelect2                = YeomanArcherVoiceSelect2
    VoiceSelectBattle             = RangerVoiceSelectBattle
    SoundImpact                    = ImpactHorse
    UnitSpecificSounds
        VoiceGarrison            = RangerVoiceGarrison              
    End
    EvaEventDamagedOwner = UnitUnderAttack
    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Human Unit Infantry Ranger
    End
    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:ArrowDrawBow                    Animation:GURanger_SKL.GURanger_ATKD1    Frames:7
        AnimationSound = Sound:ArrowDrawBow                    Animation:GURanger_SKL.GURanger_ATKD2    Frames:17
        AnimationSound = Sound:SwordShingClean1ForHordes         Animation:GURanger_SKL.GURanger_STHA     Frames:10
        AnimationSound = Sound:SwordIntoScabbard1ForHordes        Animation:GURanger_SKL.GURanger_STHB     Frames:6
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_LNDA    Frames:4
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_LNDB    Frames:5
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_DIEA    Frames:50
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_DIEB    Frames:51
    End
    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP
    Body = ActiveBody ModuleTag_02
        MaxHealth         = M_GONDOR_RANGER_HEALTH
        MaxHealthDamaged  = M_GONDOR_RANGER_HEALTH_DAMAGED
    End
	Behavior = WeaponSetUpgrade ModuleTag_ImprovedArrowsmithing
		TriggeredBy = Upgrade_ImprovedArrowsmithing
	End	  
    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        StopChaseDistance = 562
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 40
        CanAttackWhileContained    = Yes
        AILuaEventsList                =    RangerFunctions
        MinCowerTime                =    4000
        MaxCowerTime                =    6000
        AttackPriority                =     AttackPriority_Archer
    End
    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL 
        Speed     = M_NORMAL_GOOD_INFANTRY_MEMBER_SPEED    
    End
    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = M_NORMAL_GOOD_INFANTRY_MEMBER_SPEED    
    End
    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = 24
    End
    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End
    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 15000
        Sound = INITIAL HumanVoiceDie
    End
    Behavior = SquishCollide ModuleTag_06
    End
    Behavior = SlowDeathBehavior ModuleTag_07
        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 15000
    End
    Behavior = BezierProjectileBehavior ModuleTag_08
        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes
        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%
        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End
    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End
