;------------------------------------------------------------------------------
;
;    Faramir.ini
;
;------------------------------------------------------------------------------

; Faramir
Object ElvenHaldirSaF
    ; *** ART Parameters ***

    ; SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
    SelectPortrait = HPHaldir
    
    ; ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
    ButtonImage = HIHaldir
    
    Draw = W3DScriptedModelDraw ModuleTag_DRAW1
    OkToChangeModelColor = Yes
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

    ExtraPublicBone = arrow
    ExtraPublicBone = PASSENGERBONE
        
     DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP

;;====================== MODELS ================================================================
        DefaultModelConditionState
            Model               = euhaldir_skn
            WeaponLaunchBone    = PRIMARY arrow
        End
        ModelConditionState        = ARMORSET_PLAYER_UPGRADE
            Model               = euhaldir_ha
            WeaponLaunchBone    = PRIMARY arrow
        End


;;================== ANIMATIONS =================================================================
;;------------------  DYING -------------------------------------------------------------

; --- Flying through the air.
        AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_FLYB
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End
        
        AnimationState        = STUNNED_FLAILING 
            StateName           = STATE_Bow
            Animation           = GUFaramir_FLYA
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End
        
; --- Dying anims
        AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End

        AnimationState        = DYING SPLATTED
            StateName           = STATE_Bow
            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End
        
        ; with sword
        AnimationState        = DYING WEAPONSET_TOGGLE_1    ;WEAPONSTATE_CLOSE_RANGE
            StateName           = STATE_Sword

            Animation           = GUFaramir_DIEA
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
                AnimationMode     = ONCE
            End
            
            Animation           = GUFaramir_DIEB
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End
        
        ; with bow
        AnimationState        = DYING
            StateName           = STATE_Bow
            Animation           = GUFaramir_DIEC
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEC
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End


; --- Stunned anims


        AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_GTPB
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End
        
        AnimationState        = STUNNED_STANDING_UP
            StateName           = STATE_Bow
            Animation           = GUFaramir_GTPA
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End

        AnimationState        = STUNNED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            
            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End

        AnimationState        = STUNNED 
            StateName           = STATE_Bow
            
            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End                

;;----------- pose         
        AnimationState        = USER_1
        ;*****************************************************************
            ;ParticleSysBone     = B_SWORDBONE AndruilEfxParent FollowBone:yes
        ;*****************************************************************
            Animation           = GUFaramir_POSA
                AnimationName     = GUFaramir_SKL.GUFaramir_POSA
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End

        ;--------------------- Wound Arrow anim
        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = STATE_Bow
            Animation
                AnimationName           = GUFaramir_SKL.GUFaramir_ATKC
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 59
            BeginScript
                CurDrawableShowSubObject("arrow")
            EndScript
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End
        
;;------------------ ATTACKING --------------------------------------------------------------------
        ; Attacking Anims [Weapon_A]
        
        
        
        AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
            Animation           = TrotAndFire
                AnimationName       = GUFaramir_SKL.GUFaramir_ATRA
                AnimationMode       = LOOP
            End
            ParticleSysBone                = None InfantryDustTrails
            Flags               = RANDOMSTART
            StateName = RunAndSwing
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End
        
        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            
            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            
            Animation           = ATKE
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKE
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            
            Animation           = ATKF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKF
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.2 1.2
            End
            ParticleSysBone                = None MeleeDust
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            ;    FrameForPristineBonePositions = 59
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
            EndScript
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End

;;------------------ MOVING -------------------------------------------------------------

        AnimationState        = MOVING USER_4                 ; Moving slaughter
            StateName           = Slaughter
            Flags               = RANDOMSTART
            ;ParticleSysBone     = None InfantryDustTrails
            Animation           = GUFaramir_ATKE
                AnimationName     = GUFaramir_SKL.GUFaramir_ATKE
                AnimationMode     = LOOP
            End
            StateName           = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
            EndScript
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End

        ;--- Running with sword
        AnimationState            = MOVING WEAPONSET_TOGGLE_1        ;WEAPONSTATE_CLOSE_RANGE
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART
            ;ParticleSysBone    = None InfantryDustTrails
            
            Animation           = GUFaramir_RUNB
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNB
;                AnimationMode   = LOOP
                AnimationSpeedFactorRange = 0.85 0.85
                Distance        = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
            EndScript
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End

        ;--- Running with bow
        AnimationState            = MOVING
            StateName           = STATE_RunningBow
            Flags               = RANDOMSTART
            ;ParticleSysBone    = None InfantryDustTrails
            
            Animation           = GUFaramir_RUNA
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNA
;                AnimationMode   = LOOP
                AnimationSpeedFactorRange = 0.85 0.85
                Distance = 28
            End
            ParticleSysBone                = None InfantryDustTrails
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
            EndScript
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End

        ;---------------------------------------------------
        ;New style firing with bow
        AnimationState                    =    PREATTACK_A 
            StateName                    =    STATE_Firing
            Animation                    =    ReadyToDrawn
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA1
                AnimationMode            =    ONCE
;                UseWeaponTiming            =    Yes            ; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
                ;AnimationBlendTime        =    10
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End

        AnimationState                    =    FIRING_OR_RELOADING_A 
            StateName                    =    STATE_Firing
            Animation                    =    LooseReloadDraw
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    ONCE
;                UseWeaponTiming            =    Yes            ; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
                AnimationSpeedFactorRange = 1.1 1.1        ; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
                ;AnimationBlendTime        =    10
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End
        ;---------------------End New style firing

        AnimationState                    =    CONTINUOUS_FIRE_MEAN
            Animation                    =    HangFrameWhileCoasting
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    MANUAL
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End
        
        AnimationState                        = CONTINUOUS_FIRE_SLOW
            ;StateName                        = STATE_Idle_Bow
            Animation                        = PutAwayArrow
                AnimationName                = GUFaramir_SKL.GUFaramir_ATKA3
                AnimationMode                = ONCE
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End
                
        ;End New style firing
        ;---------------------------------------------------


        
;;-------------------- HIT REACTIONS -----------------------------------------------------------

; this hit animation attack stance
        AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_d
                AnimationName = GUFaramir_SKL.GUFaramir_HITD
                AnimationMode = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End

        AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_b
                AnimationName = GUFaramir_SKL.GUFaramir_HITB
                AnimationMode = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End

        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_c
                AnimationName = GUFaramir_SKL.GUFaramir_HITC
                AnimationMode = ONCE
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End

;;------------ EMOTIONS ------------------------------------------------------------------        


;;====== LEVELED
        AnimationState                = LEVELED WEAPONSET_TOGGLE_1    ; This state clears itself in 3 seconds
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode        = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End

        AnimationState                = LEVELED                         ; This state clears itself in 3 seconds
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        = ONCE
            End
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End

;;------------------- SELECTED STATES ------------------------------------------------------------

        AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_ATKD
                AnimationMode     = MANUAL
            End   
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript            
        End

;;------------------- SELECTED STATES ------------------------------------------------------------

        AnimationState                    = SELECTED WEAPONSET_TOGGLE_1
            StateName                    = STATE_Selected_Sword
            
            Animation                    = ATNE
                AnimationName            = GUFaramir_SKL.GUFaramir_ATNE
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
            EndScript
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End
        
;;====== ALERT
        AnimationState                =    EMOTION_ALERT WEAPONSET_TOGGLE_1
            StateName                =    STATE_READY
            Animation                =    ready
                AnimationName        =    GUFaramir_SKL.GUFaramir_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End
        
        AnimationState                =    SELECTED 
            StateName                =    STATE_Selected_Bow
            
            Animation                =    ATNB
                AnimationName        =    GUFaramir_SKL.GUFaramir_ATNB
                AnimationMode        =    LOOP
                AnimationBlendTime  = 15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Idle_Bow"    then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
                if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
            EndScript
            BeginScript
                CurDrawableShowSubObject("SHEATH")
                CurDrawableHideSubObject("SHEATH01")
                CurDrawableHideSubObject("SWORD")
            EndScript
        End
    


;;--------------- IDLE STATES -----------------------------------------------------------------    
        
        AnimationState                    = WEAPONSET_TOGGLE_1
            StateName                    = STATE_Idle_Sword    

            Animation                   = IDLE
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLE
                AnimationMode           = LOOP
                AnimationPriority        = 20
                AnimationBlendTime  = 15
            End
            
            Animation                   = IDLF
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLF
                AnimationMode           = LOOP
                AnimationPriority        = 1
            End

            Animation                   = IDLG
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLG
                AnimationMode           = LOOP
                AnimationPriority        = 1
            End
            
            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
            EndScript
            BeginScript
                CurDrawableHideSubObject("SHEATH")
                CurDrawableShowSubObject("SHEATH01")
                CurDrawableShowSubObject("SWORD")
            EndScript
        End
        
        IdleAnimationState
            StateName           = STATE_Idle_Bow
            Animation           = IdleBow
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLC
                AnimationMode     = ONCE
                AnimationBlendTime  = 15
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredBow") end
            EndScript
        End
        TransitionState = TRANS_BoredToSelectedSword
            Animation = ANTD
                AnimationName        = GUFaramir_SKL.GUFaramir_ANTD
                AnimationMode        = ONCE
            End        
        End
        TransitionState = TRANS_SelectedToBoredSword
            Animation            = ATNF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATNF
                AnimationMode    = ONCE
            End        
        End    
        TransitionState = TRANS_BoredToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
            End        
        End
        TransitionState = TRANS_CaptainBowToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
                AnimationBlendTime    = 10
                AnimationSpeedFactorRange = 1.5 1.5
            End        
        End
        TransitionState = TRANS_SelectedToBoredBow
            Animation            = ATNA
                AnimationName    = GUFaramir_SKL.GUFaramir_ATND
                AnimationMode    = ONCE
            End        
        End    
        TransitionState       = TRANS_BowToSword
            Animation           = GUFaramir_STHA
                AnimationName     = GUFaramir_SKL.GUFaramir_STHA 
                AnimationMode     = ONCE
            End
        End
        TransitionState       = TRANS_SwordToBow
            Animation           = GUFaramir_STHB
                AnimationName     = GUFaramir_SKL.GUFaramir_STHB 
                AnimationMode     = ONCE
            End
        End    
        TransitionState               = TRANS_BowToSword_Running
            Animation               = DrawSwords
                AnimationName       = GUFaramir_SKL.GUFaramir_STHD
                AnimationMode       = ONCE
            End
        End
        TransitionState               = TRANS_SwordToBow_Running
            Animation               = DrawBow
                AnimationName       = GUFaramir_SKL.GUFaramir_STHC
                AnimationMode       = ONCE
            End
        End  

    End

    ; ***DESIGN parameters ***
    Side = Rohan
    EditorSorting = UNIT
    ThreatLevel = 4.0
    ThingClass = CHARACTER_UNIT
    BuildCost = M_FARAMIR_BUILDCOST                
    BuildTime = M_FARAMIR_BUILDTIME                
    TransportSlotCount = 1

    DisplayMeleeDamage = M_FARAMIR_DAMAGE
    DisplayRangedDamage = M_FARAMIR_BOW_DAMAGE

    WeaponSet
        Conditions = None 
        Weapon = PRIMARY    HaldirBow 
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End   
    WeaponSet
        Conditions        = WEAPONSET_HERO_MODE
        Weapon            = PRIMARY    HaldirBowQuickDraw
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End    
    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1        ;CLOSE_RANGE CONTESTING_BUILDING
        Weapon = PRIMARY    HaldirSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    
    ArmorSet
        Conditions      = None
        Armor           = HeroArmor
        DamageFX        = NormalDamageFX
    End
    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = HaldirArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = M_VISION_HERO_RANGED
    ShroudClearingRange = M_SHROUD_CLEAR_RANGED_HERO

    BountyValue = 20
    DisplayName = OBJECT:ElvenHaldir
    RecruitText = CONTROLBAR:ElvenHaldirRecruit
    ReviveText    = CONTROLBAR:ElvenHaldirRevive
    Hotkey        = CONTROLBAR:ElvenHaldirHotkey
    CrusherLevel = 0            ;Can I crush anything?
    CrushableLevel = 2            ;What am I?:        0 = for infantry, 1 = for trees, 2 = cavalry/heroes

    CommandSet = ElvenHaldirSaFCommandSet
    CommandPoints = 0


    ; *** AUDIO Parameters ***;

    VoiceAttack                             = HaldirVoiceAttack
    VoiceAttackAir                            = HaldirVoiceAttack
    VoiceAttackCharge                         = HaldirVoiceAttackCharge
    VoiceAttackMachine                         = HaldirVoiceAttack
    VoiceAttackStructure                     = HaldirVoiceAttackBuilding
    VoiceMove                                 = HaldirVoiceMove
    VoiceMoveToCamp                         = HaldirVoiceMoveCamp
    VoiceMoveWhileAttacking                 = HaldirVoiceDisengage
    VoicePriority            = 82
    VoiceRetreatToCastle                     = HaldirVoiceRetreat
    VoiceSelect                             = HaldirVoiceSelectMS
    VoiceSelect2            = HaldirVoiceSelect
    VoiceSelectBattle                          = HaldirVoiceSelectBattle
    VoiceGuard                                = HaldirVoiceMove

    UnitSpecificSounds
        VoiceGarrison                        = HaldirVoiceMoveGarrison             
    End

    EvaEventDamagedOwner                = UnitUnderAttack ;Eva event to trigger when unit is damaged
    EvaEventDieOwner                    = HaldirDie    ;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU1            ; Tie into LargeGroupAudio system
        Key = Human Unit Infantry Hero
        UnitWeight = 2
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior1
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        Animation:GUFaramir_SKL.GUFaramir_RUNA        Frames:2 12
        AnimationSound = Sound:FootstepDirtA        Animation:GUFaramir_SKL.GUFaramir_RUNB        Frames:2 12

        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_ATKC        Frames:18        ;wounding arrow

        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHA        Frames:21
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:11
        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:28

        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:2
        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:3
        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHD        Frames:6

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEA        Frames:88
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEB        Frames:85
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEC        Frames:49
        AnimationSound = Sound:BodyFallSoldier        Animation:GUFaramir_SKL.GUFaramir_LNDA        Frames:3
        AnimationSound = Sound:BodyFallSoldier        Animation:GUFaramir_SKL.GUFaramir_LNDB        Frames:2

    End


    ; *** ENGINEERING Parameters ***

    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody1
        CheerRadius             = M_EMOTION_CHEER_RADIUS
        MaxHealth                 = M_HALDIR_HEALTH    ;BALANCE Faramir Health
        PermanentlyKilledByFilter    = NONE        ;Who kills me permanently?
           DodgePercent              = M_HERO_DODGE_PERCENT
    End
    Behavior = RespawnUpdate ModuleTag_RespawnUpdate1
        DeathAnim                = DYING                ;Model condition to play when killed-to-respawn
        DeathFX                = FX_SaFGoodDieToRespawn    ;FXList to play when killed-to-respawn
        DeathAnimationTime        = 5000                ;How long DeathAnim will take.
        InitialSpawnFX            = FX_HaldirInitialSpawn
        RespawnAnim                = LEVELED                ;Animation to play when respawning.
        RespawnFX                = FX_HaldirRespawn        ;FXList to play when respawning.
        RespawnAnimationTime        = 2000                ;Time it takes for respawn to play.
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP        ;Respawn at this location -- and at it's exit production point if possible.
        ButtonImage                = HIHaldir
        
        ;RespawnEntries determine the ruleset for how a character can be revived. Some units may automatically respawn, others
        ;may require a specific revive action performed on him. You can specify different values for each level... or use Level:Any
        RespawnRules =            AutoSpawn:No    Cost:600        Time:90000        Health:100%        ;DEFAULT VALUES
        RespawnEntry =    Level:2                Cost:700        Time:90000        ;For other levels, only override what is different.
        RespawnEntry =    Level:3                Cost:800        Time:90000        
        RespawnEntry =    Level:4                Cost:900        Time:90000        
        RespawnEntry =    Level:5                Cost:1000        Time:120000        
        RespawnEntry =    Level:6                Cost:1100        Time:120000        
        RespawnEntry =    Level:7                Cost:1200        Time:120000        
        RespawnEntry =    Level:8                Cost:1300        Time:120000        
        RespawnEntry =    Level:9                Cost:1400        Time:120000        
        RespawnEntry =    Level:10            Cost:1500        Time:120000        
    End
    
    Behavior = AutoHealBehavior ModuleTag_HaldirHealing1
        StartsActive = Yes
        HealingAmount = M_HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = M_HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_031
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 41
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL 
        Speed     = M_NORMAL_GOOD_FAST_HORDE_SPEED ; M_NORMAL_GOOD_HERO_SPEED
    End

    ;;; KINGS FAVOUR ;;;    
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingsFavorEnabler1
        SpecialPowerTemplate = SpecialAbilityKingsFavor
        TriggeredBy = Upgrade_GenericUpgrade8
    End
     Behavior = SpecialPowerModule ModuleTag_KingsFavorSpecialPowerModule1
        SpecialPowerTemplate        = SpecialAbilityKingsFavor 
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
;        InitiateSound                = FaramirKnightVoiceCaptain
    End
     Behavior = LevelGrantSpecialPower ModuleTag_KingsFavor1
        SpecialPowerTemplate        = SpecialAbilityKingsFavor
        UnpackingVariation            = 2
        StartAbilityRange            = 200.0
;        LevelFX = FX_PorterDeliver
        LevelFX                        = FX_LevelUp

        Experience                    = 50
        RadiusEffect                = 150
        AcceptanceFilter            = NONE +RohanArcherHorde +RohanRohirrimArcherHorde

        UnpackTime                    = 2000
        PreparationTime                = 1   
        FreezeAfterTriggerDuration    = 2000 ; Hold AI for this long after we fire.        
    End    
  
    Behavior = HeroDie ModuleTag_HeroDeath1
        SpecialPowerTemplate = SpecialAbilitySmite   ;the special power that I recharge by dying
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_HaldirLeadership1
        StartsActive    = No ;If no, requires upgrade to turn on.
        BonusName        = HaldirPassiveLeadership
        TriggeredBy        = Upgrade_GenericUpgrade3
        RefreshDelay    = 2500
        Range            = 150 ; 200
        ObjectFilter    = ANY +INFANTRY +CAVALRY  -STRUCTURE -BASE_FOUNDATION -HERO +RohanElvenWarriorHorde
    End    
    Behavior = AttributeModifierUpgrade ModuleTag_ElvenGiftBonus
        TriggeredBy = Upgrade_GenericUpgrade3
        AttributeModifier = HaldirSelfLeadership
    End
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HaldirLeadership2
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_GenericUpgrade3
    End
    Behavior = SpecialPowerModule ModuleTag_HaldirLeadershipUpdate1
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End    
    
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_PalantirVisionStarter
        SpecialPowerTemplate = SpecialAbilityHaldirVigilance
        TriggeredBy = Upgrade_GenericUpgrade6
    End
    Behavior = SpecialPowerModule ModuleTag_HaldirLeadershipUpdate2
        SpecialPowerTemplate      = SpecialAbilityHaldirVigilance
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End 
    Behavior = OCLSpecialPower ModuleTag_PalantirVision
        SpecialPowerTemplate = SpecialAbilityHaldirVigilance
        AttributeModifier    = PalantirVision ;
        AttributeModifierRange    = 100 ;
        AttributeModifierAffects= ANY +CAVALRY +MACHINE +HERO -STRUCTURE -BASE_FOUNDATION ; +HORDE +URUK 
        OCL                  = SpecialPowerVigilance
        CreateLocation       = CREATE_AT_LOCATION
        StartsPaused            = Yes
    End
    
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnpauseLeadership2
        SpecialPowerTemplate = SpecialAbilityFakeLeadership3
        TriggeredBy = Upgrade_GenericUpgrade5
    End
    Behavior = SpecialPowerModule ModuleTag_HaldirArmorLeadershipUpdate2
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End 
    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy = Upgrade_GenericUpgrade5
        ArmorSetFlag    = PLAYER_UPGRADE
    End
    
    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehavior1
    End        

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker1
        TauntAndPointDistance        =    300        ; max distance to taunted/pointed objet
         TauntAndPointUpdateDelay    =    1000    ; how often scan (milliseconds)
         
        AddEmotion    =    Alert_Base
     End    
    
    Behavior = PhysicsBehavior ModuleTag_041
        GravityMult = 1.0
        ShockStandingTime        = 2533    ;msec
    End
     
    Behavior = SlowDeathBehavior ModuleTag_051
        DeathTypes = ALL 
        SinkDelay = 30000
        SinkRate = 0.40     ; in Dist/Sec
        DestructionDelay = 8000
        Sound = INITIAL FaramirRangerVoiceDie
    End
    
    Behavior = SquishCollide ModuleTag_061
        ;nothing
    End
    
    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag1
        HitReactionLifeTimer1 = 1500 ; level 1 (light  damage)  hit reaction animations in ms
        HitReactionLifeTimer2 = 1500 ; level 2 (medium damage)  hit reaction animations in ms
        HitReactionLifeTimer3 = 1500 ; level 3 (heavy  damage)  hit reaction animations in ms

        HitReactionThreshold1 = 5.0   ; level 1 (light  damage) threshold trigger
        HitReactionThreshold2 = 25.0  ; level 2 (medium damage) threshold trigger
        HitReactionThreshold3 = 50.0  ; level 3 (heavy  damage) threshold trigger
        
        FastHitsResetReaction = Yes    If set -- when hits occur faster than the reaction animations, it will reset the animation. (like getting riddled with machine gun bullets)
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HaldirQuickDrawEnabler
        SpecialPowerTemplate = SpecialAbilityHaldirQuickDraw
        TriggeredBy = Upgrade_GenericUpgrade1
    End

      Behavior = SpecialPowerModule ModuleTag_HaldirQuickDrawStarter                ; SpecialAbility is a SpecialPower, SpecialPower is anyting special
        SpecialPowerTemplate    = SpecialAbilityHaldirQuickDraw
        StartsPaused            = No
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_HaldirQuickDrawUpdate   ; So the difference in SpecialAbility is that it takes timing from this Update, instead of simply firing.
        SpecialPowerTemplate    = SpecialAbilityHaldirQuickDraw
        HeroAttributeModifier    = HaldirQuickDraw
        HeroEffectDuration        = 25000 ; 30000 ; this should sync with the auto ability delay re-fire time in commandButtons.ini
        UnpackTime              = 1 ; insant unpack
;        TriggerSound            = AragornBladeMaster
    End
    
    Behavior = StealthUpdate ModuleTag_Stealth
        StealthDelay                = 0 ; msec
        StealthForbiddenConditions  = ATTACKING AWAY_FROM_TREES ;PLAYER_UPGRADE
        HintDetectableConditions    = IS_FIRING_WEAPON 
        FriendlyOpacityMin                    = M_STEALTH_FRIENDLY_OPACITY_MIN ;10
        FriendlyOpacityMax                    = M_STEALTH_FRIENDLY_OPACITY_MAX ;60
        DetectedByAnyoneRange        = 120
        PulseFrequency              = 750   ; msec
        OrderIdleEnemiesToAttackMeUponReveal  = Yes
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = No
  Shadow = SHADOW_DECAL
  ShadowSizeX = 20;
  ShadowSizeY = 20;
  ShadowTexture = ShadowI;
End

ChildObject ElvenHaldirV ElvenHaldirSaF
End
