; Moved from ElvenInfantry.INI Aug 24 2005
;------------------------------------------------------------------------------
;Creating this elf will randomize between several variations of the elf.
;------------------------------------------------------------------------------
Object MirkwoodArcher_Summoned

	SelectPortrait	= upmanymeetingsgreenwoodranger ;UPLothlorienSummonedRangers

	Draw = W3DScriptedModelDraw ModuleTag_01  
		DefaultModelConditionState
			;Give it a model so it'll show up in WB
			Model               = eugrnwdrngr_m1
		End
	End

	;***** IMPORTANT NOTE! ***************************************************************	
	;Certain Upgrades and costs may need to be propagated from here. One example was veterancy
	;overlays.
	;*************************************************************************************	

	Side = Rivendell
	EditorSorting = UNIT
	BuildVariations = MirkwoodArcher1_Summoned MirkwoodArcher2_Summoned
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT SWARM_DOZER GRAB_AND_DROP DOZER SUMMONED

End

; aka Elven Mirkwood Archer
Object MirkwoodArcher1_Summoned
	; *** ART Parameters ***
	SelectPortrait				=	upmanymeetingsgreenwoodranger ;UPLothlorienSummonedRangers
	ButtonImage						=	upmanymeetingsgreenwoodranger ;UILothlorienSummonedRangers
	
	Draw	=	W3DHordeModelDraw ModuleTag_01m
		OkToChangeModelColor = Yes
		StaticModelLODMode = no ; Will append M or L to the skin name depending on GameLOD
		ParticlesAttachedToAnimatedBones = yes

; --------- With Bow ------------
		DefaultModelConditionState
			Model						        =	tumirkarch_m
			Skeleton					      = GUArcher_SKL
			WeaponLaunchBone			  =	PRIMARY ARROW
			WeaponLaunchBone			  =	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			  =	TERTIARY ARROW
			;ParticleSysBone				  =	NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
		End
		
; --------- With Bow Upgrade  ------------
		ModelConditionState				=	WEAPONSET_PLAYER_UPGRADE
			Model						        =	tumirkarch_m
			Skeleton					      = GUArcher_SKL
			WeaponLaunchBone			  =	PRIMARY ARROW
			WeaponLaunchBone			  =	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			  =	TERTIARY ARROW
			;ParticleSysBone				  =	NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
		End
		
;----------- Default Idle animations -------
		IdleAnimationState
			StateName					=   STATE_Idle
			Animation = IdleA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			;*** Repeat IDLA because animation priorities will not choose same animation twice so it can alternate between first two mostly.
			Animation = IdleA	
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleH
				AnimationName			=	GUArcher_IDLH
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleI
				AnimationName			=	GUArcher_IDLI
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleJ
				AnimationName			=	GUArcher_IDLJ
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
		End
		
;----------- Flying through air -------
		AnimationState						= PASSENGER
			Animation						= FLLA
				AnimationName				= GUArcher_FLLA
				AnimationMode				= LOOP
			End
		End
		
		
		AnimationState        = THROWN_PROJECTILE
			Animation           = FLYA
				AnimationName     = GUArcher_FLYA
				AnimationMode     = LOOP
			End
		End
		
		AnimationState						= FREEFALL
			Animation						= Falling
				AnimationName				= GUArcher_FLYA
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
				AnimationSpeedFactorRange	= 0.35	0.35
			End
		End
		
		AnimationState					=	STUNNED_FLAILING 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_FLLA 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
		
		

;----------- Dying -------

		AnimationState				=	DYING DEATH_2
			Animation
				AnimationName				= GUArcher_IDLA
				AnimationMode				= LOOP
			End
		End
	
		AnimationState					=	DYING SPLATTED
			Animation					=	Fire
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
            EnteringStateFX = FX_SoldierHitGround
		End

		AnimationState					=	DYING AFLAME
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDA 
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDB 
				AnimationSpeedFactorRange = 0.9 1.1
			End
		End

		AnimationState					=	DYING
			Animation					=	Die2
				AnimationName			=	GUArcher_DIEB 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation					=	Die3
				AnimationName			=	GUArcher_DIED 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End

;------ Stunned anims -----------
		AnimationState					=	STUNNED_STANDING_UP 
			Animation					=	GTPA
				AnimationName			=	GUArcher_GTPA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		AnimationState					=	STUNNED 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
			End
            EnteringStateFX = FX_SoldierHitGround
		End

;------- Close range melee fighting ------------
		AnimationState					=	FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
			Animation					=	ATKD
				AnimationName			=	GUArcher_ATKD
				AnimationMode			=	ONCE
				UseWeaponTiming			=	Yes
			End
		End

;------- New Style Archery --------------------------------------------
		AnimationState					=	PREATTACK_A 
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_A 
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
				AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
			End
		End

		AnimationState					=	PREATTACK_C
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_C
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
				AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
			End
		End

	
;;========= TERROR
		AnimationState					= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
			Animation					= TerrorFromTheSky
				AnimationName			= GUArcher_RUNC
				AnimationMode			= LOOP
			End
		End

;;========= BACKING UP
		AnimationState				=	MOVING BACKING_UP
			Animation				=	BackingUp
				AnimationName		=	GUArcher_BAKA
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
		End

;;========= MOVING

		AnimationState					=	MOVING ATTACKING
			Animation					=	AMove
				AnimationName			=	GUArcher_RUNB 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
		
		AnimationState					=	MOVING WANDER
			Animation					=	Wander1
				AnimationName			=	GUArcher_WLKA 
			End
			Animation					=	Wander2
				AnimationName			=	GUArcher_WLKB ;20
			End
			Flags						=	RANDOMSTART
		End

		AnimationState					=	MOVING
			Animation					=	Move
				AnimationName			=	GUArcher_RUNA 
				AnimationMode			=	LOOP
			End
			Animation					=	MoveB
				AnimationName			=	GUArcher_RUNB 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End

;-------- Persistant firing (keep bow drawn ) ------------
		AnimationState					= CONTINUOUS_FIRE_MEAN
			StateName					=	STATE_Firing
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	MANUAL
			End
		End
		
		AnimationState						= CONTINUOUS_FIRE_SLOW
			StateName						= STATE_Idle
			Animation						= PutAwayArrow
				AnimationName				= GUArcher_ATKF3
				AnimationMode				= ONCE
			End
		End
		
;------------ HIT REACTION -----------------------------------------------------
		AnimationState = HIT_REACTION
			Animation = Hit_Level_1_a
				AnimationName = GUArcher_HITA
				AnimationMode = ONCE
			End
		End
		
;--------------------- EMOTIONS -----------------------------

;;======= TERROR

		AnimationState					= EMOTION_AFRAID
			Animation					= FERA
				AnimationName			= GUArcher_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= GUArcher_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= GUArcher_FERC
				AnimationMode			= LOOP
			End
			Animation					= FERD
				AnimationName			= GUArcher_FERD
				AnimationMode			= LOOP
			End
		End
		
;;======= CELEBRATING

		AnimationState					= EMOTION_CELEBRATING
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= SLTA
				AnimationName			= GUArcher_SLTA
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationBlendTime		= 15		
				AnimationPriority		= 1;Use least often of cheers (Eugene)
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End
		
;;======== TAUNTING

		AnimationState					= EMOTION_TAUNTING
			Animation					= Taunting2
				AnimationName			= GUArcher_IDLE
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting3
				AnimationName			= GUArcher_IDLF
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting4
				AnimationName			= GUArcher_IDLG
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End

			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End

;;======== POINTING

		AnimationState						= EMOTION_POINTING
			ShareAnimation					= Yes
			Animation						= pointing
				AnimationName				= GUArcher_PNTA
				AnimationPriority			= 2
				AnimationSpeedFactorRange	= 0.9 1.1
				AnimationMode				= LOOP
			End
		End
		

;;======== ALERT
		
		AnimationState					= EMOTION_ALERT
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Point
				AnimationName			= GUArcher_PNTA
				AnimationMode			= LOOP
				AnimationPriority		= 1
				AnimationBlendTime		= 15
			End
		End

; Turn off fire arrow visuals -- will be redone like Peasant drafting.
;;----------------- FIRE ARROW UPGRADE --------------------------------------------
		AnimationState        =  USER_4 ;Fire arrow upgrade
			Animation = IdleB
				AnimationName			=	GUArcher_IDLB 
				AnimationPriority		=	2 ;10
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleC
				AnimationName			=	GUArcher_IDLC
				AnimationPriority		=	1 ;5
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleD
				AnimationName			=	GUArcher_IDLD
				AnimationPriority		=	1 ;5
				AnimationSpeedFactorRange = 0.7 1.3
			End
			BeginScript
				CurDrawableShowSubObject("ArrowNock")
				CurDrawableShowSubObject("FireArowTip")
			EndScript
			StateName           = Bow
		End

;;----------------- SELECTED --------------------------------------------
		AnimationState					=	SELECTED
			StateName					=	STATE_Selected
			Animation					=	ATNB
				AnimationName			=	GUArcher_ATNB
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	IDLA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	10
				AnimationSpeedFactorRange = 0.7 1.3
			End

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" 
				then 
					CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") 
				end
				if CurDrawableModelcondition("ATTACKING")
				then
					return "IDLA"
				else
					return "ATNB"
				end
			EndScript
		End
		
	
;;----------------- Transitions ------------------------------------------------------
		TransitionState					=	TRANS_Idle_to_Selected
			Animation					=	ATNA
				AnimationName			=	GUArcher_ATNA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
		End
		TransitionState					=	TRANS_Selected_To_Idle
			Animation					=	ATNC
				AnimationName			=	GUArcher_ATNC
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 1.0 2.0 ;Kind of a slow animation
			End
		End
	End

	; ***DESIGN parameters ***
	Side 		            = Rivendell
	DisplayName         = OBJECT:RivendellMirkwoodArcher
	EditorSorting 	    = UNIT
	ThreatLevel 	      = 1.0
	ThingClass 	        = HORDE_UNIT
	TransportSlotCount  = 1
	CrushableLevel      = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrushRevengeWeapon  = RangedInfantryCrushRevenge
	VisionRange         = M_GONDOR_ARCHER_VISION_RANGE
	ShroudClearingRange = M_SHROUD_CLEAR_STANDARD			
	BountyValue         = M_GONDOR_ARCHER_BOUNTY_VALUE
	CommandSet          = RivendellMirkwoodArcherCommandSet 
	CommandPoints 	    = 0 

	WeaponSet
		Conditions        = None 
		Weapon 			      = PRIMARY    GondorArcherBow ;MirkwoodRangerBow
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	
	WeaponSet
		Conditions        = PLAYER_UPGRADE
		Weapon 			      = PRIMARY    GondorArcherBow ;MirkwoodRangerBow
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
		
	WeaponSet
		Conditions        = CLOSE_RANGE CONTESTING_BUILDING
		Weapon            = PRIMARY   GondorArcherBowMelee
	End

	ArmorSet
		Conditions        = None
		Armor             = GondorArcherArmor ;MirkwoodArcherArmor
		DamageFX          = NormalDamageFX
	End
	
	ArmorSet
		Conditions		    = PLAYER_UPGRADE
		Armor			        = GondorArcherArmorHeavyArmor ;MirkwoodArcherHeavyArmor
		DamageFX		      = NormalDamageFX
	End

	; *** AUDIO Parameters ***;
	VoiceAmbushed												  = MirkwoodElvesVoiceAmbushed
	VoiceAttack 								          = MirkwoodElvesVoiceAttackRanged
	VoiceAttackAir								        = MirkwoodElvesVoiceAttackRanged
	VoiceAttackCharge 							      = MirkwoodElvesVoiceAttackCharge
	VoiceAttackMachine 							      = MirkwoodElvesVoiceAttackRanged
	VoiceAttackStructure 						      = MirkwoodElvesVoiceAttackBuilding
	VoiceCreated 								          = MirkwoodElvesVoiceSaluteRanged
	VoiceFullyCreated							        = MirkwoodElvesVoiceSaluteRanged
	VoiceGuard									          = MirkwoodElvesVoiceMove
	VoiceMove 									          = MirkwoodElvesVoiceMove
	VoiceMoveToCamp 							        = MirkwoodElvesVoiceMoveCamp
	VoiceMoveWhileAttacking 					    = MirkwoodElvesVoiceDisengage
	VoicePriority								          = 24
	VoiceRetreatToCastle 						      = MirkwoodElvesVoiceRetreat
	VoiceSelect 								          = MirkwoodElvesVoiceSelect
	VoiceSelectBattle  							      = MirkwoodElvesVoiceSelectBattle
	
	VoiceEnterStateAttack 						    = MirkwoodElvesVoiceEnterStateAttackRanged
	VoiceEnterStateAttackCharge 				  = MirkwoodElvesVoiceEnterStateAttackCharge
	VoiceEnterStateAttackStructure 				= MirkwoodElvesVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackMachine 				  = MirkwoodElvesVoiceEnterStateAttackBuilding
	VoiceEnterStateMove 						      = MirkwoodElvesVoiceEnterStateMove
	VoiceEnterStateMoveToCamp 					  = MirkwoodElvesVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking			= MirkwoodElvesVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle	 			= MirkwoodElvesVoiceEnterStateRetreat

	SoundImpact									          = ImpactHorse
	
	EvaEventDamagedOwner                  = UnitUnderAttack 						;Eva event to trigger when unit is damaged

	Behavior                              = LargeGroupAudioUpdate ModuleTag_LGAU					; Tie into LargeGroupAudio system
		Key                                 = Elf Unit Infantry Elf_Warrior
	End
	
	UnitSpecificSounds
		VoiceGarrison         					    = MirkwoodElvesVoiceGarrison
		VoiceMoveToTrees						        = MirkwoodElvesVoiceMoveTrees
		VoiceEnterStateMoveToTrees				  = MirkwoodElvesVoiceEnterStateMoveTrees
	End

	; ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		; ModelCondition = Required:EMOTION_CELEBRATING	Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxCheerSinglesLoop	;MOVING ATTACKING 
		; ModelCondition = Required:EMOTION_TAUNTING		Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxTauntSinglesLoop	;MOVING ATTACKING
	; End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:BodyFallGeneric1			Animation:GUArcher_SKL.GUArcher_DIEB	Frames:19
		AnimationSound = Sound:BodyFallGeneric1			Animation:GUArcher_SKL.GUArcher_DIED	Frames:53
		AnimationSound = Sound:BodyFallGeneric1			Animation:GUArcher_SKL.GUArcher_LNDA	Frames:1
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:GUArcher_SKL.GUArcher_LNDA	Frames:14
	End

	; *** ENGINEERING Parameters ***
	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ARCHER GRAB_AND_DROP ATTACK_NEEDS_LINE_OF_SIGHT SUMMONED
	
	Body                          = ActiveBody ModuleTag_02
		CheerRadius 	              = M_EMOTION_CHEER_RADIUS
		MaxHealth                   = M_ROHAN_ELVENWARRIOR_HEALTH			;BALANCE RohanElvenWarrior
		MaxHealthDamaged            = M_ROHAN_ELVENWARRIOR_HEALTH_DAMAGED		
	End
	
	Behavior                      = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle	= Yes 
		CanAttackWhileContained		  = Yes
		AILuaEventsList				      = MirkwoodArcherFunctions
		AttackPriority				      = AttackPriority_Archer
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime                 = 120000 ; 180000
		MaxLifetime                 = 120000 ; 180000
		DeathType                   = FADED
	End
	
	LocomotorSet
		Locomotor                   = HumanLocomotor
		Condition                   = SET_NORMAL 
		Speed                       = M_NORMAL_GOOD_FAST_MEMBER_SPEED		
	End

	LocomotorSet
		Locomotor                   = HumanWanderLocomotor
		Condition                   = SET_WANDER
		Speed                       = M_NORMAL_GOOD_FAST_MEMBER_SPEED		
	End

	LocomotorSet
		Locomotor                   = HumanPanicLocomotor
		Condition                   = SET_PANIC
		Speed	                      = M_NORMAL_GOOD_FAST_MEMBER_SPEED		
	End
	
	LocomotorSet
		Locomotor                   = HumanScaredLocomotor
		Condition                   = SET_SCARED
		Speed	                      = M_NORMAL_GOOD_FAST_MEMBER_SPEED		
	End

	Behavior                      = PhysicsBehavior ModuleTag_04
		GravityMult                 = 1.0
	End

	Behavior                      = AimWeaponBehavior AimWeaponModuleTag
		AimLowThreshold             = -0.15
		AimHighThreshold            =  0.15
	End
	
	Behavior                      = SlowDeathBehavior ModuleTag_05
		DeathTypes                  = ALL -FADED
		SinkDelay                   = 3000
		SinkRate                    = 0.600     ; in Dist/Sec
		DestructionDelay            = 12000
		Sound                       = INITIAL RivendellElfVoiceDie
	End
	
	Behavior                      = SlowDeathBehavior ModuleTag_SlowDeathFaded
		DeathTypes                  = NONE +FADED
		FadeDelay		                = 0
		FadeTime		                = 4000
		DestructionDelay            = 4000
		DeathFlags		              = DEATH_2
		Sound                       = INITIAL FX_RohirrimAlliesUnsummon
	End
	
	Behavior                      = SquishCollide ModuleTag_06
		;nothing
	End
	
	; RohanArcher
	Behavior                      = HordeMemberCollide ModuleTag_HMC
		;nothing
	End
	
	Behavior                      = BezierProjectileBehavior ModuleTag_07 ; Module starts asleep, and wakes up when thrown.
		FirstHeight                 = 24  ; Height of Bezier control points above highest intervening terrain
		SecondHeight                = 24
		FirstPercentIndent          = 30% ; Percentage of shot distance control points are placed
		SecondPercentIndent         = 70%
		TumbleRandomly              = Yes

		CrushStyle                  = Yes ; I don't detonate, I just hit
		DieOnImpact                 = Yes
		BounceCount                 = 1   ; When I hit the ground, I'll arc again
		BounceDistance              = 40 ; this far
		BounceFirstHeight           = 24  ; Height of Bezier control points above highest intervening terrain
		BounceSecondHeight          = 24
		BounceFirstPercentIndent    = 20% ; Percentage of shot distance control points are placed
		BounceSecondPercentIndent   = 80%

		GroundHitFX                 = FX_ThrownRockGroundHit
		GroundBounceFX              = FX_ThrownRockBounceHit
	End

	;-------------------------------------------------------------------------
	;
	;	Sub object upgrades.
	;
  	
  	Behavior                    = SubObjectsUpgrade Armor_Upgrade
  		TriggeredBy		            = Upgrade_RivendellHeavyArmor
  		UpgradeTexture	          = EUMirkArch.tga 0 EUMirkArchHA.tga
  		UpgradeTexture	          = EUMirkArch_M.tga 0 EUMirkArchHA.tga
  		ShowSubObjects	          = ARMOR
 			RecolorHouse	            = Yes
			ExcludeSubobjects         = FireArowTip
  	End
  	
  	Behavior                    = SubObjectsUpgrade MagicArrows_Upgrade
  		TriggeredBy		            = Upgrade_RivendellImprovedArrows
  		ShowSubObjects	          = FireArowTip ArrowNock			; yes, it's a typo.
  		HideSubObjects	          = arrow
  	End

	;--------------------------------------------------------------------------
	
	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 1993 ; level 1 (light  damage)  hit reaction animations in ms
		HitReactionLifeTimer2 = 1993 ; level 2 (medium damage)  hit reaction animations in ms
		HitReactionLifeTimer3 = 1993 ; level 3 (heavy  damage)  hit reaction animations in ms

		HitReactionThreshold1 = 5.0   ; level 1 (light  damage) threshold trigger
		HitReactionThreshold2 = 25.0  ; level 2 (medium damage) threshold trigger
		HitReactionThreshold3 = 50.0  ; level 3 (heavy  damage) threshold trigger

		FastHitsResetReaction = Yes    ;If set -- when hits occur faster than the reaction animations, it will reset the animation. (like getting riddled with machine gun bullets)
	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes

  Shadow = SHADOW_DECAL
  ShadowSizeX = 19;
  ShadowSizeY = 19;
  ShadowTexture = ShadowI;
End
;===================================FEMALE ARCHER============================================
ChildObject MirkwoodArcher2_Summoned MirkwoodArcher1_Summoned

	; *** ART Parameters ***
	Draw	=	W3DHordeModelDraw ModuleTag_01f
		OkToChangeModelColor = Yes
		StaticModelLODMode = no ; Will append M or L to the skin name depending on GameLOD
		ParticlesAttachedToAnimatedBones = yes

; --------- With Bow ------------
		DefaultModelConditionState
			Model						        =	tumirkarch_f
			Skeleton					      = GUArcher_SKL
			WeaponLaunchBone			  =	PRIMARY ARROW
			WeaponLaunchBone			  =	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			  =	TERTIARY ARROW
			;ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
		End
		
; --------- With Bow Upgrade  ------------
		ModelConditionState				=	WEAPONSET_PLAYER_UPGRADE
			Model						        =	tumirkarch_f
			Skeleton					      = GUArcher_SKL
			WeaponLaunchBone			  =	PRIMARY ARROW
			WeaponLaunchBone			  =	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			  =	TERTIARY ARROW
			;ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
		End
		
;----------- Default Idle animations -------
		IdleAnimationState
			StateName					=   STATE_Idle
			Animation = IdleA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			;*** Repeat IDLA because animation priorities will not choose same animation twice so it can alternate between first two mostly.
			Animation = IdleA	
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleH
				AnimationName			=	GUArcher_IDLH
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleI
				AnimationName			=	GUArcher_IDLI
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleJ
				AnimationName			=	GUArcher_IDLJ
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
		End
		
;----------- Flying through air -------
		AnimationState						= PASSENGER
			Animation						= FLLA
				AnimationName				= GUArcher_FLLA
				AnimationMode				= LOOP
			End
		End
		
		
		AnimationState        = THROWN_PROJECTILE
			Animation           = FLYA
				AnimationName     = GUArcher_FLYA
				AnimationMode     = LOOP
			End
		End
		
		AnimationState						= FREEFALL
			Animation						= Falling
				AnimationName				= GUArcher_FLYA
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
				AnimationSpeedFactorRange	= 0.35	0.35
			End
		End
		
		AnimationState					=	STUNNED_FLAILING 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_FLLA 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
;----------- Dying -------
	AnimationState				=	DYING DEATH_2
		Animation
			AnimationName				= GUArcher_IDLA
			AnimationMode				= LOOP
		End
	End
		
		AnimationState					=	DYING SPLATTED
			Animation					=	Fire
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
      EnteringStateFX = FX_SoldierHitGround
		End

		AnimationState					=	DYING AFLAME
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDA 
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDB 
				AnimationSpeedFactorRange = 0.9 1.1
			End
		End

		AnimationState					=	DYING
			Animation					=	Die2
				AnimationName			=	GUArcher_DIEB 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation					=	Die3
				AnimationName			=	GUArcher_DIED 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End

;------ Stunned anims -----------
		AnimationState					=	STUNNED_STANDING_UP 
			Animation					=	GTPA
				AnimationName			=	GUArcher_GTPA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		

		AnimationState					=	STUNNED 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
			End
      EnteringStateFX = FX_SoldierHitGround
		End

;------- Close range melee fighting ------------
		AnimationState					=	FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
			Animation					=	ATKD
				AnimationName			=	GUArcher_ATKD
				AnimationMode			=	ONCE
				UseWeaponTiming			=	Yes
			End
		End

;------- New Style Archery --------------------------------------------
		AnimationState					=	PREATTACK_A 
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_A 
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
				AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
			End
		End

		AnimationState					=	PREATTACK_C
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_C
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
				AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
			End
		End

	
;;========= TERROR
		AnimationState					= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
			Animation					= TerrorFromTheSky
				AnimationName			= GUArcher_RUNC
				AnimationMode			= LOOP
			End
		End

;;========= BACKING UP
		AnimationState				=	MOVING BACKING_UP
			Animation				=	BackingUp
				AnimationName		=	GUArcher_BAKA
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
		End

;;========= MOVING

		AnimationState					=	MOVING ATTACKING
			Animation					=	AMove
				AnimationName			=	GUArcher_RUNB 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
		
		AnimationState					=	MOVING WANDER
			Animation					=	Wander1
				AnimationName			=	GUArcher_WLKA 
			End
			Animation					=	Wander2
				AnimationName			=	GUArcher_WLKB ;20
			End
			Flags						=	RANDOMSTART
		End

		AnimationState					=	MOVING
			Animation					=	Move
				AnimationName			=	GUArcher_RUNA 
				AnimationMode			=	LOOP
			End
			Animation					=	MoveB
				AnimationName			=	GUArcher_RUNB 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End

;-------- Persistant firing (keep bow drawn ) ------------
		AnimationState					= CONTINUOUS_FIRE_MEAN
			StateName					=	STATE_Firing
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	MANUAL
			End
		End
		
		AnimationState						= CONTINUOUS_FIRE_SLOW
			StateName						= STATE_Idle
			Animation						= PutAwayArrow
				AnimationName				= GUArcher_ATKF3
				AnimationMode				= ONCE
			End
		End
		
;------------ HIT REACTION -----------------------------------------------------
		AnimationState = HIT_REACTION
			Animation = Hit_Level_1_a
				AnimationName = GUArcher_HITA
				AnimationMode = ONCE
			End
		End
		
;--------------------- EMOTIONS -----------------------------

;;======= TERROR

		AnimationState					= EMOTION_AFRAID
			Animation					= FERA
				AnimationName			= GUArcher_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= GUArcher_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= GUArcher_FERC
				AnimationMode			= LOOP
			End
			Animation					= FERD
				AnimationName			= GUArcher_FERD
				AnimationMode			= LOOP
			End
		End
		
;;======= CELEBRATING

		AnimationState					= EMOTION_CELEBRATING
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= SLTA
				AnimationName			= GUArcher_SLTA
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationBlendTime		= 15		
				AnimationPriority		= 1;Use least often of cheers (Eugene)
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End
		
;;======== TAUNTING

		AnimationState					= EMOTION_TAUNTING
			Animation					= Taunting2
				AnimationName			= GUArcher_IDLE
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting3
				AnimationName			= GUArcher_IDLF
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting4
				AnimationName			= GUArcher_IDLG
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End

			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End

;;======== POINTING

		AnimationState						= EMOTION_POINTING
			ShareAnimation					= Yes
			Animation						= pointing
				AnimationName				= GUArcher_PNTA
				AnimationPriority			= 2
				AnimationSpeedFactorRange	= 0.9 1.1
				AnimationMode				= LOOP
			End
		End
		

;;======== ALERT
		
		AnimationState					= EMOTION_ALERT
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Point
				AnimationName			= GUArcher_PNTA
				AnimationMode			= LOOP
				AnimationPriority		= 1
				AnimationBlendTime		= 15
			End
		End

; Turn off fire arrow visuals -- will be redone like Peasant drafting.
;;----------------- FIRE ARROW UPGRADE --------------------------------------------
		AnimationState        =  USER_4 ;Fire arrow upgrade
			Animation = IdleB
				AnimationName			=	GUArcher_IDLB 
				AnimationPriority		=	2 ;10
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleC
				AnimationName			=	GUArcher_IDLC
				AnimationPriority		=	1 ;5
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleD
				AnimationName			=	GUArcher_IDLD
				AnimationPriority		=	1 ;5
				AnimationSpeedFactorRange = 0.7 1.3
			End
			BeginScript
				CurDrawableShowSubObject("ArrowNock")
				CurDrawableShowSubObject("FireArowTip")
			EndScript
			StateName           = Bow
		End

;;----------------- SELECTED --------------------------------------------
		AnimationState					=	SELECTED
			StateName					=	STATE_Selected
			Animation					=	ATNB
				AnimationName			=	GUArcher_ATNB
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	IDLA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	10
				AnimationSpeedFactorRange = 0.7 1.3
			End

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" 
				then 
					CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") 
				end
				if CurDrawableModelcondition("ATTACKING")
				then
					return "IDLA"
				else
					return "ATNB"
				end
			EndScript
		End
		
;;----------------- Transitions ------------------------------------------------------
		TransitionState					=	TRANS_Idle_to_Selected
			Animation					=	ATNA
				AnimationName			=	GUArcher_ATNA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
		End
		TransitionState					=	TRANS_Selected_To_Idle
			Animation					=	ATNC
				AnimationName			=	GUArcher_ATNC
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 1.0 2.0 ;Kind of a slow animation
			End
		End
	End
	
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL
		SinkDelay = 3000
		SinkRate = 0.600     ; in Dist/Sec
		DestructionDelay = 12000
		Sound = INITIAL RivendellElfFemaleVoiceDie
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime                      	 = 120000 ; 180000
		MaxLifetime                      	 = 120000 ; 180000
		DeathType                        	 = FADED
	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes

  Shadow = SHADOW_DECAL
  ShadowSizeX = 19;
  ShadowSizeY = 19;
  ShadowTexture = ShadowI;
End