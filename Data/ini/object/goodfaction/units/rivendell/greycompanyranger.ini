;------------------------------------------------------------------------------
;
;    GreyCompanyRanger.ini
;
;------------------------------------------------------------------------------
; aka Grey Company
Object GreyCompanyRanger
	; *** ART Parameters ***

	SelectPortrait         = uprivgreycompany
	ButtonImage            = uirivgreycompany

	Draw = W3DHordeModelDraw ModuleTag_01
		OkToChangeModelColor = Yes	
		StaticModelLODMode = Yes
		ParticlesAttachedToAnimatedBones = Yes
		
;;=================== MODELS ============================================================
; --------- With Bow ------------
; Bah, must come first even though all the other bow stuff is below the sword stuff
		DefaultModelConditionState
			Model						= augreycomp_bow
			WeaponLaunchBone			= PRIMARY ARROW
		End

		ModelConditionState	=	WEAPONSET_PLAYER_UPGRADE
			Model									= augreycomp_bow
			WeaponLaunchBone			= PRIMARY ARROW
			WeaponLaunchBone			= SECONDARY ARROWNOCK	; when upgraded to flaming arrow
		End
		
		ModelConditionState				WEAPONSET_TOGGLE_1
			Model							    =  augreycomp_spr  ; augreycomp_swd
		End

;================== ANIMATIONS ==============================================================		
;----------- Flying through air -------
		AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_FLYB
				AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode     = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags               = RANDOMSTART
		End
		AnimationState        = STUNNED_FLAILING 
			StateName           = STATE_Bow
			Animation           = GUFaramir_FLYA
				AnimationName     = GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode     = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags               = RANDOMSTART
			BeginScript
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		;--------------------------Dying
		AnimationState					= DYING DEATH_2 WEAPONSET_TOGGLE_1
			StateName					= STATE_Selected_Sword
			Animation					= ATNE
				AnimationName			= GUFaramir_SKL.gudundan_idlb
				AnimationMode			= LOOP
				AnimationBlendTime		= 15
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableHideSubObject("arrow")
			EndScript
		End		
		AnimationState				=	DYING DEATH_2
			StateName				=	STATE_Bow
			Animation				=	ATNB
				AnimationName		=	GUFaramir_SKL.GUFaramir_ATNB
				AnimationMode		=	LOOP
				AnimationBlendTime  = 15
			End
			BeginScript
				; CurDrawableHideSubObject("spear")
			EndScript			
		End	
		AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_LNDB
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode     = ONCE
			End
		End
		AnimationState        = DYING SPLATTED
			StateName           = STATE_Bow
			Animation           = GUFaramir_LNDA
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode     = ONCE
			End
			BeginScript
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		AnimationState        = DYING WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_DIEA
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
				AnimationMode     = ONCE
			End
			Animation           = GUFaramir_DIEB
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
				AnimationMode     = ONCE
			End
		End
		AnimationState        = DYING
			StateName           = STATE_Bow
			Animation           = GUFaramir_DIEC
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEC
				AnimationMode     = ONCE
			End
			BeginScript
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		;--------------------------Stunned
		AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_GTPB
				AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End
		AnimationState        = STUNNED_STANDING_UP
			StateName           = STATE_Bow
			Animation           = GUFaramir_GTPA
				AnimationName     = GUFaramir_SKL.GUFaramir_GTPA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
			BeginScript
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		AnimationState        = STUNNED WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_LNDB
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode     = ONCE
			End
		End
		AnimationState        = STUNNED 
			StateName           = STATE_Bow
			Animation           = GUFaramir_LNDA
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode     = ONCE
			End
			BeginScript
				; CurDrawableHideSubObject("spear")
			EndScript
		End				
		AnimationState        = USER_1
			Animation           = GUFaramir_POSA
				AnimationName     = GUFaramir_SKL.GUFaramir_POSA
				AnimationMode     = ONCE
			End
		End
		AnimationState        =  SPECIAL_WEAPON_ONE
			StateName = STATE_Bow
			Animation
				AnimationName           = GUFaramir_SKL.GUFaramir_ATKC
				AnimationMode       = ONCE
			End
			FrameForPristineBonePositions = 59
			BeginScript
				CurDrawableShowSubObject("arrow")
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		;------------------------Moving
		AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
			Animation           = TrotAndFire
				AnimationName       = GUFaramir_SKL.gudundan_atra
				AnimationMode       = LOOP
				AnimationSpeedFactorRange = 1.0 1.3
			End
			Flags               = RANDOMSTART
			StateName = RunAndSwing
			BeginScript
				CurDrawableHideSubObject("arrow")
			EndScript
		End
		AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = ATKD
				AnimationName     = GUFaramir_SKL.gudundan_atka
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
				AnimationSpeedFactorRange = 1.149 1.149
			End
			Animation           = ATKE
				AnimationName    = GUFaramir_SKL.gudundan_atkb
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
				AnimationSpeedFactorRange = 1.149 1.149
			End
			Animation           = ATKF
				AnimationName    = GUFaramir_SKL.gudundan_atka
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.47 1.47
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
			EndScript
		End
		AnimationState        = MOVING USER_4
			StateName           = Slaughter
			Flags               = RANDOMSTART
			Animation           = gudundan_atkb
				AnimationName     = GUFaramir_SKL.gudundan_atkb
				AnimationMode     = LOOP
			End
			StateName           = NoSword
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
			EndScript
		End
				AnimationState                =    MOVING WEAPONSET_TOGGLE_1 ATTACKING
            Animation                =    gudundan_runb
                AnimationName        =    GUFaramir_SKL.gudundan_runb
                AnimationMode        =    LOOP
				AnimationSpeedFactorRange = 1.0 1.3
				;AnimationSpeedFactorRange = 0.9 0.9
            End
			Animation                        = GUFaramirA_RUND
                AnimationName                = GUManMocap_RUND
                AnimationMode                = LOOP
                ;AnimationSpeedFactorRange = 0.9 0.9
            End
            Flags                    =    RANDOMSTART
            ParticleSysBone        =    None InfantryDustTrails
            BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
			EndScript
        End
		
		AnimationState			= MOVING WEAPONSET_TOGGLE_1
			StateName           = STATE_RunningSword
			Flags               = RANDOMSTART
			Animation           = gudundan_rund
				AnimationName   = GUFaramir_SKL.gudundan_rund
				AnimationSpeedFactorRange = 1.0 1.3
				; AnimationSpeedFactorRange = 0.85 0.85
				; Distance		= 28
			End
			Animation           = gudundan_rune
				AnimationName   = GUFaramir_SKL.gudundan_rune
				AnimationSpeedFactorRange = 1.0 1.3
				;AnimationSpeedFactorRange = 0.85 0.85
				; Distance		= 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
				CurDrawableHideSubObject("arrow")
			EndScript
		End
		
		
		AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = ATKD
				AnimationName     = GUFaramir_SKL.gudundan_idlat
				AnimationMode     = MANUAL
			End			
		End
		AnimationState			= MOVING
			StateName           = STATE_RunningBow
			Flags               = RANDOMSTART
			Animation           = GUFaramir_RUNA
				AnimationName   = GUFaramir_SKL.guithil_runa
				AnimationSpeedFactorRange = 1.0 1.3
				; AnimationSpeedFactorRange = 0.85 0.85
				; Distance = 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		
		AnimationState					= MOVING EMOTION_TERROR
			Animation					= Terror
				AnimationName			= GUFaramir_SKL.GUFaramir_RUNA
				AnimationMode			= LOOP
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				; CurDrawableHideSubObject("spear")
			EndScript
		End
;============================================CONTINUOUS FIRING VANILLA=============================	
;---------------------------------------------------
		AnimationState						= PREATTACK_A 
			StateName						= STATE_Firing
			Animation						= ReadyToDrawn
				AnimationName				= GUFaramir_SKL.guithil_atka1
				AnimationMode				= ONCE
				UseWeaponTiming				= Yes
				AnimationSpeedFactorRange	= 1.5 1.5
				AnimationBlendTime			= 10			
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState						= FIRING_OR_RELOADING_A
			StateName						= STATE_Firing
			Animation						= OneFrameOfShooting
				AnimationName				= GUFaramir_SKL.guithil_atka2
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 1.0 1.0 ;1.25 1.25
				AnimationBlendTime			= 0
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End

;============================================CONTINUOUS FIRING VANILLA=============================	
;----Keep PreAttack_C after _A. Thats what fixes the strange shooting		
		AnimationState						= PREATTACK_C
			StateName						= STATE_Firing
			Animation						= ReadyToDrawn
				AnimationName				= GUFaramir_SKL.guithil_atka1
				AnimationMode				= ONCE
;				UseWeaponTiming				= Yes			; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange	= 1.5 1.5		; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime			= 10			
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState						= FIRING_OR_RELOADING_C
			StateName						= STATE_Firing
			Animation						= OneFrameOfShooting
				AnimationName				= GUFaramir_SKL.guithil_atka2
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 1.0 1.0 ;1.25 1.25
				AnimationBlendTime			= 0
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
;============================================CONTINUOUS FIRING VANILLA=============================	
;-------- Persistant firing (keep bow drawn ) ------------
		AnimationState					=	CONTINUOUS_FIRE_MEAN
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUFaramir_SKL.guithil_atka2
				AnimationMode			=	MANUAL
				UseWeaponTiming			= Yes	
				AnimationBlendTime			= 10
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
			EndScript
		End
		AnimationState                        = CONTINUOUS_FIRE_SLOW
            Animation                        = PutAwayArrow
                AnimationName                = GUFaramir_SKL.guithil_atka3
                AnimationMode                = ONCE
            End
        End
;============================================CONTINUOUS FIRING VANILLA=============================	
		;----------------------------
        ; AnimationState                    =    PREATTACK_A 
            ; StateName                    =    STATE_Firing
            ; Animation                    =    ReadyToDrawn
                ; AnimationName            =    GUFaramir_SKL.guithil_atka1
                ; AnimationMode            =    ONCE
            ; End
        ; End
        ; AnimationState                    =    FIRING_OR_RELOADING_A 
            ; StateName                    =    STATE_Firing
            ; Animation                    =    LooseReloadDraw
                ; AnimationName            =    GUFaramir_SKL.guithil_atka2
                ; AnimationMode            =    ONCE
                ; AnimationSpeedFactorRange = 1.1 1.1
            ; End
        ; End
        ; AnimationState                    =    CONTINUOUS_FIRE_MEAN
            ; Animation                    =    HangFrameWhileCoasting
                ; AnimationName            =    GUFaramir_SKL.guithil_atka2
                ; AnimationMode            =    MANUAL
            ; End
        ; End
        ; AnimationState                        = CONTINUOUS_FIRE_SLOW
            ; Animation                        = PutAwayArrow
                ; AnimationName                = GUFaramir_SKL.guithil_atka3
                ; AnimationMode                = ONCE
            ; End
        ; End
		AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
			Animation = Hit_Level_1_d
				AnimationName = GUFaramir_SKL.GUFaramir_HITD
				AnimationMode = ONCE
			End
		End
		AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
			Animation = Hit_Level_1_b
				AnimationName = GUFaramir_SKL.GUFaramir_HITB
				AnimationMode = ONCE
			End
		End
		AnimationState = HIT_REACTION
			Animation = Hit_Level_1_c
				AnimationName = GUFaramir_SKL.GUFaramir_HITC
				AnimationMode = ONCE
			End
		End
		
		AnimationState						= EMOTION_AFRAID WEAPONSTATE_CLOSE_RANGE
			ShareAnimation					= Yes
			StateName						= STATE_Sword
			Animation						= FearWithSword
				AnimationName				= GUFaramir_SKL.gufaramir_fear
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
			EndScript
		End
		AnimationState						= EMOTION_AFRAID
			ShareAnimation					= Yes
			StateName						= STATE_Bow
			Animation						= FERA
				AnimationName				= GUFaramir_SKL.gufaramir_fear
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		
		AnimationState				= LEVELED WEAPONSET_TOGGLE_1
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.gudundan_chra
				AnimationMode		= ONCE
			End
		End
		AnimationState				= LEVELED
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode		= ONCE
			End
			BeginScript
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		AnimationState				=	EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
			Animation
				AnimationName		=	GUFaramir_SKL.gudundan_chra
				AnimationMode		=	LOOP
			End
		End
		AnimationState				=	EMOTION_CELEBRATING
			Animation
				AnimationName		=	GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode		=	LOOP
			End
			BeginScript
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		AnimationState				=	EMOTION_TAUNTING WEAPONSET_TOGGLE_1
			Animation
				AnimationName		=	GUFaramir_SKL.GUFaramir_TNTD
				AnimationMode		=	ONCE
			End
			Animation
				AnimationName		=	GUFaramir_SKL.GUFaramir_TNTD
				AnimationMode		=	ONCE
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End
		AnimationState				=	EMOTION_TAUNTING
			Animation
				AnimationName		=	GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode		=	LOOP
			End
			BeginScript
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		AnimationState				=	PACKING_TYPE_1 WEAPONSET_TOGGLE_1
				Animation           =	DEFENDERSSPEAR
					AnimationName   =	GUFaramir_SKL.gudundan_chra
					AnimationMode   =	ONCE
				End
				;FXEvent	= Frame:10 Name:FX_GreyCompanyDefendersSelf
				BeginScript
				CurDrawableHideSubObject("arrow")
				; CurDrawableHideSubObject("bowhand")
				; CurDrawableHideSubObject("daggerhand")
				; CurDrawableShowSubObject("bowback")
				; CurDrawableHideSubObject("bow")
				; CurDrawableHideSubObject("swordsheath")
				; CurDrawableHideSubObject("andurilsheathed")
				; CurDrawableShowSubObject("sword")
				; CurDrawableShowSubObject("anduril")
				EndScript
			End
			
			AnimationState				=	PACKING_TYPE_1
				Animation           =	DEFENDERSBOW
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRD
					AnimationMode   =	ONCE
				End
				;FXEvent	= Frame:10 Name:FX_GreyCompanyDefendersSelf
				BeginScript
				; CurDrawableHideSubObject("spear")
				EndScript
			End		
		
		AnimationState					= SELECTED WEAPONSET_TOGGLE_1
			StateName					= STATE_Selected_Sword
			Animation					= ATNE
				AnimationName			= GUFaramir_SKL.gudundan_idlb
				AnimationMode			= LOOP
				AnimationBlendTime		= 15
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
			EndScript
		End
		AnimationState				=	EMOTION_ALERT WEAPONSET_TOGGLE_1
			StateName				=	STATE_READY
			Animation				=	ready
				AnimationName		=	GUFaramir_SKL.gudundan_idlat
				AnimationMode		=	LOOP
				AnimationBlendTime	=	20
			End
		End
		; AnimationState				=	RAISING_FLAG
			; Animation
				; AnimationName		=	GUFaramir_SKL.GUFaramir_CHRD
				; AnimationMode		=	LOOP
			; End
		
		; End
		AnimationState				=	SELECTED 
			StateName				=	STATE_Selected_Bow
			Animation				=	ATNB
				AnimationName		=	GUFaramir_SKL.GUFaramir_ATNB
				AnimationMode		=	LOOP
				AnimationBlendTime  = 15
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_Idle_Bow"	then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
				if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		AnimationState					= WEAPONSET_TOGGLE_1
			StateName					= STATE_Idle_Sword	
			Animation           		= IDLE
				AnimationName       	= GUFaramir_SKL.gudundan_atnb
				AnimationMode       	= LOOP
				AnimationPriority	    = 20
				AnimationBlendTime  = 15
			End
			Animation           		= IDLF
				AnimationName       	= GUFaramir_SKL.gudundan_atnb
				AnimationMode       	= LOOP
				AnimationPriority	    = 1
			End
			Animation           		= IDLG
				AnimationName       	= GUFaramir_SKL.gudundan_atnb
				AnimationMode       	= LOOP
				AnimationPriority	    = 1
			End
			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
			EndScript
		End
		IdleAnimationState
			StateName           = STATE_Idle_Bow
			Animation           = IdleBow
				AnimationName     = GUFaramir_SKL.GUMMandril_IDLA
				AnimationMode     = ONCE
				AnimationBlendTime  = 15
				AnimationPriority = 10
			End
			Animation           = IdleBow
				AnimationName     = GUFaramir_SKL.GUDUNDAN_IDLC
				AnimationMode     = ONCE
				AnimationPriority = 1
			End
			Flags							= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredBow") end
				; CurDrawableHideSubObject("spear")
			EndScript
		End
		TransitionState = TRANS_BoredToSelectedSword
			Animation = ANTD
				AnimationName		= GUFaramir_SKL.gudundan_atna
				AnimationMode				= ONCE_BACKWARDS
			End		
			Flags							= START_FRAME_LAST
		End
		TransitionState = TRANS_SelectedToBoredSword
			Animation			= ATNF
				AnimationName	= GUFaramir_SKL.gudundan_atna
				AnimationMode	= ONCE
			End		
		End	
		TransitionState = TRANS_BoredToSelectedBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.gummandril_atna
				AnimationMode		= ONCE
			End
			BeginScript
				CurDrawableHideSubObject("arrow")
				; CurDrawableHideSubObject("spear")
			EndScript				
		End
		TransitionState = TRANS_CaptainBowToSelectedBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.gummandril_atna
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
			End
			BeginScript
				CurDrawableHideSubObject("arrow")
				; CurDrawableHideSubObject("spear")
			EndScript			
		End
		TransitionState = TRANS_SelectedToBoredBow
			Animation			= ATNA
				AnimationName	= GUFaramir_SKL.gummandril_atnc
				AnimationMode	= ONCE
			End
			BeginScript
				CurDrawableHideSubObject("arrow")
				; CurDrawableHideSubObject("spear")
			EndScript				
		End	
		TransitionState       = TRANS_BowToSword
			Animation           = GUFaramir_STHA
				AnimationName     = GUFaramir_SKL.GUFaramir_STHA 
				AnimationMode     = ONCE
			End
		End
		TransitionState       = TRANS_SwordToBow
			Animation           = GUFaramir_STHB
				AnimationName     = GUFaramir_SKL.GUFaramir_STHB 
				AnimationMode     = ONCE
			End
		End	
		TransitionState       		= TRANS_BowToSword_Running
			Animation           	= DrawSwords
				AnimationName       = GUFaramir_SKL.GUFaramir_STHD
				AnimationMode       = ONCE
			End
		End
		TransitionState       		= TRANS_SwordToBow_Running
			Animation           	= DrawBow
				AnimationName       = GUFaramir_SKL.GUFaramir_STHC
				AnimationMode       = ONCE
			End
		End		
	End
    
	; ***DESIGN parameters ***
	Side                = Rivendell
	EditorSorting 	    = UNIT
	ThreatLevel 	      = 1.0
	ThingClass 		      = HORDE_UNIT
	CommandPoints 	    = 9 ; 4
	BountyValue 	      = DUN_GREY_COMPANY_BOUNTY_VALUE
	TransportSlotCount  = 1
	
	WeaponSet
		Conditions        = None
		Weapon            = PRIMARY    GreyCompanyBow
	End
	
	WeaponSet
		Conditions        = WEAPONSET_TOGGLE_1		
		Weapon            = PRIMARY    GreyCompanySword
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI		
	End
	
	ArmorSet
		Conditions        = None
		Armor             = GreyCompanyArmor
		DamageFX          = NormalDamageFX
	End

	VisionRange         = VISION_STANDARD_MELEE
	ShroudClearingRange = SHROUD_CLEAR_STANDARD

	DisplayName 	      = OBJECT:GreyCompanyRanger
	CrushableLevel 	    = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrushRevengeWeapon  = RangedInfantryCrushRevenge
	
	CommandSet          = GreyCompanyRangerCommandSet

	; *** AUDIO Parameters ***;
	VoiceAmbushed											= GreyCompanyRangerVoiceAmbushed
	VoiceAttack                     	= GreyCompanyRangerVoiceAttack
	VoiceAttackAir                    = GreyCompanyRangerVoiceAttack                
	VoiceAttackCharge                 = GreyCompanyRangerVoiceAttackCharge
	VoiceAttackMachine                = GreyCompanyRangerVoiceAttack
	VoiceAttackStructure              = GreyCompanyRangerVoiceAttackBuilding
	VoiceEnterStateAttack             = GreyCompanyRangerVoiceEnterStateAttack  
	VoiceEnterStateAttackCharge       = GreyCompanyRangerVoiceEnterStateAttackCharge
	VoiceEnterStateAttackMachine      = GreyCompanyRangerVoiceEnterStateAttack
	VoiceEnterStateAttackStructure    = GreyCompanyRangerVoiceEnterStateAttackBuilding
	VoiceCreated                      = GreyCompanyRangerVoiceSalute
	VoiceFullyCreated                 = GreyCompanyRangerVoiceSalute    
	VoiceGuard                        = GreyCompanyRangerVoiceMove
	VoiceMove                         = GreyCompanyRangerVoiceMove        
	VoiceMoveToCamp                   = GreyCompanyRangerVoiceMoveCamp
	VoiceMoveWhileAttacking           = GreyCompanyRangerVoiceMove
	VoiceEnterStateMove               = GreyCompanyRangerVoiceEnterStateMove
	VoiceEnterStateMoveToCamp         = GreyCompanyRangerVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking = GreyCompanyRangerVoiceEnterStateMove
	VoicePriority                     = 60
	VoiceRetreatToCastle              = GreyCompanyRangerVoiceRetreat
	VoiceEnterStateRetreatToCastle    = GreyCompanyRangerVoiceEnterStateRetreat
	VoiceSelect                       = GreyCompanyRangerVoiceSelect                ;GondorArcherVoiceSelect
	VoiceSelect2                      = YeomanArcherVoiceSelect2
	VoiceSelectBattle                 = GreyCompanyRangerVoiceSelectBattle            ;GondorArcherVoiceSelect ;GondorArcherVoiceSelectBattle

	SoundImpact					              = ImpactHorse

	UnitSpecificSounds
		VoiceGarrison			= GreyCompanyRangerVoiceMoveGarrison              
	End

	EvaEventDamagedOwner = UnitUnderAttack		;Eva event to trigger when unit is damaged

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU			; Tie into LargeGroupAudio system
		Key = Human Unit Infantry Ranger
	End

		ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:ArrowDrawBow					Animation:GUfaramir_SKL.GUfaramir_ATKA1	Frames:28
		AnimationSound = Sound:ArrowDrawBow					Animation:GUfaramir_SKL.GUfaramir_ATKa2	Frames:32
		AnimationSound = Sound:ArrowDrawBow					Animation:GUfaramir_SKL.GUfaramir_ATKC	Frames:40
		
		AnimationSound = Sound:SwordShingClean1ForHordes 		Animation:GUfaramir_SKL.GUfaramir_STHA 	Frames:24
		AnimationSound = Sound:SwordIntoScabbard1ForHordes		Animation:GUfaramir_SKL.GUfaramir_STHB 	Frames:15
		AnimationSound = Sound:SwordShingClean1ForHordes 		Animation:GUfaramir_SKL.GUfaramir_STHD 	Frames:11
		AnimationSound = Sound:SwordIntoScabbard1ForHordes 		Animation:GUfaramir_SKL.GUfaramir_STHC 	Frames:6
		
		AnimationSound = Sound:BodyFallGenericNoArmor			Animation:GUfaramir_SKL.GUfaramir_LNDA	Frames:15
		AnimationSound = Sound:BodyFallGenericNoArmor			Animation:GUfaramir_SKL.GUfaramir_LNDB	Frames:8

		AnimationSound = Sound:BodyFallGenericNoArmor			Animation:GUfaramir_SKL.GUfaramir_DIEA	Frames:134
		AnimationSound = Sound:BodyFallGenericNoArmor			Animation:GUfaramir_SKL.GUfaramir_DIEB	Frames:93
		AnimationSound = Sound:BodyFallGenericNoArmor			Animation:GUfaramir_SKL.GUfaramir_DIEB	Frames:58
	End


	; *** ENGINEERING Parameters ***
	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP SWARM_DOZER GRAB_AND_DROP DOZER ATTACK_NEEDS_LINE_OF_SIGHT ARCHER
	
	Body = ActiveBody ModuleTag_02
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = DUN_GREY_COMPANY_HEALTH                 ;BALANCE Ranger Health
		MaxHealthDamaged  = DUN_GREY_COMPANY_HEALTH_DAMAGED
		;RecoveryTime      = GONDOR_RANGER_HEALTH_RECOVERY_TIME
	End
	
	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
		StopChaseDistance = 562
		MoodAttackCheckRate        = 500
		HoldGroundCloseRangeDistance = 40
		CanAttackWhileContained    = Yes
		AILuaEventsList				=	GreyCompanyRangerFunctions
		MinCowerTime				=	4000
		MaxCowerTime				=	6000
		AttackPriority				= 	AttackPriority_Archer
	End
	
	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 1667 ; level 1 (light  damage)  hit reaction animations in ms
		HitReactionLifeTimer2 = 1667 ; level 2 (medium damage)  hit reaction animations in ms
		HitReactionLifeTimer3 = 1667 ; level 3 (heavy  damage)  hit reaction animations in ms

		HitReactionThreshold1 = 0.0   ; level 1 (light  damage) threshold trigger
		HitReactionThreshold2 = 25.0  ; level 2 (medium damage) threshold trigger
		HitReactionThreshold3 = 50.0  ; level 3 (heavy  damage) threshold trigger

		FastHitsResetReaction = Yes    ;If set -- when hits occur faster than the reaction animations, it will reset the animation. (like getting riddled with machine gun bullets)
	End

	Behavior                              = StealthUpdate StealthUpdateModuleTag
		StealthDelay						            = 2500         ; msec
		FriendlyOpacityMin					        = STEALTH_FRIENDLY_OPACITY_MIN
		FriendlyOpacityMax					        = STEALTH_FRIENDLY_OPACITY_MAX
		PulseFrequency						          = 750   ; msec
		StealthForbiddenConditions			    = HORDEBRAIN_NOT_STEALTHED
		OrderIdleEnemiesToAttackMeUponReveal= Yes
		DetectedByAnyoneRange				        = 120
		RevealWeaponSets					          = CLOSE_RANGE CONTESTING_BUILDING
		VoiceMoveToStealthyArea				      = GreyCompanyRangerVoiceMove
		VoiceEnterStateMoveToStealthyArea	  = GreyCompanyRangerVoiceEnterStateMove
	End
	
	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = 50 ; NORMAL_GOOD_INFANTRY_MEMBER_SPEED	
	End

	LocomotorSet
		Locomotor = HumanWanderLocomotor
		Condition = SET_WANDER
		Speed     = 50 ; NORMAL_GOOD_INFANTRY_MEMBER_SPEED	
	End


	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
	End
	
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End
	
	Behavior = HordeMemberCollide ModuleTag_HMC
		;nothing
	End
	
	Behavior = SlowDeathBehavior ModuleTag_KnockDeath
        DeathTypes = ALL -FADED +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 1.0     ; in Dist/Sec
        DestructionDelay = 15000
    End
	
	Behavior = SlowDeathBehavior ModuleTag_RegularDeath
        DeathTypes = ALL -FADED
        SinkDelay = 3000
        SinkRate = 1.0     ; in Dist/Sec
        DestructionDelay = 15000
        Sound = INITIAL GreyCompanyRangerVoiceDie
    End
    
    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 8000
        DestructionDelay = 8000
        FX = INITIAL FX_UnSummonElvenAllies
    End
	
	Behavior = CreateObjectDie ModuleTag_07
		DeathTypes = ALL -FADED
		CreationList = OCL_GreyCompanyRangerDieBuffEgg
	End
	
	Behavior = BezierProjectileBehavior ModuleTag_08 ; Module starts asleep, and wakes up when thrown.
		; To tweak a Bezier path
		FirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
		SecondHeight = 24
		FirstPercentIndent = 30% ; Percentage of shot distance control points are placed
		SecondPercentIndent = 70%
		TumbleRandomly = Yes

		CrushStyle = Yes ; I don't detonate, I just hit
		DieOnImpact = Yes
		BounceCount = 1   ; When I hit the ground, I'll arc again
		BounceDistance = 40 ; this far
		BounceFirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
		BounceSecondHeight = 24
		BounceFirstPercentIndent = 20% ; Percentage of shot distance control points are placed
		BounceSecondPercentIndent = 80%

		GroundHitFX       = FX_ThrownRockGroundHit
		GroundBounceFX    = FX_ThrownRockBounceHit
	End
	
	; -- Elvish Medicine
	Behavior                              = AutoHealBehavior ModuleTag_HealHordeMembers
		StartsActive			                  = No
		HealOnlyIfNotInCombat 		          = Yes				
		HealOnlyIfNotUnderAttack	          = Yes				
		TriggeredBy			                    = Upgrade_TechnologyRivendellMedicine
		HealingAmount		                    = 1
		HealingDelay		                    = 2000
		KindOf				                      = INFANTRY CAVALRY
		UnitHealPulseFX			                = FX_SpellHealUnitHealBuff
	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 19;
  ShadowSizeY = 19;
  ShadowTexture = ShadowI;
End

; ----------------------------------------------------------------------------------------------
ChildObject GreyCompanyRanger_Summoned GreyCompanyRanger
    IsTrainable = No
    CommandPoints = 0
    EquivalentTo = GreyCompanyRanger
    
    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
    ; This one does the work, but the one in the horde displays the timer
        MinLifetime        = 75000 ; 180000
        MaxLifetime        = 75000 ; 180000
        DeathType        = FADED
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        AILuaEventsList               = GreyCompanyRangerFunctions
        AttackPriority                = AttackPriority_Cavalry
    End
    
End
; ----------------------------------------------------------------------------------------------
Object SummonGreyCompanyEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE
    
    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay = 2000
        OCL = FINAL OCL_SpawnGreyCompany
    End
End
; ----------------------------------------------------------------------------------------------
Object GreyCompanyRangerDieBuffEgg

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
		
	End

	KindOf = IMMOBILE UNATTACKABLE

	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End

	Behavior = AIUpdateInterface ModuleTag_03
		AILuaEventsList = TwinsDeathEggFunctions
	End

	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 30000
		MaxLifetime = 30000
	End

	Behavior = SpecialPowerModule ModuleTag_GrimResolveBonus
        SpecialPowerTemplate    	  = SpecialAbilityWargHowl
        AttributeModifier           = GreyCompanyRangerDieBuff
        AttributeModifierRange      = 99999999
        AttributeModifierAffects    = NONE +GreyCompanyRanger +GreyCompanyRangerHorde
				;AttributeModifierFX 	 	    = FX_ElladanBrotherDeath
        TargetEnemy 				        = No
        AffectAllies                = No
			 InitiateSound             	  = GreyCompanyRangerVoiceGrimResolveDie
    End

End
