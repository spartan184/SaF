Object RivendellRangerCaptain
		Scale = 1.01
		SelectPortrait         = Uirivdunedain
		
		Draw = W3DHordeModelDraw ModuleTag_01
			;RandomTexture = augreycaptain1.tga 0 augreycaptain1.tga
			;RandomTexture = augreycaptain2.tga 0 augreycaptain1.tga
			;RandomTexture = augreycaptain3.tga 0 augreycaptain1.tga
			;RandomTexture = augreycaptain4.tga 0 augreycaptain1.tga
		
		DefaultModelConditionState
			Model               = gugreycapt_skn
			WeaponLaunchBone    = PRIMARY arrow
		End


		ModelConditionState COMING_OUT_OF_FACTORY
			Model = GUBanner_SKN
			Skeleton = GUBanner_SKL
		End
; --- Flying through the air.
		AnimationState        = STUNNED_FLAILING 
			StateName           = STATE_Sword
			Animation           = GUFaramir_FLYB
				AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode     = LOOP
			End
			Flags               = RANDOMSTART
		End
		
; --- Dying anims
		AnimationState        = DYING SPLATTED 
			StateName           = STATE_Sword
			Animation           = GUFaramir_LNDB
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode     = ONCE
			End
		End
		
		AnimationState        = DYING 
			StateName           = STATE_Sword

			Animation           = GUFaramir_DIEA
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
				AnimationMode     = ONCE
			End
			
			Animation           = GUFaramir_DIEB
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
				AnimationMode     = ONCE
			End
		End
		
; --- Stunned anims
		AnimationState        = STUNNED_STANDING_UP 
			StateName           = STATE_Sword
			Animation           = GUFaramir_GTPB
				AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End
		
		AnimationState        = STUNNED 
			StateName           = STATE_Sword
			
			Animation           = GUFaramir_LNDB
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode     = ONCE
			End
		End

		
;;------------------ ATTACKING SWORD --------------------------------------------------------------------
		AnimationState        = MOVING FIRING_OR_PREATTACK_A
			Animation           = TrotAndFire
				AnimationName       = GUFaramir_SKL.GUFaramir_ATRA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART
			StateName = RunAndSwing
		End
		
		AnimationState        = FIRING_OR_PREATTACK_A 
			StateName           = STATE_Sword
			
			Animation           = ATKA
				AnimationName     = GUFaramir_SKL.GUMithilrS_ATKA
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			
			Animation           = ATKB
				AnimationName    = GUFaramir_SKL.GUMithilrS_ATKB
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			
			Animation           = ATKC
				AnimationName    = GUFaramir_SKL.GUMithilrS_ATKC
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
		End

;;------------------ MOVING -------------------------------------------------------------
		;--- Running with sword
		AnimationState			= MOVING 	
			StateName           = STATE_RunningSword
			Flags               = RANDOMSTART
			
			Animation           = GUFaramir_RUNB
				AnimationName   = GUFaramir_SKL.GUFaramir_RUNB
				AnimationSpeedFactorRange = 0.85 0.85
				Distance		= 28
			End
		End

;;-------------------- HIT REACTIONS -----------------------------------------------------------
; this hit animation attack stance
		AnimationState = EMOTION_ALERT HIT_REACTION 
			Animation = Hit_Level_1_d
				AnimationName = GUFaramir_SKL.GUFaramir_HITD
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION 
			Animation = Hit_Level_1_b
				AnimationName = GUFaramir_SKL.GUFaramir_HITB
				AnimationMode = ONCE
			End
		End

;;------------ EMOTIONS ------------------------------------------------------------------		
;;====== LEVELED
		AnimationState				= LEVELED 	
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRC
				AnimationMode		= ONCE
			End
		End

;;====== CELEBRATING	

	AnimationState				=	EMOTION_CELEBRATING 
				Animation           =	CHRC
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRc
					AnimationMode   =	ONCE
					AnimationPriority	=	10
				End
				Animation           =	CHRD
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRD
					AnimationMode   =	ONCE
					AnimationPriority	=	5
				End
				Flags				=	RESTART_ANIM_WHEN_COMPLETE		
			End
		
;;------------------- SELECTED STATES ------------------------------------------------------------

		AnimationState					= SELECTED 
			StateName					= STATE_Selected_Sword
			
			Animation					= ATNE
				AnimationName			= GUFaramir_SKL.GUFaramir_ATNE
				AnimationMode			= LOOP
				AnimationBlendTime		= 15
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
			EndScript
		End
		
		AnimationState				=	EMOTION_ALERT 
			StateName				=	STATE_READY
			Animation				=	ready
				AnimationName		=	GUFaramir_SKL.GUMithilrS_IDLA
				AnimationMode		=	LOOP
				AnimationBlendTime	=	20
			End
		End
		
;;--------------- IDLE STATES -----------------------------------------------------------------	
		
		IdleAnimationState
			StateName					= STATE_Idle_Sword	

			Animation           		= IDLE
				AnimationName       	= GUFaramir_SKL.GUFaramir_IDLE
				AnimationMode       	= LOOP
				AnimationPriority	    = 20
				AnimationBlendTime  = 15
			End
			
			Animation           		= IDLF
				AnimationName       	= GUFaramir_SKL.GUFaramir_IDLF
				AnimationMode       	= LOOP
				AnimationPriority	    = 1
			End

			Animation           		= IDLG
				AnimationName       	= GUFaramir_SKL.GUFaramir_IDLG
				AnimationMode       	= LOOP
				AnimationPriority	    = 1
			End
			
			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
			EndScript
		End
		
;;--------------- TRANSITION STATES -----------------------------------------------------------------	

		TransitionState = TRANS_BoredToSelectedSword
			Animation = ANTD
				AnimationName		= GUFaramir_SKL.GUFaramir_ANTD
				AnimationMode		= ONCE
			End		
		End
		
		TransitionState = TRANS_SelectedToBoredSword
			Animation			= ATNF
				AnimationName	= GUFaramir_SKL.GUFaramir_ATNF
				AnimationMode	= ONCE
			End		
		End	

	End
	
	; *** DESIGN Parameters *** ;
  Side                  = Rivendell
	EditorSorting         = UNIT
	ThreatLevel           = 1.0
	ThingClass            = HORDE_UNIT
	CommandPoints         = 0
	TransportSlotCount    = 1
	
	WeaponSet
			Conditions        = None 
			Weapon            = PRIMARY    GondorSword
			AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	
	ArmorSet
			Conditions        = None
			Armor             = NoArmor
			DamageFX          = NormalDamageFX
	End
	
	VisionRange           = M_VISION_STANDARD_MELEE
	ShroudClearingRange   = M_SHROUD_CLEAR_STANDARD
	DisplayName           = OBJECT:GondorBanner
	CrusherLevel          = 0
	CrushableLevel        = 0
	MountedCrusherLevel   = 1
	MountedCrushableLevel = 3
	CrushRevengeWeapon    = BasicInfantryCrushRevenge
	CrushWeapon           = KnightCrush
	BuildCost             = M_GONDOR_BANNER_BUILDCOST
	BuildTime             = M_GONDOR_BANNER_BUILDTIME
	BountyValue           = M_GONDOR_BANNER_BOUNTY_VALUE
	CommandSet            = GondorBannerCommandSet
	
	VoiceAmbushed                				= GondorSoldierVoiceAmbushed
	VoiceAttack								          = DunedainRangerVoiceAttackSword
	VoiceAttackAir							        = DunedainRangerVoiceAttackSword				
	VoiceAttackCharge						        = DunedainRangerVoiceAttackCharge
	VoiceAttackMachine						      = DunedainRangerVoiceAttackSword
	VoiceAttackStructure					      = DunedainRangerVoiceAttackBuilding
	VoiceCreated							          = DunedainRangerVoiceSalute
	VoiceFullyCreated 						      = DunedainRangerVoiceSalute		
	VoiceGuard								          = DunedainRangerVoiceMove
	VoiceMove								            = DunedainRangerVoiceMove		
	VoiceMoveToCamp							        = DunedainRangerVoiceMoveCamp
	VoiceMoveWhileAttacking					    = DunedainRangerVoiceDisengage
	VoicePriority							          = 29 ; Made lower to allow hobbit voices to remain prominent
	VoiceRetreatToCastle					      = DunedainRangerVoiceRetreat
	VoiceSelect								          = DunedainRangerVoiceSelect
	VoiceSelectBattle 						      = DunedainRangerVoiceSelectBattle

	VoiceEnterStateAttack					      = DunedainRangerVoiceEnterStateAttackSword	
	VoiceEnterStateAttackCharge				  = DunedainRangerVoiceEnterStateAttackCharge
	VoiceEnterStateAttackMachine			  = DunedainRangerVoiceEnterStateAttackSword
	VoiceEnterStateAttackStructure			= DunedainRangerVoiceEnterStateAttackBuilding
	VoiceEnterStateMove						      = DunedainRangerVoiceEnterStateMove
	VoiceEnterStateMoveToCamp				    = DunedainRangerVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking		= DunedainRangerVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle			= DunedainRangerVoiceEnterStateRetreat

	SoundImpact								          = ImpactHorse
	EvaEventDamagedOwner                = UnitUnderAttack
	
	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
			Key = Human Unit Infantry Gondor_Soldier
	End
	
	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL
	
	Body                                       = ActiveBody ModuleTag_02
			CheerRadius                            = M_EMOTION_CHEER_RADIUS
			MaxHealth                              = M_GONDOR_BANNER_HEALTH
			MaxHealthDamaged                       = M_GONDOR_BANNER_HEALTH_DAMAGED
	End
	
	Behavior                                   = AIUpdateInterface ModuleTag_03
			AutoAcquireEnemiesWhenIdle             = Yes ATTACK_BUILDINGS STEALTHED
			MoodAttackCheckRate                    = 500
			AttackPriority                         =     AttackPriority_Infantry
			AILuaEventsList                        =    GondorFighterFunctions
	End
	
	Behavior                                   = EmotionTrackerUpdate    Module_EmotionTracker
			TauntAndPointDistance                  =    M_INFANTRY_TAUNT_POINT_RADIUS
			TauntAndPointUpdateDelay               =    1000
			TauntAndPointExcluded                  =    NONE
			AfraidOf                               =    NONE +RohanTreeBerd +GondorGwaihir +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorMumakil
			AlwaysAfraidOf                         =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
			PointAt                                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
			HeroScanDistance                       =    150
			FearScanDistance                       =    M_INFANTRY_FEAR_SCAN_RADIUS
			AddEmotion                             =    Terror_Base
			AddEmotion                             =    Doom_Base
			AddEmotion                             =    UncontrollableFear_Base_Evil
			AddEmotion                             =    FearIdle_Base
			AddEmotion                             =    FearBusy_Base
			AddEmotion                             =    Point_Base
			AddEmotion                             =    Taunt_Base    
			AddEmotion                             =    CheerIdle_Base
			AddEmotion                             =    CheerBusy_Base
			AddEmotion                             =    HeroCheerIdle_Base
			AddEmotion                             =    HeroCheerBusy_Base
			AddEmotion                             =    Alert_Base
	End    
	
	LocomotorSet
			Locomotor                              = HumanLocomotor
			Condition                              = SET_NORMAL 
			Speed                                  = M_NORMAL_GOOD_INFANTRY_MEMBER_SPEED    
	End
	
	LocomotorSet
			Locomotor                              = HumanWanderLocomotor
			Condition                              = SET_WANDER 
			Speed                                  = M_NORMAL_GOOD_INFANTRY_MEMBER_SPEED    
	End
	
	Behavior                                   = SquishCollide ModuleTag_06
	End	
	
	Behavior                                   = PhysicsBehavior ModuleTag_04
			GravityMult                            = 1.0
			ShockStunnedTimeLow                    = 1400
			ShockStunnedTimeHigh                   = 2400
			ShockStandingTime                      = 666
	End
	
	Behavior                                   = SlowDeathBehavior ModuleTag_05
			DeathTypes                             = ALL -KNOCKBACK
			SinkDelay                              = 3000
			SinkRate                               = 0.40
			DestructionDelay                       = 8000
			Sound                                  = INITIAL GondorBannerVoiceDie    
	End
	
	Behavior                                   = SlowDeathBehavior ModuleTag_07
			DeathTypes                             = NONE +KNOCKBACK
			SinkDelay                              = 3000
			SinkRate                               = 0.40
			DestructionDelay                       = 8000
	End
	
	Behavior                                   = BezierProjectileBehavior ModuleTag_08
			FirstHeight                            = 24
			SecondHeight                           = 24
			FirstPercentIndent                     = 30%
			SecondPercentIndent                    = 70%
			TumbleRandomly                         = Yes
			CrushStyle                             = Yes
			DieOnImpact                            = Yes
			BounceCount                            = 1
			BounceDistance                         = 40
			BounceFirstHeight                      = 24
			BounceSecondHeight                     = 24
			BounceFirstPercentIndent               = 20%
			BounceSecondPercentIndent              = 80%
			GroundHitFX                            = FX_ThrownRockGroundHit
			GroundBounceFX                         = FX_ThrownRockBounceHit
	End
	
	Behavior                                   = HitReactionBehavior HitReactionBehaviorModuleTag
			HitReactionLifeTimer1                  = 7
			HitReactionLifeTimer2                  = 15
			HitReactionLifeTimer3                  = 10
			HitReactionThreshold1                  = 0.0
			HitReactionThreshold2                  = 25.0
			HitReactionThreshold3                  = 50.0
	End
	
	
	Behavior                                   = CombineHordeSpecialPower ModuleTag_CombineWithNearest
			SpecialPowerTemplate                   = SpecialAbilityCombineWithNearest
			InitiateSound                          = GondorBannerVoiceJoin
			ScanRange                              = 15000.0
	End
	
	Behavior                                   = BannerCarrierUpdate BannerCarrierUpdateModuleTag
			IdleSpawnRate                          = 10000
			MeleeFreeUnitSpawnTime                 = 20000
			DiedRespawnTime                        = 10000
			MeleeFreeBannerReSpawnTime             = 20000
			BannerMorphFX        	                 = FX_HordeResurrection
			UnitSpawnFX                            = FX_HordeResurrection
	End
	
	Behavior                                   = StealthUpdate StealthUpdateModuleTag
			StealthDelay                           = 2500
			FriendlyOpacityMin                     = M_STEALTH_FRIENDLY_OPACITY_MIN
			FriendlyOpacityMax                     = M_STEALTH_FRIENDLY_OPACITY_MAX
			PulseFrequency                         = 750
			StealthForbiddenConditions             = HORDEBRAIN_NOT_STEALTHED
			OrderIdleEnemiesToAttackMeUponReveal   = Yes
			DetectedByAnyoneRange                  = 120
			RevealWeaponSets                       = CLOSE_RANGE CONTESTING_BUILDING
			VoiceMoveToStealthyArea                = RangerVoiceMoveTrees
			VoiceEnterStateMoveToStealthyArea      = RangerVoiceEnterStateMoveTrees
	End
	
	; -- Elvish Medicine
	Behavior                                   = AutoHealBehavior ModuleTag_HealHordeMembers
		StartsActive			                       = No
		HealOnlyIfNotInCombat 		               = Yes				
		HealOnlyIfNotUnderAttack	               = Yes				
		TriggeredBy			                         = Upgrade_TechnologyRivendellMedicine
		HealingAmount		                         = 1
		HealingDelay		                         = 2000
		KindOf				                           = INFANTRY CAVALRY
		UnitHealPulseFX			                     = FX_SpellHealUnitHealBuff
	End	

	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 19
  ShadowSizeY = 19
  ShadowTexture = ShadowI
End
