;------------------------------------------------------------------------------
; Rohirrim
Object RivendellKnight
	; *** ART Parameters ***
	; NOTE: If you are updating any of the art parameters, you should really check
	; GondorCavalryRiderless in FactionSubObject.ini and see if it needs to be updated

	UpgradeCameo1	                     = Upgrade_FireArrows
	SelectPortrait	                   = uprivelfknight
	ButtonImage	                       = uirivelfknight

	Draw                               = W3DHordeModelDraw ModuleTag_01
	  OkToChangeModelColor             = Yes
		StaticModelLODMode               = No
		WadingParticleSys                = WaterRipplesTrail  ; used when the unit is wading in shallow water.
		ParticlesAttachedToAnimatedBones = yes
		
		; -------------------- MODELS --------------------
		; ---------- Spear 
		DefaultModelConditionState
			Model				= eulancer_skn
		End

		; ---------- With HA Upgrade  
		ModelConditionState				= RIDER2
			Model						= eulancer_sknh
		End
		
		; -------------------- Animations --------------------
		IdleAnimationState
				StateName                =    Idle
				Animation                =    IdleB
						AnimationName        =    RURohrm_SKL.RURohrm_IDLB
						AnimationMode        =    ONCE
						AnimationBlendTime    =    15
				End
				BeginScript
						Prev = CurDrawablePrevAnimationState()
						if Prev == "State_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
				EndScript
		End
						
		AnimationState                =    PASSENGER
				Animation                =    grabbed
						AnimationName        =    RURohrm_SKL.RURohrm_GBDA
						AnimationMode        =    LOOP
				End
		End
		
		; --- stunned anims
		AnimationState                =    FREEFALL 
				Animation                =    free fall
						AnimationName        =    RURohrm_SKL.RURohrm_FLYB
						AnimationMode        =    LOOP
						AnimationBlendTime    =    10
				End
		End
		
		AnimationState                =    STUNNED_FLAILING 
				Animation                =    JustDie
						AnimationName        =    RURohrm_SKL.RURohrm_FLYC
						AnimationMode        =    LOOP
				End
				Flags                    =    RANDOMSTART
		End

		; This is the no-spawn-horse type of death
		AnimationState                =    DYING DEATH_1 SPLATTED
				Animation                =    splatted
						AnimationName        =    RURohrm_SKL.RURohrm_LNDA
						AnimationMode        =    ONCE
						AnimationBlendTime  =   2
				End
				FXEvent    = Frame:2 Name:FX_SplatDust
		End
		
		

		AnimationState                =    DYING DEATH_1 
				Animation                =    JustDie
						AnimationName        =    RURohrm_SKL.RURohrm_DIEA
						AnimationMode        =    ONCE
				End
		End
		
		AnimationState                =    DYING DEATH_2 
				Animation                =    FadeOut
						AnimationName        =    RURohrm_SKL.RURohrm_IDLB
						AnimationMode        =    ONCE
				End
		End
		
		AnimationState                =    STUNNED_STANDING_UP
				Animation                =    StandUp
						AnimationName        =    RURohrm_SKL.RURohrm_GTPA
						AnimationMode        =    ONCE
						AnimationSpeedFactorRange = 1.5 1.5
				End
		End
		
		AnimationState                =    STUNNED
				Animation                =    Land
						AnimationName        =    RURohrm_SKL.RURohrm_LNDA
						AnimationMode        =    ONCE
				End
		End
		
		
						
		AnimationState        = MOVING FIRING_OR_PREATTACK_A
				ShareAnimation        = Yes
				Animation           = TrotAndFire
						AnimationName       = RURohrm_SKL.RURohrm_ATRB
						AnimationMode       = LOOP
						Distance            = 70; 35
				End
				Flags               = RANDOMSTART
		End

;;======= BACKING UP
		
		AnimationState                    = MOVING BACKING_UP
				Animation                    = BACKING UP
						AnimationName            = RURohrm_SKL.RURohrm_BAKA
						AnimationMode            = LOOP
				End
		End
		
		AnimationState                    =    TURN_LEFT_HIGH_SPEED
				Animation                    =    TurnLeft
						AnimationName            =    RURohrm_SKL.RURohrm_TNL1
						AnimationMode            =    LOOP
						AnimationBlendTime        =    20
				End
		End
		
		AnimationState                    =    TURN_RIGHT_HIGH_SPEED
				Animation                    =    TurnRight
						AnimationName            =    RURohrm_SKL.RURohrm_TNR1
						AnimationMode            =    LOOP
						AnimationBlendTime        =    20
				End
		End
		
		AnimationState                    = MOVING WANDER
				Animation                    = WLKA
						AnimationName            = RURohrm_SKL.RURohrm_WLKA
						AnimationMode            = LOOP
				End
		End

		AnimationState                    =    MOVING TURN_LEFT 
				Animation                    =    TurnLeft
						AnimationName            =    RURohrm_SKL.RURohrm_TRNL
						AnimationMode            =    LOOP
				End
		End

		AnimationState                    =    MOVING TURN_RIGHT 
				Animation                    =    TurnRight
						AnimationName            =    RURohrm_SKL.RURohrm_TRNR
						AnimationMode            =    LOOP
				End
		End

		AnimationState                    = MOVING ENGAGED
				Animation                    = Moving_Engaged
						AnimationName            = RURohrm_SKL.RURohrm_RUNC
						AnimationMode            = LOOP
				End
				Flags                        = RANDOMSTART
		End
		
;        AnimationState                    = MOVING WALKING
;            Animation                    = Walk1
;                AnimationName            = RURohrm_SKL.RURohrm_WLKB
;                AnimationMode            = LOOP
;                Distance                = 25
;            End
;        End

		AnimationState                    = MOVING USING_COMBO_LOCOMOTOR
				Animation                    = Walk1
						AnimationName            = RURohrm_SKL.RURohrm_WLKB
						AnimationMode            = LOOP
						Distance                = 25
				End
		End

		AnimationState                    = MOVING ACCELERATE
				Animation                    = Accelerate
						AnimationName            = RURohrm_SKL.RURohrm_ACCL
						AnimationMode            = ONCE ; was LOOP
				End
		End

		AnimationState                    = MOVING DECELERATE
				Animation                    = Decelerate
						AnimationName            = RURohrm_SKL.RURohrm_DECL
						AnimationMode            = ONCE
				End
		End
				
		AnimationState                    =    MOVING
				Animation                    =    RunA
						AnimationName            =    RURohrm_SKL.RURohrm_RUNA
						AnimationMode            =    LOOP
						Distance                =   40
				End
				Flags                        =    RANDOMSTART
		End


		;---------------------------------------------------------------------------------------------------------

		; Standard attack with spear.
		AnimationState                    =    FIRING_OR_PREATTACK_A
				Animation                    =    AttackA1
						AnimationName            =    RURohrm_SKL.RURohrm_ATKA
						AnimationMode            =    ONCE
				End
				ParticleSysBone     = None MeleeDust
		End
		;---------------------------------------------------------------------------------------------------------
		

;;--------------------- EMOTIONS ----------------------------------------------------------------------------------
;;===== TERROR        
		AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
				Animation                    = TerrorFromTheSky
						AnimationName            = RURohrm_SKL.RURohrm_RUNB
						AnimationMode            = LOOP
				End
		End
		
		AnimationState                    = MOVING EMOTION_TERROR
				Animation                    = TerrorFromTheSky
						AnimationName            = RURohrm_SKL.RURohrm_RUNB
						AnimationMode            = LOOP
				End
		End
		
;;======= APPREHENSIVE

		AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID
				Animation                    =    Apprehensive
						AnimationName            =    RURohrm_SKL.RURohrm_APPA
						AnimationMode            =    LOOP    ;Change this to ONCE if adding additional anims
				End
		End

;;======= AFRAID

		AnimationState                    = EMOTION_AFRAID
				Animation                    = FERA
						AnimationName            = RURohrm_SKL.RURohrm_FERA
						AnimationMode            = LOOP
				End
				;Animation                    = FERB
				;    AnimationName            = RURohrm_SKL.RURohrm_FERB
				;    AnimationMode            = LOOP
				;End
		End

;;======= CELEBRATING
		
		AnimationState                    =    EMOTION_CELEBRATING
				Animation                    =    CheerA
						AnimationName            =    RURohrm_SKL.RURohrm_CHRA
						AnimationMode            =    ONCE
				End
				Animation                    =    CheerB
						AnimationName            =    RURohrm_SKL.RURohrm_CHRB
						AnimationMode            =    ONCE
				End
				Animation                    =    CheerC
						AnimationName            =    RURohrm_SKL.RURohrm_CHRC
						AnimationMode            =    ONCE
				End
				Animation                    =    CheerD
						AnimationName            =    RURohrm_SKL.RURohrm_CHRD
						AnimationMode            =    ONCE
				End
				Animation                    =    Salute
						AnimationName            =    RURohrm_SKL.RURohrm_SLTA
						AnimationMode            =    ONCE
				End
				Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End

;;======= TAUNTING
				
		AnimationState                    = EMOTION_TAUNTING
				Animation                    = Taunting
						AnimationName            = RURohrm_SKL.RURohrm_TNTA
						AnimationMode            = ONCE
				End
				Animation                    = Taunting2
						AnimationName            = RURohrm_SKL.RURohrm_TNTB
						AnimationMode            = ONCE
				End
				Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End

;;======= POINTING
				
		AnimationState                    = EMOTION_POINTING
				Animation                    = Pointing1
						AnimationName            = RURohrm_SKL.RURohrm_PNTA
						AnimationMode            = LOOP
				End
		End
		
;;======== ALERT

		AnimationState                    = EMOTION_ALERT
				Animation                    = IDLA
						AnimationName            = RURohrm_SKL.RURohrm_IDLA
						AnimationMode            = LOOP
				End
		End
		
;;-------------------- SELECTED ---------------------------------------------------------------
						
		AnimationState                    = SELECTED
				StateName                    = State_Selected
				SimilarRestart                = Yes
				Animation                    = AtAttention
						AnimationName            = RURohrm_SKL.RURohrm_IDLA    
						AnimationMode            = LOOP
				End
				BeginScript
						Prev = CurDrawablePrevAnimationState()
						if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
				EndScript
		End
		
		
		TransitionState                    =    TRANS_Idle_to_Selected
				Animation                    =    ATNA
						AnimationName            =    RURohrm_SKL.RURohrm_ATNA
						AnimationMode            =    ONCE
						AnimationSpeedFactorRange = 0.6 1.0
				End
		End
		
		
		TransitionState                    =    TRANS_Selected_to_Idle
				Animation                    =    ATNC
						AnimationName            =    RURohrm_SKL.RURohrm_ATNA
						AnimationMode            =    ONCE_BACKWARDS
						AnimationSpeedFactorRange = 0.6 1.0
				End
				Flags                        = START_FRAME_LAST
		End
			
			
	End
	
	Draw = W3DScriptedModelDraw DustEffects
			DefaultModelConditionState
				Model = None
			End
			IdleAnimationState
			End
			AnimationState = MOVING WADING
					ParticleSysBone = None FootstepSlash
			End
			AnimationState = MOVING ACCELERATE
					ParticleSysBone = None GenericSiegeTrailDust
			End
			AnimationState = MOVING DECELERATE
					ParticleSysBone = None GenericSiegeTrailDust
			End
			AnimationState = MOVING
					ParticleSysBone = None GenericSiegeTrailDust
			End
	End

		; ***DESIGN parameters ***
		Side                     = Rivendell
		EditorSorting            = UNIT
		ThreatLevel              = 1.0
		TransportSlotCount       = 1
		BountyValue              = M_GONDOR_KNIGHT_BOUNTY_VALUE

		ArmorSet
			Conditions             = None
			Armor                  = CavalryHorseShieldArmor
			DamageFX               = NormalDamageFX
		End

		ArmorSet
			Conditions             = PLAYER_UPGRADE
			Armor                  = CavalryHorseShieldAndHeavyArmor
			DamageFX               = NormalDamageFX
		End

		WeaponSet
			Conditions             = None 
			Weapon                 = PRIMARY GondorCavalrySword
			AutoChooseSources      = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		End

		WeaponSet
			Conditions             = PLAYER_UPGRADE
			Weapon                 = PRIMARY GondorCavalrySwordUpgraded
			AutoChooseSources      = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		End

		VisionRange              = M_VISION_STANDARD_HORSE
		ShroudClearingRange      = M_SHROUD_CLEAR_STANDARD
		DisplayName              = OBJECT:RivendellKnight
		CrushableLevel           = 3
		CrusherLevel             = 1
		CrushWeapon              = KnightCrush
		MinCrushVelocityPercent  = 50
		CrushDecelerationPercent = 20
		RamPower                 = 30
		RamZMult                 = 0.5
		CommandPoints            = 4
		CommandSet               = RivendellElfKnightCommandSet
    
		; *** AUDIO Parameters *** ;
		VoiceAttack								          = RivendellElfKnightVoiceAttack
		VoiceAttackCharge						        = RivendellElfVoiceAttackCharge
		VoiceAttackStructure 					      = RivendellElfVoiceAttackBuilding
		VoiceAttackMachine						      = RivendellElfKnightVoiceAttack
		VoiceCreated							          = RivendellElfKnightVoiceSalute
		VoiceFullyCreated						        = RivendellElfKnightVoiceSalute
		VoiceGuard								          = RivendellElfVoiceMove
		VoiceMove								            = RivendellElfVoiceMove
		VoiceMoveToCamp 						        = RivendellElfVoiceMoveCamp
		VoiceMoveWhileAttacking					    = RivendellElfVoiceDisengage
		VoicePriority							          = 53	
		VoiceRetreatToCastle 					      = RivendellElfVoiceRetreat
		VoiceSelect								          = RivendellElfVoiceSelect
		VoiceSelectBattle						        = RivendellElfVoiceSelectBattle
		SoundCrushing							          = RohirrimCrushing 		;Sound made when crushing another unit underhoof
		SoundImpact 							          = ImpactHorse
		SoundMoveStart 							        = GondorHorseMoveStart
		VoiceEnterStateAttack 					    = RivendellElfKnightVoiceEnterStateAttack
		VoiceEnterStateAttackCharge 			  = RivendellElfVoiceEnterStateAttackCharge
		VoiceEnterStateAttackStructure	 		= RivendellElfVoiceEnterStateAttackBuilding
		VoiceEnterStateAttackMachine 			  = RivendellElfVoiceEnterStateAttackBuilding
		VoiceEnterStateMove 					      = RivendellElfVoiceEnterStateMove
		VoiceEnterStateMoveToCamp 				  = RivendellElfVoiceEnterStateMoveCamp
		VoiceEnterStateMoveWhileAttacking		= RivendellElfVoiceEnterStateDisengage
		VoiceEnterStateRetreatToCastle	 		= RivendellElfVoiceEnterStateRetreat

		EvaEventDamagedOwner                = UnitUnderAttack

		Behavior                            = LargeGroupAudioUpdate ModuleTag_LGAU
			Key                               = Human Unit Cavalry Knight
		End   
		
		ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
			MaxUpdateRangeCap = 800
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_ACCL	Frames: 8 30
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_RUNA	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_RUNB	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_RUNC	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_TNL1	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_TNR1	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_TRNL	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_TRNR	Frames: 0
			AnimationSound = Sound: HorseWhinny			Animation: RURohrm_SKL.RURohrm_CHRB	Frames: 8
			AnimationSound = Sound: HorseWhinny			Animation: RURohrm_SKL.RURohrm_CHRC	Frames: 15
			AnimationSound = Sound: HorseWhinny			Animation: RURohrm_SKL.RURohrm_DIEA	Frames: 0
			AnimationSound = Sound: BodyFallGeneric1		Animation: RURohrm_SKL.RURohrm_DIEA	Frames: 10 46
			AnimationSound = Sound: BodyFallGeneric1		Animation: RURohrm_SKL.RURohrm_LNDA	Frames: 3 11
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_ACCL	Frames: 8 30
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_RUNA	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_RUNB	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_RUNC	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_TNL1	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_TNR1	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_TRNL	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_TRNR	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_ATKD	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_ATKF	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_ATKH	Frames: 0
			AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURhrmArch_SKL.RURhrmArch_ATKJ	Frames: 0
			AnimationSound = Sound: HorseWhinny			Animation: RURhrmArch_SKL.RURhrmArch_CHRB	Frames: 8
			AnimationSound = Sound: HorseWhinny			Animation: RURhrmArch_SKL.RURhrmArch_CHRC	Frames: 15
			AnimationSound = Sound: HorseWhinny			Animation: RURhrmArch_SKL.RURhrmArch_DIEA	Frames: 0
			AnimationSound = Sound: HorseWhinny			Animation: RURhrmArch_SKL.RURhrmArch_DIEB	Frames: 0
			AnimationSound = Sound: BodyFallGeneric1		Animation: RURhrmArch_SKL.RURhrmArch_DIEA	Frames: 10 46
			AnimationSound = Sound: BodyFallGeneric1		Animation: RURhrmArch_SKL.RURhrmArch_DIEB	Frames: 11
			AnimationSound = Sound: BodyFallGeneric1		Animation: RURhrmArch_SKL.RURhrmArch_LNDA	Frames: 3 11
		End


		; *** ENGINEERING Parameters ***
		RadarPriority 	                 = UNIT
		ThingClass			                 = CAVALRY_UNIT
		KindOf					                 = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY SCORE GRAB_AND_DROP
		
		Body                             = ActiveBody ModuleTag_02
			CheerRadius                    = M_EMOTION_CHEER_RADIUS
			MaxHealth                      = M_GONDOR_KNIGHT_HEALTH
			MaxHealthDamaged               = M_GONDOR_KNIGHT_HEALTH_DAMAGED
			RecoveryTime                   = M_GONDOR_KNIGHT_HEALTH_RECOVERY_TIME
		End

		Behavior                         = AIUpdateInterface ModuleTag_03
			AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
			AILuaEventsList                = RivendellElvenWarriorMountFunctions
			AttackPriority                 = AttackPriority_Cavalry
		End
			
		LocomotorSet
			Locomotor                      = NormalHorseHordeMemberLocomotor
			Condition                      = SET_NORMAL 
			Speed                          = M_NORMAL_CAVALRY_MEMBER_SPEED
		End
		LocomotorSet
			Locomotor                      = NormalHorseHordeMemberLocomotor
			Condition                      = SET_CONTAINED
			Speed                          = M_NORMAL_CAVALRY_MEMBER_SPEED
		End

		Behavior                         = PhysicsBehavior ModuleTag_04
			GravityMult                    = 1.0
			ShockStandingTime              = 2533	;msec
		End
		
		Behavior                         = SquishCollide ModuleTag_06
			;nothing
		End
		
		; RohanRohirrim
		Behavior                         = HordeMemberCollide ModuleTag_HMC
			;nothing
		End

		Behavior                         = SlowDeathBehavior ModuleTag_08
			DeathTypes                     = ALL -FADED
			SinkDelay                      = 3000
			SinkRate                       = 1.0     ; in Dist/Sec
			DestructionDelay               = 15000
			DeathFlags                     = DEATH_1 ; Tell model which death animation to play. Sets BOTH model condition and object status bits.
			Sound                          = INITIAL NoldorElfGenericVoiceDie
		End
				
		;//------Heavy Armor------
		Behavior                         = ArmorUpgrade ArmorUpgradeModuleTag
			TriggeredBy                    = Upgrade_RivendellHeavyArmor
		End
		
		Behavior                         = ModelConditionUpgrade ModuleTag_AmonSul
			TriggeredBy			               = Upgrade_RivendellHeavyArmor
			AddConditionFlags		           = RIDER2
		End
		;//------Fire Arrows------
		Behavior                         = SubObjectsUpgrade FireArrows_Upgrade
			TriggeredBy				             = Upgrade_RivendellImprovedArrows
			ShowSubObjects	               = ARROWNOCKUP QUIVERUP
			HideSubObjects	               = ARROWNOCK QUIVER
		End
		
		Behavior                         = WeaponSetUpgrade ModuleTag_FireArrows
			TriggeredBy				             = Upgrade_RivendellImprovedArrows 
			RequiresAllTriggers		         = Yes
		End	
		
		;//------Forged Blades------		
		Behavior                         = SubObjectsUpgrade ForgedBlades_Upgrade
			TriggeredBy				             = Upgrade_RivendellForgedBlades 
			ShowSubObjects			           = Forged_Blade
		End	
		; Just a dummy upgrade module to allow this unit to be upgraded.
		Behavior                         = StatusBitsUpgrade ModuleTag_ForgedBlades
			TriggeredBy				             = Upgrade_RivendellForgedBlades 
		End
		
		Geometry                         = CYLINDER
		GeometryMajorRadius              = 8
		GeometryMinorRadius              = 8
		GeometryHeight                   = 20.0
		GeometryIsSmall                  = No
		Shadow                           = SHADOW_DECAL
		ShadowSizeX                      = 30;
		ShadowSizeY                      = 21;
		ShadowTexture                    = ShadowI;

End