;------------------------------------------------------------------------------
Object EriadorElrohir
	; *** ART Parameters ***
	Scale = 1.03
    ; SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
	SelectPortrait = HPElrohir
    
    ; ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
    ButtonImage = HIElrohir
    
	Draw = W3DScriptedModelDraw ModuleTag_DRAW
	OkToChangeModelColor = Yes
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
	

	ExtraPublicBone = arrow
	ExtraPublicBone = PASSENGERBONE
		
	 DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP

;;====================== MODELS ================================================================
		DefaultModelConditionState
			Model               = auelrohir_skn
			Skeleton			= RUElfWar_SKL
			WeaponLaunchBone    = PRIMARY arrow
		End
		
		ModelConditionState = WEAPONSET_HERO_MODE
            Model               = auelrohir_skn
			Skeleton			= RUElfWar_SKL
            ParticleSysBone =  BAT_HEAD Slayer FollowBone:Yes
        End

;;================== ANIMATIONS =================================================================

		; ------ Flying ------- ;
		
		AnimationState					= PASSENGER WEAPONSET_TOGGLE_1
			StateName					= STATE_Grabbed
			Animation					= Sword
				AnimationName			= RUElfWar_FLLA
				AnimationMode			= LOOP
			End
		End
		
		AnimationState					= PASSENGER
			StateName					= STATE_Grabbed
			Animation					= Bow
				AnimationName			= RUElfWar_FLLB
				AnimationMode			= LOOP
			End
		End
		
		AnimationState					= FREEFALL WEAPONSET_TOGGLE_1
			StateName					= STATE_Falling
			Animation					= Sword
				AnimationName			= RUElfWar_FLYB
				AnimationMode			= LOOP
				AnimationBlendTime		= 10
				AnimationSpeedFactorRange	= 0.24	0.24
			End
		End
		
		AnimationState					= FREEFALL
			StateName					= STATE_Falling
			Animation					= Bow
				AnimationName			= RUElfWar_FLYA
				AnimationMode			= LOOP
				AnimationBlendTime		= 10
				AnimationSpeedFactorRange	= 0.5	0.5
			End
		End
		
		AnimationState        			= STUNNED_FLAILING WEAPONSET_TOGGLE_1
			StateName					= STATE_Fly
			Animation           		= Sword
				AnimationName       	= RUElfWar_FLYB
				AnimationMode       	= LOOP
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES2
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "Ready_Bow" or PrevState == "Moving_Bow" or PrevState == "Bored_Bow"								;;;;;;#TODO put in various bow states here
				then
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "WantSword"
				elseif PrevState == "STATE_Fly"
				then
					if PrevAnim == "Bow" or PrevAnim == "WantSword"
					then
						CurDrawableShowSubObject("arrow")
						CurDrawableShowSubObject("arrownock")
						return "WantSword"
					end
				end
					
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				return "Sword"
			EndScript
		End

		AnimationState        			= STUNNED_FLAILING
			StateName					= STATE_Fly
			Animation
				AnimationName       	= RUElfWar_FLYA
				AnimationMode       	= LOOP
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES2
		End
		
		AnimationState					= DYING DEATH_1 SPLATTED WEAPONSET_TOGGLE_1
			StateName					= STATE_Dead
			Animation					= Sword
				AnimationName			= RUElfWar_LNDB
				AnimationMode			= ONCE
			End
		End
		
		AnimationState					= DYING DEATH_1 SPLATTED
			StateName					= STATE_Dead
			Animation					= Bow
				AnimationName			= RUElfWar_LNDA
				AnimationMode			= ONCE
			End
		End
		
				; ------ Dying ------- ;

		AnimationState        			= DYING DEATH_1 WEAPONSET_TOGGLE_1
			Animation           		= Sword1
				AnimationName       	= RUElfWar_DIESv5
				AnimationMode       	= ONCE
			End
			Animation           		= Sword2
				AnimationName       	= RUElfWar_DIESV4
				AnimationMode       	= ONCE
			End
			Animation           		= WantSword
				AnimationName       	= RUElfWar_LNDA
				AnimationMode       	= ONCE
			End
			
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_Fly"
				then
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "WantSword"
				end
			
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				if GetClientRandomNumberReal(0,2) < 1
				then
					return "Sword1"
				else
					return "Sword2"
				end
			EndScript
		End
		
		AnimationState        			= DYING DEATH_2 WEAPONSET_TOGGLE_1
			Animation           		= FadeOut
				AnimationName       	= RUElfWar_IDLG
				AnimationMode       	= LOOP
			End
		End
		
		AnimationState        			= DYING DEATH_1
			Animation           		= Bow1
				AnimationName       	= RUElfWar_DIEB
				AnimationMode       	= ONCE
			End
			Animation           		= Bow2
				AnimationName       	= RUElfWar_DIEBV5
				AnimationMode       	= ONCE
			End
			Animation           		= WantBow
				AnimationName       	= RUElfWar_LNDB
				AnimationMode       	= ONCE
			End
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				
				if PrevState == "STATE_Fly"
				then
					CurDrawableHideSubObject("ArrowNock")
					CurDrawableHideSubObject("arrow")
					return "WantBow"
				end
				
				if GetClientRandomNumberReal(0,2) < 1
				then
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "Bow1"
				else
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "Bow2"
				end
			EndScript
		End
		
		AnimationState        			= DYING DEATH_2
			Animation					= FadeOut
				AnimationName			= RUElfWar_IDLDX1
				AnimationMode			= ONCE
			End
		End
		

		AnimationState        			= STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
			StateName					= STATE_GetUp
			Animation           		= Sword
				AnimationName       	= RUElfWar_GTPSX1
				AnimationMode       	= ONCE
			End
			Animation           		= WantSword
				AnimationName       	= RUElfWar_GTPB
				AnimationMode       	= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES4
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
				then
					if PrevAnim == "Bow" or PrevAnim == "WantSword"
					then	
						CurDrawableShowSubObject("arrow")
						CurDrawableShowSubObject("arrownock")
						return "WantSword"
					end
				end
				
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				return "Sword"
			EndScript
		End
		
		
		
		AnimationState        			= STUNNED_STANDING_UP
			StateName					= STATE_GetUp
			Animation           		= Bow
				AnimationName       	= RUElfWar_GTPB
				AnimationMode       	= ONCE
			End
			Animation           		= WantBow
				AnimationName       	= RUElfWar_GTPSX1
				AnimationMode       	= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES4
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
				then
					if PrevAnim == "WantBow" or PrevAnim == "Sword"
					then
						CurDrawableHideSubObject("ArrowNock")
						CurDrawableHideSubObject("arrow")
						return "WantBow"
					end
				else
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "Bow"
				end
			EndScript
		End

		AnimationState        			= STUNNED WEAPONSET_TOGGLE_1
			StateName					= STATE_Land
			Animation           		= Sword
				AnimationName       	= RUElfWar_LNDB
				AnimationMode       	= ONCE
			End
			Animation           		= WantSword
				AnimationName       	= RUElfWar_LNDA
				AnimationMode       	= ONCE
			End
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_Fly"
				then
					if PrevAnim == "WantSword" or PrevAnim == "Bow"
					then
						CurDrawableShowSubObject("arrow")
						CurDrawableShowSubObject("arrownock")
						return "WantSword"
					end
				end
				Flags						= MAINTAIN_FRAME_ACROSS_STATES3
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				return "Sword"
			EndScript
		End
		
		AnimationState        			= STUNNED
			StateName					= STATE_Land
			Animation           		= Bow
				AnimationName       	= RUElfWar_LNDA
				AnimationMode       	= ONCE
			End
			Animation           		= WantBow
				AnimationName       	= RUElfWar_LNDB
				AnimationMode       	= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES3
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_Fly"
				then
					if PrevAnim == "WantBow" or PrevAnim == "Sword"
					then
						CurDrawableHideSubObject("ArrowNock")
						CurDrawableHideSubObject("arrow")
						return "WantBow"
					end
				end
				
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				return "Bow"
			EndScript
		End


				
;;======== TERROR

		AnimationState					= MOVING EMOTION_TERROR WEAPONSET_TOGGLE_1
			StateName					= Moving_Sword
			Animation					= Terror
				AnimationName			= RUElfWar_RUNN
				AnimationMode			= LOOP
				Distance				= 40
			End
			Animation					= finishrun_b
				AnimationName       	= RUElfWar_RUNB
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 40
			End
			Animation					= runtrans_bs
				AnimationName       	= RUElfWar_RUNC
				AnimationMode       	= ONCE
				AnimationBlendTime		= 5
				Distance				= 70
			End
			Animation					= runtrans_sb_finish
				AnimationName       	= RUElfWar_RUNT
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 70
			End
			Animation					= runnoblend_s
				AnimationName       	= RUElfWar_RUNN
				AnimationMode       	= LOOP
				AnimationBlendTime		= 0
				Distance				= 40
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE MAINTAIN_FRAME_ACROSS_STATES
			BeginScript
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("ARROW")
				CurDrawableHideSubObject("ARROWNOCK")
				
				if PrevState == "Moving_Bow"
				then
					if PrevAnim == "runtrans_sb"
					then
						return "runtrans_sb_finish"
					elseif PrevAnim == "finishrun_s"
					then
						return "runnoblend_s"
					else
						return "finishrun_b"
					end
				elseif PrevAnim == "finishrun_b" or PrevAnim == "runtrans_sb_finish"
				then
					return "runtrans_bs"
				elseif PrevAnim == "runtrans_bs" or PrevAnim == "run_s" or PrevAnim == "runnoblend_s"
				then
					return "runnoblend_s"
				else
					return "Terror"
				end				
			EndScript
		End
		AnimationState					= MOVING EMOTION_TERROR
			StateName					= Moving_Bow
			Animation					= RunAway_3
				AnimationName			= RUElfWar_RUNOT3
				AnimationMode			= ONCE
				Distance				= 40
			End
			Animation					= RunAway_2
				AnimationName			= RUElfWar_RUNOT4
				AnimationMode			= ONCE
				Distance				= 40
			End
			Animation					= RunAway
				AnimationName			= RUElfWar_RUNB
				AnimationMode			= ONCE
				Distance				= 40
			End
			Animation					= finishrun_s
				AnimationName       	= RUElfWar_RUNN
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 40
			End
			Animation					= runtrans_sb
				AnimationName       	= RUElfWar_RUNT
				AnimationMode       	= ONCE
				AnimationBlendTime		= 5
				Distance				= 70
			End
			Animation					= runtrans_bs_finish
				AnimationName       	= RUElfWar_RUNC
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 70
			End
			Animation					= RunAway_noblend
				AnimationName			= RUElfWar_RUNB
				AnimationMode			= ONCE
				AnimationBlendTime		= 0
				Distance				= 40
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE MAINTAIN_FRAME_ACROSS_STATES
			BeginScript
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				
				if PrevState == "Moving_Sword"
				then
					if PrevAnim == "runtrans_bs"
					then
						return "runtrans_bs_finish"
					elseif PrevAnim == "finishrun_b"
					then
						return "RunAway_noblend"
					else
						return "finishrun_s"
					end
				elseif PrevAnim == "finishrun_s" or PrevAnim == "runtrans_bs_finish"
				then
					return "runtrans_sb"
				elseif PrevAnim == "runtrans_sb" or PrevAnim == "run_b" or PrevAnim == "runnoblend_b"
				then
					return "RunAway_noblend"
				else
					Num = GetClientRandomNumberReal(0,7)
					if Num < 1 
					then
						return "RunAway_2"
					elseif Num > 6
					then
						return "RunAway_3"
					else
						return "RunAway"
					end
				end			
			EndScript
		End


		; ------ Attacking ------- ;
		
		AnimationState        			= FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
			StateName					= Ready_Sword
			
			Animation           		= AttackWithSwordA
				AnimationName       	= RUElfWar_ATKSV2
				AnimationMode       	= ONCE
				UseWeaponTiming			= Yes
			End
			Animation           		= AttackWithSwordB
				AnimationName       	= RUElfWar_ATKS
				AnimationMode       	= ONCE
				UseWeaponTiming			= Yes
			End
			Animation           		= AttackWithSwordD
				AnimationName       	= RUElfWar_ATKSV4
				AnimationMode       	= ONCE
				UseWeaponTiming			= Yes
			End
			BeginScript
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
			EndScript
		End
;;---------------------------------------------------------------------------<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
		AnimationState					= PREATTACK_A 
			Animation					= ReadyToDrawn
				AnimationName			= RUElfWar_ATKA1
				AnimationMode			= ONCE
				AnimationBlendTime		= 20				; Must be 0 blend time otherwise the arrow will linger for the duration of the blend!
			End
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("ArrowNock")
			EndScript
		End

		AnimationState					= FIRING_OR_RELOADING_A
			StateName					= STATE_Firing
			Animation					= OneFrameOfShooting
				AnimationName			= RUElfWar_ATKA2
				AnimationMode			= ONCE
				AnimationBlendTime		= 0
				AnimationSpeedFactorRange	= 1.5 1.5
			End
			Flags						= START_FRAME_FIRST			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("ArrowNock")
			EndScript
		End
;;--------------------------------------------------------------------------------<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

		
;;------------------------- BACKUP --------------------------------------------------------------------


		AnimationState					= MOVING BACKING_UP WEAPONSET_TOGGLE_1
			StateName					= STATE_BackingUp
			Animation					= Sword
				AnimationName			= RUElfWar_BAKS
				AnimationMode			= LOOP
			End
			Animation					= WantSword
				AnimationName			= RUElfWar_BAKB
				AnimationMode			= LOOP
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES4
			BeginScript
				CurDrawableHideSubObject("ARROW")
				CurDrawableHideSubObject("ARROWNOCK")
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				if PrevState == "STATE_BackingUp"
				then
					if PrevAnim == "Bow" or PrevAnim == "WantSword"
					then
						return "WantSword"
					end
				end
				
				return "Sword"			
			EndScript
		End
		AnimationState					= MOVING BACKING_UP
			StateName					= STATE_BackingUp
			Animation					= Bow
				AnimationName			= RUElfWar_BAKB
				AnimationMode			= LOOP
			End
			Animation					= WantBow
				AnimationName			= RUElfWar_BAKS
				AnimationMode			= LOOP
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES4
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				if PrevState == "STATE_BackingUp"
				then
					if PrevAnim == "WantBow" or PrevAnim == "Sword"
					then
						return "WantBow"
					end
				end
				
				return "Bow"
			EndScript
		End
	
		; ------------ Moving ------------- ;
		
		AnimationState        			= MOVING WEAPONSET_TOGGLE_1
			StateName					= Moving_Sword
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= RUElfWar_RUNS
				AnimationMode       	= LOOP
				Distance				= 40
			End
			Animation					= finishrun_b
				AnimationName       	= RUElfWar_RUNB
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 40
			End
			Animation					= runtrans_bs
				AnimationName       	= RUElfWar_RUNC
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 70
			End
			Animation					= runtrans_sb_finish
				AnimationName       	= RUElfWar_RUNT
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 70
			End
			Animation					= runnoblend_s
				AnimationName       	= RUElfWar_RUNS
				AnimationMode       	= LOOP
				AnimationBlendTime		= 0
				Distance				= 40
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("ARROW")
				CurDrawableHideSubObject("ARROWNOCK")
				
				if PrevState == "Moving_Bow"
				then
					if PrevAnim == "runtrans_sb"
					then
						return "runtrans_sb_finish"
					elseif PrevAnim == "finishrun_s"
					then
						return "runnoblend_s"
					else
						return "finishrun_b"
					end
				elseif PrevAnim == "finishrun_b" or PrevAnim == "runtrans_sb_finish" or PrevAnim == "WantSword"
				then
					return "runtrans_bs"
				elseif PrevAnim == "runtrans_bs" or PrevAnim == "run_s" or PrevAnim == "runnoblend_s"
				then
					return "runnoblend_s"
				else
					return "run_s"
				end				
			EndScript
		End
		
		AnimationState        			= MOVING
			StateName					= Moving_Bow
			SimilarRestart				= Yes
			Animation           		= run_b
				AnimationName       	= RUElfWar_RUNB
				AnimationMode       	= LOOP
				Distance				= 40
			End
			Animation					= finishrun_s
				AnimationName       	= RUElfWar_RUNS
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 40
			End
			Animation					= runtrans_sb
				AnimationName       	= RUElfWar_RUNT
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 70
			End
			Animation					= runtrans_bs_finish
				AnimationName       	= RUElfWar_RUNC
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
				Distance				= 70
			End
			Animation					= runnoblend_b
				AnimationName       	= RUElfWar_RUNB
				AnimationMode       	= LOOP
				AnimationBlendTime		= 0
				Distance				= 40
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				
				if PrevState == "Moving_Sword"
				then
					if PrevAnim == "runtrans_bs"
					then
						return "runtrans_bs_finish"
					elseif PrevAnim == "finishrun_b"
					then
						return "runnoblend_b"
					else
						return "finishrun_s"
					end
				elseif PrevAnim == "finishrun_s" or PrevAnim == "runtrans_bs_finish" or PrevAnim == "WantBow"
				then
					return "runtrans_sb"
				elseif PrevAnim == "runtrans_sb" or PrevAnim == "run_b" or PrevAnim == "runnoblend_b"
				then
					return "runnoblend_b"
				else
					return "run_b"
				end				
			EndScript
		End
		
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
;		TransitionState       			= TRANS_SwordToBow_Moving
;			Animation           		= DrawBow
;				AnimationName       	= RUElfWar_RUNT
;				AnimationMode       	= ONCE
;			End
;			
;			BeginScript
;				CurDrawableAllowToContinue()
;			EndScript
;		End
;		
;		TransitionState       			= TRANS_BowToSword_Moving
;			Animation           		= DrawSword
;				AnimationName       	= RUElfWar_RUNC
;				AnimationMode       	= ONCE
;			End
;			
;			BeginScript
;				CurDrawableAllowToContinue()
;			EndScript
;		End
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
		
;;-----------------------------------------------------------------------------------<<<<<<<<<<<<<<<<<<<<<<<<<<<

		AnimationState					= CONTINUOUS_FIRE_MEAN		;;;;;;;;;HACK TO STOP JITTERS
			Animation					= HangFrameWhileCoasting
				AnimationName			= RUElfWar_ATKA2
				AnimationMode			= MANUAL
				AnimationBlendTime		= 0
			End
			Flags						= START_FRAME_LAST
						
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("ARROWNOCK")
				if CurDrawablePrevAnimationState() == "STATE_Firing" then CurDrawableAllowToContinue() end
			EndScript
			;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
			;;;;
			;;;;	VERY IMPORTANT ARCHER INFORMATION
			;;;;	THIS WILL STOP THE JITTERS, AND BEST
			;;;;	YET, IT'S A COMPLETE HACK! Just look above.
			;;;;	We say that if we get into this state
			;;;;	from firing, just continue to fire. DONE.
			;;;;
			;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		End
		
		AnimationState					= CONTINUOUS_FIRE_SLOW
			StateName					= Ready_Bow
			Animation					= PutAwayArrow
				AnimationName			= RUElfWar_ATKA3
				AnimationMode			= ONCE
			End
						
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("ARROWNOCK")
			EndScript
		End
;;;--------------------------------------------------------------------------------------<<<<<<<<<<<<<<<<<<<<<<<		
	
		AnimationState					= EMOTION_UNCONTROLLABLY_AFRAID WEAPONSET_TOGGLE_1
			StateName					= STATE_Emotion_Sword
			Animation					= Sword
				AnimationName			= RUElfWar_FERS
				AnimationMode			= ONCE
			End
			Animation					= Sword2
				AnimationName			= RUElfWar_FERS
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
					end
				end
			EndScript
		End
		AnimationState					= EMOTION_UNCONTROLLABLY_AFRAID 
			StateName					= STATE_Emotion_Bow
			Animation					= Bow
				AnimationName			= RUElfWar_FERB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End	
			Animation					= Bow2
				AnimationName			= RUElfWar_FERB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
					end
				end
			EndScript	
		End
		
	
		; -------- Alert ------- ;
		
		AnimationState					= EMOTION_ALERT WEAPONSET_TOGGLE_1
			StateName					= Ready_Sword
			
			Animation					= Alert_1
				AnimationName			= RUElfWar_IDLST1
				AnimationMode			= LOOP
			End
			
			BeginScript
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				if Prev == "Bored_Sword"		then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")			end
				if Prev == "Selected_Sword"		then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")			end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then 
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")	
				end
			EndScript
		End
		AnimationState					= ENGAGED WEAPONSET_TOGGLE_1
			StateName					= Ready_Sword
			
			Animation					= Alert_1
				AnimationName			= RUElfWar_IDLST1
				AnimationMode			= LOOP
			End
			
			BeginScript
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				if Prev == "Bored_Sword"		then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")			end
				if Prev == "Selected_Sword"		then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")			end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then 
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")	
				end
			EndScript
		End
		AnimationState					= ATTACKING WEAPONSET_TOGGLE_1
			StateName					= Ready_Sword
			
			Animation					= Alert_1
				AnimationName			= RUElfWar_IDLST1
				AnimationMode			= LOOP
			End
			
			BeginScript
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				if Prev == "Bored_Sword"		then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")			end
				if Prev == "Selected_Sword"		then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")			end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then 
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")	
				end
			EndScript
		End
		
		AnimationState					= EMOTION_ALERT
			StateName					= Ready_Bow
			
			Animation					= IDLB
				AnimationName			= RUElfWar_IDLB
				AnimationMode			= LOOP
			End
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Bored_Bow"		then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")				end
				if Prev == "Selected_Bow"	then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")				end
				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
				then 
					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")	
				end				
			EndScript
		End 
		AnimationState					= ENGAGED
			StateName					= Ready_Bow
			
			Animation					= IDLB
				AnimationName			= RUElfWar_IDLB
				AnimationMode			= LOOP
			End
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Bored_Bow"		then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")				end
				if Prev == "Selected_Bow"	then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")				end
				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
				then 
					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")	
				end				
			EndScript
		End
		AnimationState					= ATTACKING
			StateName					= Ready_Bow
			
			Animation					= IDLB
				AnimationName			= RUElfWar_IDLB
				AnimationMode			= LOOP
			End
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Bored_Bow"		then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")				end
				if Prev == "Selected_Bow"	then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")				end
				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
				then 
					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")	
				end				
			EndScript
		End
		
		
		
;;------------ EMOTIONS ------------------------------------------------------------------
;;======= AFRAID

		AnimationState					= EMOTION_AFRAID WEAPONSET_TOGGLE_1
			StateName					= STATE_Emotion_Sword
			Animation					= Sword
				AnimationName			= RUElfWar_FERS
				AnimationMode			= ONCE
			End
			Animation					= Sword2
				AnimationName			= RUElfWar_FERS
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
					end
				end
			EndScript
		End
		AnimationState					= EMOTION_AFRAID 
			StateName					= STATE_Emotion_Bow
			Animation					= Bow
				AnimationName			= RUElfWar_FERB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End	
			Animation					= Bow2
				AnimationName			= RUElfWar_FERB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
					end
				end
			EndScript	
		End
		
;;====== CELEBRATING		

		AnimationState					= EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
			StateName					= STATE_Emotion_Sword
			Animation					= Sword
				AnimationName			= RUElfWar_CHRST2
				AnimationMode			= ONCE
			End
			Animation					= Sword2
				AnimationName			= RUElfWar_CHRST2
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
					end
				elseif PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
				elseif PrevState == "Selected_Sword"
				then
					CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
				elseif PrevState == "Bored_Sword"
				then
					CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
				end
			EndScript
		End
		AnimationState					= EMOTION_CELEBRATING
			StateName					= STATE_Emotion_Bow
			Animation					= Bow
				AnimationName			= RUElfWar_CHRB
				AnimationMode			= ONCE
			End
			Animation					= Bow2
				AnimationName			= RUElfWar_CHRB
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
					end
				elseif PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
				elseif PrevState == "Selected_Bow"
				then
					CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
;				elseif PrevState == "Bored_Bow"
;				then
;					CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
				end
			EndScript	
		End

;;====== TAUNTING

		AnimationState					= EMOTION_TAUNTING WEAPONSET_TOGGLE_1
			StateName					= STATE_Emotion_Sword
			Animation					= Sword
				AnimationName			= RUElfWar_TNTSV1
				AnimationMode			= ONCE
			End
			Animation					= Sword2
				AnimationName			= RUElfWar_TNTSV1
				AnimationMode			= ONCE
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE ;MAINTAIN_FRAME_ACROSS_STATES
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
					end
				elseif PrevState == "STATE_Emotion_Sword"
					then
						CurDrawableAllowToContinue()
				elseif PrevState == "Selected_Sword"
				then
					CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
				elseif PrevState == "Bored_Sword"
				then
					CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
				end
			EndScript
		End
		AnimationState					= EMOTION_TAUNTING
			StateName					= STATE_Emotion_Bow
			Animation					= Bow1
				AnimationName			= RUElfWar_TNTB
				AnimationMode			= ONCE
			End
			Animation					= Bow2
				AnimationName			= RUElfWar_TNTB		; RUElfWar_TNTBX anim does not exist
				AnimationMode			= ONCE
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE ;MAINTAIN_FRAME_ACROSS_STATES
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
					end
				elseif PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
				elseif PrevState == "Selected_Bow"
				then
					CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
				elseif PrevState == "Bored_Bow"
				then
					CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
				end
			EndScript
		End

;;====== POINTING

		AnimationState					= EMOTION_POINTING WEAPONSET_TOGGLE_1
			StateName					= STATE_Emotion_Sword
			Animation					= Sword
				AnimationName			= RUElfWar_PNTB
				AnimationMode			= ONCE
			End
			Animation					= Sword2
				AnimationName			= RUElfWar_PNTB
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
					end
				elseif PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
				elseif PrevState == "Selected_Sword"
				then
					CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
				elseif PrevState == "Bored_Sword"
				then
					CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
				end
			EndScript
		End
		AnimationState					= EMOTION_POINTING
			StateName					= STATE_Emotion_Bow
			Animation					= Bow
				AnimationName			= RUElfWar_PNTA
				AnimationMode			= ONCE
			End
			Animation					= Bow2
				AnimationName			= RUElfWar_PNTA
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
					end
				elseif PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
				elseif PrevState == "Selected_Bow"
				then
					CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
				elseif PrevState == "Bored_Bow"
				then
					CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
				end
			EndScript
		End
		
		; ------ Selected ------ ;

		AnimationState				=	SELECTED WEAPONSET_TOGGLE_1
			StateName				=	Selected_Sword
			
			Animation				=	ATNA
				AnimationName		=	RUElfWar_ATNS
				AnimationMode		=	LOOP
			End
			
			BeginScript
				CurDrawableHideSubObject("ARROW")
				CurDrawableHideSubObject("ARROWNOCK")
				
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
				if Prev == "Bored_Sword"		then CurDrawableSetTransitionAnimState("TRANS_BS_Sword")		end
				if Prev == "Ready_Sword"		then CurDrawableSetTransitionAnimState("TRANS_RS_Sword")		end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")	
				end
				
			EndScript
		End

		AnimationState				=	SELECTED 
			StateName           	=	Selected_Bow
			
			Animation				=	ATNE
				AnimationName		=	RUElfWar_ATNE
				AnimationMode		=	LOOP
			End
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
				if Prev == "Bored_Bow" then CurDrawableSetTransitionAnimState("TRANS_BS_Bow")				end
				if Prev == "Ready_Bow" then CurDrawableSetTransitionAnimState("TRANS_RS_Bow")				end
				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
				then 
					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")	
				end	
			EndScript
		End
		
		
		; --------- Hit Reactions ---------- ;
		
		AnimationState						= HIT_REACTION HIT_LEVEL_1 WEAPONSET_TOGGLE_1
			StateName						= Bored_Sword
			Animation						= Hit_Level_1_a
				AnimationName				= RUElfWar_HITE
				AnimationMode				= ONCE
			End
		End

		AnimationState 						= HIT_REACTION HIT_LEVEL_1
			StateName						= Bored_Bow
			Animation 						= Hit_Level_1_a
				AnimationName				= RUElfWar_HITB
				AnimationMode 				= ONCE
				AnimationSpeedFactorRange	= .9 .9
			End
		End
		
		
		; ------- Bored -------- ;
		
		AnimationState					= WEAPONSET_TOGGLE_1
			StateName					= Bored_Sword
			
			Animation           		= Idle_Sword1
				AnimationName       	= RUElfWar_IDLG
				AnimationMode       	= ONCE
			End
			Animation           		= Idle_Sword2
				AnimationName       	= RUElfWar_IDLCT1
				AnimationMode       	= ONCE
			End
			Animation           		= Idle_Sword3
				AnimationName       	= RUElfWar_IDLCT3
				AnimationMode       	= ONCE
			End
			Animation					= IdleNoFidget
				AnimationName			= RUElfWar_IDLF
				AnimationMode			= ONCE
				AnimationPriority		= 20
			End
			Animation					= IdleNoFidget2
				AnimationName			= RUElfWar_IDLF
				AnimationMode			= ONCE
				AnimationPriority		= 0
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableHideSubObject("ARROW")
				CurDrawableHideSubObject("ARROWNOCK")				

				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "TRANS_SB_Sword" or Prev == "TRANS_RB_Sword" then return "IdleNoFidget" end
				if Prev == "Selected_Sword"		then CurDrawableSetTransitionAnimState("TRANS_SB_Sword")		end
				if Prev == "Ready_Sword"		then CurDrawableSetTransitionAnimState("TRANS_RB_Sword")		end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then 
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")	
				end
			EndScript
		End
		
		IdleAnimationState
			StateName					= Bored_Bow
			
			Animation					= IdleBowB
				AnimationName			= RUElfWar_IDLDX1
				AnimationMode			= ONCE
			End
			Animation					= IdleBowD
				AnimationName			= RUElfWar_IDLD
				AnimationMode			= ONCE
			End
			Animation					= IdleNoFidget
				AnimationName			= RUElfWar_IDLE
				AnimationMode			= ONCE
				AnimationPriority		= 20
			End
			Animation					= IdleNoFidget2
				AnimationName			= RUElfWar_IDLE
				AnimationMode			= ONCE
				AnimationPriority		= 10
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
			BeginScript	
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")			
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "TRANS_SB_Bow" or Prev == "TRANS_RB_Bow" then return "IdleNoFidget" end
				if Prev == "Selected_Bow"		then CurDrawableSetTransitionAnimState("TRANS_SB_Bow")		end
				if Prev == "Ready_Bow"			then CurDrawableSetTransitionAnimState("TRANS_RB_Bow")		end
				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
				then 
					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")	
				end	
			EndScript
		End

		
		;----------------- Bow Transitions -------------------------;

		TransitionState       			= TRANS_BS_Bow
			Animation           		= ATND
				AnimationName     		= RUElfWar_ATND
				AnimationMode     		= ONCE
				AnimationBlendTime		= 10
			End
		End
		
		TransitionState       			= TRANS_SR_Bow
			Animation           		= ATNE
				AnimationName     		= RUElfWar_ATNF
				AnimationMode     		= ONCE
			End
		End
		
		TransitionState       			= TRANS_SB_Bow
			Animation           		= ATND
				AnimationName     		= RUElfWar_ATND
				AnimationMode     		= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End
		
		TransitionState       			= TRANS_RS_Bow
			Animation           		= ATNF
				AnimationName     		= RUElfWar_ATNF
				AnimationMode     		= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End
		
		TransitionState       			= TRANS_BR_Bow
			Animation           		= IDLB
				AnimationName     		= RUElfWar_IDLB
				AnimationMode     		= ONCE
				AnimationBlendTime		= 20
			End
		End
		
		TransitionState       			= TRANS_RB_Bow
			Animation           		= IDLD
				AnimationName     		= RUElfWar_IDLD
				AnimationMode     		= ONCE
				AnimationBlendTime		= 20
			End
		End
		
		;----------------- Sword Transitions -------------------------;
		
		TransitionState       			= TRANS_BS_Sword
			Animation           		= ATNA
				AnimationName     		= RUElfWar_ATNA
				AnimationMode     		= ONCE
			End
			Animation           		= ATNAX1
				AnimationName     		= RUElfWar_ATNX1
				AnimationMode     		= ONCE
			End
		End
		
		TransitionState       			= TRANS_SR_Sword
			Animation           		= ATNC
				AnimationName     		= RUElfWar_ATNC
				AnimationMode     		= ONCE
			End
		End
		
		TransitionState       			= TRANS_SB_Sword
			Animation           		= ATNA
				AnimationName     		= RUElfWar_ATNA
				AnimationMode     		= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End
		
		TransitionState       			= TRANS_RS_Sword
			Animation           		= ATNC
				AnimationName     		= RUElfWar_ATNC
				AnimationMode     		= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End
		
		TransitionState       			= TRANS_BR_Sword
			Animation           		= ATNS
				AnimationName     		= RUElfWar_ATNS
				AnimationMode     		= ONCE
				AnimationBlendTime		= 20
			End
		End
		
		TransitionState       			= TRANS_RB_Sword
			Animation           		= IDLG
				AnimationName     		= RUElfWar_IDLG
				AnimationMode     		= ONCE
				AnimationBlendTime		= 20
			End
		End
		

		;-------------- Weapon Change Transitions --------------------------;		

		TransitionState       			= TRANS_BowToSword_Ready
			Animation           		= DrawSwords
				AnimationName       	= RUElfWar_STHA
				AnimationMode       	= ONCE
			End
		End

		TransitionState       			= TRANS_SwordToBow_Ready
			Animation           		= DrawBow
				AnimationName       	= RUElfWar_STHB
				AnimationMode       	= ONCE
			End
		End
		
		TransitionState       			= TRANS_BowToSword_Selected
			Animation           		= DrawSwords
				AnimationName       	= RUElfWar_STHC
				AnimationMode       	= ONCE
			End
		End

		TransitionState       			= TRANS_SwordToBow_Selected
			Animation           		= DrawBow
				AnimationName       	= RUElfWar_STHD
				AnimationMode       	= ONCE
			End
		End
;;------------------------------------------------------------------------------------------------------------
	End

	; ***DESIGN parameters ***
	Side = Eriador
	EditorSorting = UNIT
	ThreatLevel = 4.0
	ThingClass = CHARACTER_UNIT
    BuildCost = FARAMIR_BUILDCOST				
    BuildTime = FARAMIR_BUILDTIME				
	TransportSlotCount = 1
	DisplayMeleeDamage = FARAMIR_DAMAGE
	DisplayRangedDamage = FARAMIR_BOW_DAMAGE

	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    ElrohirElvenBow
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	
	
	ArmorSet
		Conditions      = None
		Armor           = HeroArmor
		DamageFX        = NormalDamageFX
	End

	VisionRange = VISION_HERO_RANGED
	ShroudClearingRange = SHROUD_CLEAR_RANGED_HERO

	BountyValue = GONDOR_FARAMIR_BOUNTY_VALUE
	DisplayName = OBJECT:Elrohir
	RecruitText = CONTROLBAR:ElrohirRecruit
	ReviveText	= CONTROLBAR:GenericHeroRevive
	Hotkey		= CONTROLBAR:ElrohirHotkey
	CrusherLevel = 0			;Can I crush anything?
	MountedCrusherLevel = 1		;Crush level when mounted.
	CrushableLevel = 2			;What am I?:        0 = for infantry, 1 = for trees, 2 = cavalry/heroes
	MountedCrushableLevel = 2	;Crusable level when mounted.

	CrushWeapon		= HeroCrush  

	MinCrushVelocityPercent = 50 ; Has to be moving at at least 50% of full speed.
	CrushDecelerationPercent = 30 ; Lose xx percent of max velocity when crushing.
	
	CrushKnockback = 40
	CrushZFactor = 1.0

	CommandSet = ElrohirCommandset
	CommandPoints = 0


	; *** AUDIO Parameters ***;

	VoiceAttack				= ElfWarriorVoiceAttackBow
	VoiceAttackAir				= ElfWarriorVoiceAttackBow
	VoiceAttackCharge			= ElfWarriorVoiceAttackCharge
	VoiceAttackMachine		= ElfWarriorVoiceAttackBow
	VoiceAttackStructure		= ElfWarriorVoiceAttackBuilding
	;VoiceCreated			= FaramirRangerVoiceSalute	;this conflicts with his respawn dialogue line -- rehooked to spawn FX
	;VoiceFullyCreated 		= FaramirRangerVoiceSalute	;this conflicts with his respawn dialogue line -- rehooked to spawn FX
	VoiceFear 				= ElfWarriorVoiceHelpMe
	VoiceMove				= ElfWarriorVoiceMove
	VoiceMoveToCamp			= ElfWarriorVoiceMoveCamp
	VoiceMoveWhileAttacking		= ElfWarriorVoiceDisengage
	VoicePriority			= 82
	VoiceRetreatToCastle		= ElfWarriorVoiceRetreat
	VoiceSelect				= ElfWarriorVoiceSelect
	VoiceSelect2			= HeroVoiceSelect2
	VoiceSelectBattle 		= ElfWarriorVoiceSelectBattle
	VoiceGuard				= ElfWarriorVoiceMove

	SoundImpact				= ImpactHorse

;FaramirRangerVoiceModeKnight
;FaramirRangerVoiceMoveTrees

	UnitSpecificSounds
		VoiceGarrison		= ElfWarriorVoiceGarrison              
	End

	EvaEventDamagedOwner				= UnitUnderAttack ;Eva event to trigger when unit is damaged
	EvaEventDieOwner					= ElrohirDie	;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU			; Tie into LargeGroupAudio system
		Key = Human Unit Infantry Hero
		UnitWeight = 2
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:ArrowDrawBow					Animation:RUElfWar_SKL.RUElfWar_ATKA1	Frames:6
		AnimationSound = Sound:ArrowDrawBow					Animation:RUElfWar_SKL.RUElfWar_ATKA2	Frames:18

		AnimationSound = Sound:SwordShingClean1ForHordes 		Animation:RUElfWar_SKL.RUElfWar_STHA 	Frames:24
		AnimationSound = Sound:SwordIntoScabbard1ForHordes		Animation:RUElfWar_SKL.RUElfWar_STHB 	Frames:9
		AnimationSound = Sound:WeaponSwitchBowForHordes		 	Animation:RUElfWar_SKL.RUElfWar_STHB 	Frames:15

		AnimationSound = Sound:SwordShingClean1ForHordes 		Animation:RUElfWar_SKL.RUElfWar_STHC 	Frames:20
		AnimationSound = Sound:SwordIntoScabbard1ForHordes		Animation:RUElfWar_SKL.RUElfWar_STHD 	Frames:5
		AnimationSound = Sound:WeaponSwitchBowForHordes 		Animation:RUElfWar_SKL.RUElfWar_STHD 	Frames:8

		AnimationSound = Sound:SwordShingClean1ForHordes 		Animation:RUElfWar_SKL.RUElfWar_RUNC 	Frames:14
		AnimationSound = Sound:SwordIntoScabbard1ForHordes 		Animation:RUElfWar_SKL.RUElfWar_RUNT 	Frames:4
		AnimationSound = Sound:WeaponSwitchBowForHordes 		Animation:RUElfWar_SKL.RUElfWar_RUNT 	Frames:16

		AnimationSound = Sound:BodyFallSoldier				Animation:RUElfWar_SKL.RUElfWar_LNDA	Frames:9
		AnimationSound = Sound:BodyFallSoldier				Animation:RUElfWar_SKL.RUElfWar_LNDB	Frames:1

		AnimationSound = Sound:BodyFallGenericNoArmor			Animation:RUElfWar_SKL.RUElfWar_DIEB 	Frames:82
		AnimationSound = Sound:BodyFallSoldier				Animation:RUElfWar_SKL.RUElfWar_DIEBV5 	Frames:25
		AnimationSound = Sound:BodyFallSoldier				Animation:RUElfWar_SKL.RUElfWar_DIESV4 	Frames:26
		AnimationSound = Sound:BodyFallGenericNoArmor			Animation:RUElfWar_SKL.RUElfWar_DIESV5	Frames:100
	End

	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT
	PathfindDiameter = 40.0

	Body = RespawnBody ModuleTag_RespawnBody
		CheerRadius 			= EMOTION_CHEER_RADIUS
		MaxHealth         		= FARAMIR_HEALTH	;BALANCE Faramir Health
		PermanentlyKilledByFilter	= NONE		;Who kills me permanently?
   		DodgePercent      		= HERO_DODGE_PERCENT
	End
	Behavior = RespawnUpdate ModuleTag_RespawnUpdate
		DeathAnim				= DYING				;Model condition to play when killed-to-respawn
		DeathFX				= FX_SaFGoodDieToRespawn	;FXList to play when killed-to-respawn
		DeathAnimationTime		= 5000				;How long DeathAnim will take.
		InitialSpawnFX			= FX_ElrohirInitialSpawn
		RespawnAnim				= LEVELED				;Animation to play when respawning.
		RespawnFX				= FX_ElrohirRespawn		;FXList to play when respawning.
		RespawnAnimationTime		= 2000				;Time it takes for respawn to play.
		AutoRespawnAtObjectFilter	= NONE +CASTLE_KEEP		;Respawn at this location -- and at it's exit production point if possible.
		ButtonImage				= HIElrohir
		
		;RespawnEntries determine the ruleset for how a character can be revived. Some units may automatically respawn, others
		;may require a specific revive action performed on him. You can specify different values for each level... or use Level:Any
		RespawnRules =			AutoSpawn:No	Cost:600		Time:90000		Health:100%		;DEFAULT VALUES
		RespawnEntry =	Level:2				Cost:700		Time:90000		;For other levels, only override what is different.
		RespawnEntry =	Level:3				Cost:800		Time:90000		
		RespawnEntry =	Level:4				Cost:900		Time:90000		
		RespawnEntry =	Level:5				Cost:1000		Time:120000		
		RespawnEntry =	Level:6				Cost:1100		Time:120000		
		RespawnEntry =	Level:7				Cost:1200		Time:120000		
		RespawnEntry =	Level:8				Cost:1300		Time:120000		
		RespawnEntry =	Level:9				Cost:1400		Time:120000		
		RespawnEntry =	Level:10			Cost:1500		Time:120000		
	End
	
	Behavior = AutoHealBehavior ModuleTag_FaramirHealing
		StartsActive = Yes
		HealingAmount = HERO_HEAL_AMOUNT
		HealingDelay = 1000
		StartHealingDelay = HERO_HEAL_DELAY
		HealOnlyIfNotInCombat = Yes
	End

	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
		MoodAttackCheckRate        = 500
		HoldGroundCloseRangeDistance = 41
	End

	LocomotorSet
		Locomotor = HeroHumanLocomotor
		Condition = SET_NORMAL 
		Speed     = M_NORMAL_GOOD_LEGOLAS_SPEED
	End
	
	Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehavior
	End

    Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	300		; max distance to taunted/pointed objet
 		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		AddEmotion	=	Alert_Base
 	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
		ShockStandingTime		= 2533	;msec
	End
	 
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL 
		SinkDelay = 30000
		SinkRate = 0.40     ; in Dist/Sec
		DestructionDelay = 8000
		Sound = INITIAL FaramirRangerVoiceDie
	End
	
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End
	
	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 1500 ; level 1 (light  damage)  hit reaction animations in ms
		HitReactionLifeTimer2 = 1500 ; level 2 (medium damage)  hit reaction animations in ms
		HitReactionLifeTimer3 = 1500 ; level 3 (heavy  damage)  hit reaction animations in ms

		HitReactionThreshold1 = 5.0   ; level 1 (light  damage) threshold trigger
		HitReactionThreshold2 = 25.0  ; level 2 (medium damage) threshold trigger
		HitReactionThreshold3 = 50.0  ; level 3 (heavy  damage) threshold trigger
		
		FastHitsResetReaction = Yes    If set -- when hits occur faster than the reaction animations, it will reset the animation. (like getting riddled with machine gun bullets)
	End
	
	;================================Blademaster==========================================
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnifeEnabler
        SpecialPowerTemplate = SpecialAbilityElrohirBladeMaster
        TriggeredBy = Upgrade_GenericUpgrade3
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityElrohirBladeMaster
        Duration                = 25000
        AttributeModifier        = ElrohirBladeMaster
        ;LockWeaponSlot            = SECONDARY
        WeaponSetFlags            = WEAPONSET_HERO_MODE
        StartsPaused            = Yes
        ;InitiateSound             = AragornBladeMaster        ;this doesn't work
    End
	
	;---------------------------------- Elrohir Leadership -----------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
		SpecialPowerTemplate = SpecialAbilityFakeLeadership
		TriggeredBy = Upgrade_GenericUpgrade1
	End

	Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate   
		SpecialPowerTemplate      = SpecialAbilityFakeLeadership
		UpdateModuleStartsAttack  = No
		StartsPaused = Yes
	End	
	Behavior = AttributeModifierAuraUpdate ModuleTag_ElrohirLeadership
		StartsActive	= No
		TriggeredBy     = Upgrade_GenericUpgrade1
		BonusName		= ElrohirUnitLeadership
		RefreshDelay	= 2500
		Range			= 200		
		ObjectFilter	= ANY +INFANTRY +CAVALRY  -STRUCTURE -BASE_FOUNDATION -HERO
	End
	
	; Brotherly Bond (Elladan gains +25% attack damage when near Elrohir.)
	; -----------------------------------------------------
	Behavior = AttributeModifierAuraUpdate ModuleTag_LeadershipBrothers
		StartsActive	= Yes
		BonusName		= BrotherOfElladan
		RefreshDelay	= 2000
		Range			= 200	
		ObjectFilter	= NONE +EriadorElladan
	End	
	
;-------------------------------------------------------------------------
; Faramir Wounding Arrow - AKA: FaramirWoundArrow
;--------------------------------------------------------------------------
	
	Behavior = SpecialPowerModule ModuleTag_WoundArrow
		SpecialPowerTemplate      = SpecialAbilityWoundArrow
		UpdateModuleStartsAttack  = Yes
    		InitiateSound             = FaramirRangerVoiceWoundingArrow
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WoundArrowUpdate
		SpecialPowerTemplate    = SpecialAbilityWoundArrow
;		ForbiddenConditions  = MOUNTED

		SkipContinue			= Yes
		UnpackTime              = 2000 
		PreparationTime         = 1   
		PersistentPrepTime      = 1000 
		PackTime                = 1
		
		AwardXPForTriggering    = 0
		StartAbilityRange = 325.0 ; Note: This has to be smaller than the weapon range or it'll never succeed
		
		ApproachRequiresLOS		= Yes		
		
		SpecialWeapon = FaramirWoundArrow
		WhichSpecialWeapon = 1
	End
	
	Behavior = StealthUpdate ModuleTag_Stealth
		StealthDelay                = 0 ; msec
		StealthForbiddenConditions  = MOUNTED ATTACKING AWAY_FROM_TREES
		HintDetectableConditions    = IS_FIRING_WEAPON 
		FriendlyOpacityMin					= STEALTH_FRIENDLY_OPACITY_MIN ;10
		FriendlyOpacityMax					= STEALTH_FRIENDLY_OPACITY_MAX ;60
		DetectedByAnyoneRange		= 120
		PulseFrequency              = 750   ; msec
		OrderIdleEnemiesToAttackMeUponReveal  = Yes
	End

;
	Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
		LevelToGrant = 3
		MPOnly = Yes
	End

	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = No
  Shadow = SHADOW_DECAL
  ShadowSizeX = 20;
  ShadowSizeY = 20;
  ShadowTexture = ShadowI;
End

