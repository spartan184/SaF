;========================================================================
;=============== Generic Citadel Commandset Changes =====================
;========================================================================

CommandSet IsengardCastleKeepCommandSet
    ;1    = Command_ConstructIsengardSaruman
    1    = Command_GenericReviveSlot1
    2    = Command_GenericReviveSlot2
    3    = Command_GenericReviveSlot3
    4    = Command_GenericReviveSlot4
    5    = Command_GenericReviveSlot5
    6    = Command_GenericReviveSlot6
    9    = Command_StartCitadelSelfRepair
End
CommandSet MordorCampKeepCommandSet
    ;1    = Command_ConstructMordorSauron
    1   = Command_GenericReviveSlot1
    2   = Command_GenericReviveSlot2
    3   = Command_GenericReviveSlot3
    4    = Command_GenericReviveSlot4
    5    = Command_GenericReviveSlot5
    6    = Command_GenericReviveSlot6
    7    = Command_GenericReviveSlot7
    8    = Command_GenericReviveSlot8
    10    = Command_StartCitadelFoDSelfRepair
End

; -----------------------------------------------------------------------------------------------------------------------------
; CHANGED AIDATA FOR TEAM BUILDING TIMES AND WEALTHY/POOR STATES & ATTACKPRIORITY TO CORRECT FOR NEW	NUMBERS PUT IN BY COMES
; -----------------------------------------------------------------------------------------------------------------------------

AIData
  TeamSeconds                         = 10      ;Ai tries to build a new team every N seconds.
  Poor                                = 2000    ;   Number of resources for the AI to consider itself poor
  StructuresWealthyRate               = 1.0     ;  (2=twice as fast) Rate modifier for structure building when wealthy.
  StructuresPoorRate                  = 1.0     ;  (0.5=half as fast) Rate modifier for structures when poor.
  TeamsWealthyRate                    = 1.0     ;   (2=twice as fast) Rate modifier for teams building when wealthy.
  TeamsPoorRate                       = 0.7     ;  (0.5=half as fast) Rate modifier for teams when poor.

	AttackPriority DefaultAttackPriority
		Default 							= 1
		Target RohanEomer					= 2
		Target RohanEowyn					= 2
		Target RohanTheoden					= 2
		Target RohanGimli					= 2
		Target RohanLegolas					= 2
		Target RohanMerry					= 2
		Target RohanPippin					= 2
		Target RohanFrodo					= 2
		Target RohanSam						= 2
		Target GondorArcher					= 2
		Target GondorFighter					= 2
		Target RohanElvenWarrior				= 2
		Target RohanEntFir					= 2
		Target RohanGenericEnt					= 2
		Target RohanTreeBerd					= 2
		Target RohanEntAsh					= 2
		Target RohanEntBirch       				= 2
		Target RohanArcherHordeSkirmishFormation		= 2
		Target RohanElvenWarriorDoubleHorde			= 2
		Target RohanHobbitHordeFrodoSam				= 2
		Target RohanHobbitHordeMerryPippin			= 2
		Target RohanPeasantArcherComboHorde			= 2
		Target RohanRohirrimHordeWedgeFormation			= 2
		Target RohanRohirrimPeasantComboHorde			= 2
		Target RohanArcherHorde					= 2
		Target RohanElvenWarriorHorde				= 2
		Target RohanHobbitHorde					= 2
		Target RohanOathbreakerHorde				= 2
		Target RohanOathbreakerHordeSmall			= 2
		Target RohanPeasantHorde				= 2
		Target RohanRohirrimHorde				= 2
		Target RohanRohirrim					= 2
		Target RohanRohirrimBannerRider				= 2
		Target RohanRoyalGuard					= 2
		Target RohanFireArrowPorter				= 2
		Target RohanForgedBladesPorter				= 2
		Target RohanHeavyArmorPorter				= 2
		Target RohanHorseBowPorter				= 2
		Target RohanHorseShieldPorter				= 2
		Target RohanPeasant2					= 2
		Target RohanPeasant3					= 2
		Target RohanPeasant4					= 2
		Target RohanArcher					= 2
		Target RohanBanner					= 2
		Target RohanPeasant					= 2
		Target RohanPeasant1					= 2
		Target RohanPorterInterface				= 2
		Target RohanWorker					= 2
		Target RohanRefugeeCamp					= 0
		Target RohanRefugeeCampA				= 0
		Target RohanRefugeeCampB				= 0
		Target RohanRefugeeCampC				= 0
	End

	AttackPriority AttackPriority_Infantry
		Default 							= 1
		Target RohanEomer					= 2
		Target RohanEowyn					= 2
		Target RohanTheoden					= 2
		Target RohanGimli					= 2
		Target RohanLegolas					= 2
		Target RohanMerry					= 2
		Target RohanPippin					= 2
		Target RohanFrodo					= 2
		Target RohanSam						= 2
		Target GondorArcher					= 2
		Target GondorFighter					= 2
		Target RohanElvenWarrior				= 2
		Target RohanEntFir					= 2
		Target RohanGenericEnt					= 2
		Target RohanTreeBerd					= 2
		Target RohanEntAsh					= 2
		Target RohanEntBirch       				= 2
		Target RohanArcherHordeSkirmishFormation		= 2
		Target RohanElvenWarriorDoubleHorde			= 2
		Target RohanHobbitHordeFrodoSam				= 2
		Target RohanHobbitHordeMerryPippin			= 2
		Target RohanPeasantArcherComboHorde			= 2
		Target RohanRohirrimHordeWedgeFormation			= 2
		Target RohanRohirrimPeasantComboHorde			= 2
		Target RohanArcherHorde					= 2
		Target RohanElvenWarriorHorde				= 2
		Target RohanHobbitHorde					= 2
		Target RohanOathbreakerHorde				= 2
		Target RohanOathbreakerHordeSmall			= 2
		Target RohanPeasantHorde				= 2
		Target RohanRohirrimHorde				= 2
		Target RohanRohirrim					= 2
		Target RohanRohirrimBannerRider				= 2
		Target RohanRoyalGuard					= 2
		Target RohanFireArrowPorter				= 2
		Target RohanForgedBladesPorter				= 2
		Target RohanHeavyArmorPorter				= 2
		Target RohanHorseBowPorter				= 2
		Target RohanHorseShieldPorter				= 2
		Target RohanPeasant2					= 2
		Target RohanPeasant3					= 2
		Target RohanPeasant4					= 2
		Target RohanArcher					= 2
		Target RohanBanner					= 2
		Target RohanPeasant					= 2
		Target RohanPeasant1					= 2
		Target RohanPorterInterface				= 2
		Target RohanWorker					= 2
		Target RohanRefugeeCamp					= 0
		Target RohanRefugeeCampA				= 0
		Target RohanRefugeeCampB				= 0
		Target RohanRefugeeCampC				= 0
	End


	AttackPriority AttackPriority_Archer
		Default 							= 1
		Target RohanEomer					= 2
		Target RohanEowyn					= 2
		Target RohanTheoden					= 2
		Target RohanGimli					= 2
		Target RohanLegolas					= 2
		Target RohanMerry					= 2
		Target RohanPippin					= 2
		Target RohanFrodo					= 2
		Target RohanSam						= 2
		Target GondorArcher					= 2
		Target GondorFighter					= 2
		Target RohanElvenWarrior				= 2
		Target RohanEntFir					= 2
		Target RohanGenericEnt					= 2
		Target RohanTreeBerd					= 2
		Target RohanEntAsh					= 2
		Target RohanEntBirch       				= 2
		Target RohanArcherHordeSkirmishFormation		= 2
		Target RohanElvenWarriorDoubleHorde			= 2
		Target RohanHobbitHordeFrodoSam				= 2
		Target RohanHobbitHordeMerryPippin			= 2
		Target RohanPeasantArcherComboHorde			= 2
		Target RohanRohirrimHordeWedgeFormation			= 2
		Target RohanRohirrimPeasantComboHorde			= 2
		Target RohanArcherHorde					= 2
		Target RohanElvenWarriorHorde				= 2
		Target RohanHobbitHorde					= 2
		Target RohanOathbreakerHorde				= 2
		Target RohanOathbreakerHordeSmall			= 2
		Target RohanPeasantHorde				= 2
		Target RohanRohirrimHorde				= 2
		Target RohanRohirrim					= 2
		Target RohanRohirrimBannerRider				= 2
		Target RohanRoyalGuard					= 2
		Target RohanFireArrowPorter				= 2
		Target RohanForgedBladesPorter				= 2
		Target RohanHeavyArmorPorter				= 2
		Target RohanHorseBowPorter				= 2
		Target RohanHorseShieldPorter				= 2
		Target RohanPeasant2					= 2
		Target RohanPeasant3					= 2
		Target RohanPeasant4					= 2
		Target RohanArcher					= 2
		Target RohanBanner					= 2
		Target RohanPeasant					= 2
		Target RohanPeasant1					= 2
		Target RohanPorterInterface				= 2
		Target RohanWorker					= 2
		Target RohanRefugeeCamp					= 0
		Target RohanRefugeeCampA				= 0
		Target RohanRefugeeCampB				= 0
		Target RohanRefugeeCampC				= 0
	End

	AttackPriority AttackPriority_Spearman
		Default 							= 1
		Target RohanEomer					= 2
		Target RohanEowyn					= 2
		Target RohanTheoden					= 2
		Target RohanGimli					= 2
		Target RohanLegolas					= 2
		Target RohanMerry					= 2
		Target RohanPippin					= 2
		Target RohanFrodo					= 2
		Target RohanSam						= 2
		Target GondorArcher					= 2
		Target GondorFighter					= 2
		Target RohanElvenWarrior				= 2
		Target RohanEntFir					= 2
		Target RohanGenericEnt					= 2
		Target RohanTreeBerd					= 2
		Target RohanEntAsh					= 2
		Target RohanEntBirch       				= 2
		Target RohanArcherHordeSkirmishFormation		= 2
		Target RohanElvenWarriorDoubleHorde			= 2
		Target RohanHobbitHordeFrodoSam				= 2
		Target RohanHobbitHordeMerryPippin			= 2
		Target RohanPeasantArcherComboHorde			= 2
		Target RohanRohirrimHordeWedgeFormation			= 2
		Target RohanRohirrimPeasantComboHorde			= 2
		Target RohanArcherHorde					= 2
		Target RohanElvenWarriorHorde				= 2
		Target RohanHobbitHorde					= 2
		Target RohanOathbreakerHorde				= 2
		Target RohanOathbreakerHordeSmall			= 2
		Target RohanPeasantHorde				= 2
		Target RohanRohirrimHorde				= 2
		Target RohanRohirrim					= 2
		Target RohanRohirrimBannerRider				= 2
		Target RohanRoyalGuard					= 2
		Target RohanFireArrowPorter				= 2
		Target RohanForgedBladesPorter				= 2
		Target RohanHeavyArmorPorter				= 2
		Target RohanHorseBowPorter				= 2
		Target RohanHorseShieldPorter				= 2
		Target RohanPeasant2					= 2
		Target RohanPeasant3					= 2
		Target RohanPeasant4					= 2
		Target RohanArcher					= 2
		Target RohanBanner					= 2
		Target RohanPeasant					= 2
		Target RohanPeasant1					= 2
		Target RohanPorterInterface				= 2
		Target RohanWorker					= 2
		Target RohanRefugeeCamp					= 0
		Target RohanRefugeeCampA				= 0
		Target RohanRefugeeCampB				= 0
		Target RohanRefugeeCampC				= 0
	End
  
	AttackPriority AttackPriority_Cavalry
		Default 							= 1
		Target RohanEomer					= 2
		Target RohanEowyn					= 2
		Target RohanTheoden					= 2
		Target RohanGimli					= 2
		Target RohanLegolas					= 2
		Target RohanMerry					= 2
		Target RohanPippin					= 2
		Target RohanFrodo					= 2
		Target RohanSam						= 2
		Target GondorArcher					= 2
		Target GondorFighter					= 2
		Target RohanElvenWarrior				= 2
		Target RohanEntFir					= 2
		Target RohanGenericEnt					= 2
		Target RohanTreeBerd					= 2
		Target RohanEntAsh					= 2
		Target RohanEntBirch       				= 2
		Target RohanArcherHordeSkirmishFormation		= 2
		Target RohanElvenWarriorDoubleHorde			= 2
		Target RohanHobbitHordeFrodoSam				= 2
		Target RohanHobbitHordeMerryPippin			= 2
		Target RohanPeasantArcherComboHorde			= 2
		Target RohanRohirrimHordeWedgeFormation			= 2
		Target RohanRohirrimPeasantComboHorde			= 2
		Target RohanArcherHorde					= 2
		Target RohanElvenWarriorHorde				= 2
		Target RohanHobbitHorde					= 2
		Target RohanOathbreakerHorde				= 2
		Target RohanOathbreakerHordeSmall			= 2
		Target RohanPeasantHorde				= 2
		Target RohanRohirrimHorde				= 2
		Target RohanRohirrim					= 2
		Target RohanRohirrimBannerRider				= 2
		Target RohanRoyalGuard					= 2
		Target RohanFireArrowPorter				= 2
		Target RohanForgedBladesPorter				= 2
		Target RohanHeavyArmorPorter				= 2
		Target RohanHorseBowPorter				= 2
		Target RohanHorseShieldPorter				= 2
		Target RohanPeasant2					= 2
		Target RohanPeasant3					= 2
		Target RohanPeasant4					= 2
		Target RohanArcher					= 2
		Target RohanBanner					= 2
		Target RohanPeasant					= 2
		Target RohanPeasant1					= 2
		Target RohanPorterInterface				= 2
		Target RohanWorker					= 2
		Target RohanRefugeeCamp					= 0
		Target RohanRefugeeCampA				= 0
		Target RohanRefugeeCampB				= 0
		Target RohanRefugeeCampC				= 0
	End
END


; --------------------------------------------------------------------------------------------------------
; Prebuild Setup for North Camp
; --------------------------------------------------------------------------------------------------------

Object PreBuiltCampFlag_03 ;North Camp

 ReplaceModule ModuleTag_castle
  Behavior = CastleBehavior ModuleTag_castlePlayer
     SidesAllowed = Gondor FROM_PLAYER FROM_AI FROM_SCRIPT
     SidesAllowed = Isengard FROM_PLAYER FROM_AI FROM_SCRIPT
     SidesAllowed = Mordor FROM_PLAYER FROM_AI FROM_SCRIPT
     SidesAllowed = Rohan FROM_PLAYER FROM_AI FROM_SCRIPT
     UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.

  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes
  	CastleToUnpackForFaction  = Gondor  Camp_GondorSW GONDOR_FLAG_CAMP_UNPACK_COST
  	CastleToUnpackForFaction  = Mordor  Camp_MordorSW MORDOR_FLAG_CAMP_UNPACK_COST 
  	CastleToUnpackForFaction  = Isengard  Camp_IsengardSW ISENGARD_FLAG_CAMP_UNPACK_COST
  	CastleToUnpackForFaction  = Rohan  Camp_RohanSW ROHAN_FLAG_CAMP_UNPACK_COST 

     PreBuiltList = RohanStable 0 
     PreBuiltList = RohanFarm 1
     PreBuiltList = RohanFarm 2
     PreBuiltList = RohanArcherRange 3
     PreBuiltList = RohanHeroStatue 4
     PreBuiltList = RohanArmory 5
     PreBuiltList = RohanSentryTower 0
     PreBuiltList = RohanSentryTower 1
     PreBuiltList = RohanSentryTower 2
     PreBuiltList = RohanSentryTower 3
     PreBuiltList = RohanSentryTower 4
     PreBuiltList = RohanSentryTower 5
     PreBuiltList = RohanSentryTower 6
     PreBuiltPlyr = RohanNorthCamp

     MaxCastleRadius = 280.0
     FadeTime = 2.0 ; 2 seconds
  End
 End

END

; --------------------------------------------------------------------------------------------------------
; Prebuild Setup for South Camp
; --------------------------------------------------------------------------------------------------------

Object PreBuiltCampFlag_02 ;South Camp

 ReplaceModule ModuleTag_castle
  Behavior = CastleBehavior ModuleTag_castlePlayer
     SidesAllowed = Gondor FROM_PLAYER FROM_AI FROM_SCRIPT
     SidesAllowed = Isengard FROM_PLAYER FROM_AI FROM_SCRIPT
     SidesAllowed = Mordor FROM_PLAYER FROM_AI FROM_SCRIPT
     SidesAllowed = Rohan FROM_PLAYER FROM_AI FROM_SCRIPT
     UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.

  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes
  	CastleToUnpackForFaction  = Gondor  Camp_GondorNW GONDOR_FLAG_CAMP_UNPACK_COST
  	CastleToUnpackForFaction  = Mordor  Camp_MordorNW MORDOR_FLAG_CAMP_UNPACK_COST 
  	CastleToUnpackForFaction  = Isengard  Camp_IsengardNW ISENGARD_FLAG_CAMP_UNPACK_COST
  	CastleToUnpackForFaction  = Rohan  Camp_RohanNW ROHAN_FLAG_CAMP_UNPACK_COST  

     PreBuiltList = RohanArmory 0
     PreBuiltList = RohanFarm 1
     PreBuiltList = RohanFarm 2
     PreBuiltList = RohanBarracks 3
     PreBuiltList = RohanArcherRange 4
     PreBuiltList = RohanFarm 5
     PreBuiltList = RohanSentryTower 0
     PreBuiltList = RohanSentryTower 1
     PreBuiltList = RohanSentryTower 2
     PreBuiltList = RohanSentryTower 3
     PreBuiltList = RohanSentryTower 4
     PreBuiltList = RohanSentryTower 5
     PreBuiltList = RohanSentryTower 6
     PreBuiltPlyr = RohanSouthCamp

     MaxCastleRadius = 280.0
     FadeTime = 2.0 ; 2 seconds
  End
 End

END

; --------------------------------------------------------------------------------------------------------
;; Override armor on gates
; --------------------------------------------------------------------------------------------------------
Object IsengardOrthancDoor
  ArmorSet
    Conditions        = None
    Armor             = EvilEdorasCastleGateArmor
    DamageFX          = GateDamageFX
  End
End

Object RohanCastleDoor
  ArmorSet
    Conditions        = None
    Armor             = EvilEdorasCastleGateArmor
    DamageFX          = GateDamageFX
  End
End

Object RohanEdorasDoor
  ArmorSet
    Conditions        = None
    Armor             = EvilEdorasCastleGateArmor
    DamageFX          = GateDamageFX
  End
End

Object GBMGateDoor
  ArmorSet
    Conditions        = None
    Armor             = EvilEdorasCastleGateArmor
    DamageFX          = GateDamageFX
  End
End

; --------------------------------------------------------------------------------------------------------
; Refugee Camps now drop crates when destroyed
; --------------------------------------------------------------------------------------------------------

Object RohanRefugeeCamp
  ReplaceModule ModuleTag_05
    Body           = StructureBody ModuleTag_05MEEd
      MaxHealth    = 500.0
    End
  End

  AddModule
    Behavior       = CreateObjectDie ModuleTag_TreasureChestMEEd
      CreationList = OCL_SpawnTreasureChestMEEd
    End
  End
END

Object RohanRefugeeCampB
  ReplaceModule ModuleTag_05
    Body           = StructureBody ModuleTag_05MEEd
      MaxHealth    = 500.0
    End
  End

  AddModule
    Behavior       = CreateObjectDie ModuleTag_TreasureChestMEEd
      CreationList = OCL_SpawnTreasureChestMEEd
    End
  End
END

Object RohanRefugeeCampC
  ReplaceModule ModuleTag_05
    Body           = StructureBody ModuleTag_05MEEd
      MaxHealth    = 500.0
    End
  End

  AddModule
    Behavior       = CreateObjectDie ModuleTag_TreasureChestMEEd
      CreationList = OCL_SpawnTreasureChestMEEd
    End
  End
END

Object RohanRefugeeCampA
  ReplaceModule ModuleTag_05
    Body           = StructureBody ModuleTag_05MEEd
      MaxHealth    = 500.0
    End
  End

  AddModule
    Behavior       = CreateObjectDie ModuleTag_TreasureChestMEEd
      CreationList = OCL_SpawnTreasureChestMEEd
    End
  End
END

Object HorseGrazing1
  AddModule
    Behavior       = CreateObjectDie ModuleTag_TreasureChestMEEd
      CreationList = OCL_SpawnTreasureChestMEEd
    End
  End
END

Object HorseGrazing2
  AddModule
    Behavior       = CreateObjectDie ModuleTag_TreasureChestMEEd
      CreationList = OCL_SpawnTreasureChestMEEd
    End
  End
END

Object HorseGrazing3
  AddModule
    Behavior       = CreateObjectDie ModuleTag_TreasureChestMEEd
      CreationList = OCL_SpawnTreasureChestMEEd
    End
  End
END

Object HorseGrazing4
  AddModule
    Behavior       = CreateObjectDie ModuleTag_TreasureChestMEEd
      CreationList = OCL_SpawnTreasureChestMEEd
    End
  End
END

Object RBCampFence
  KindOf = +CAN_SEE_THROUGH_STRUCTURE
END

; --------------------------------------------------------------------------------------------------------
; Trying to get the stupid animals to not charge or wander all over
; --------------------------------------------------------------------------------------------------------

Object HorseGrazing
  ReplaceModule ModuleTagWanderAround
    Behavior = AnimalAIUpdate ModuleTag_WanderAroundButNotSoMuch
      FleeRange         =  20       ;how close enemies have to be before we panic
      FleeDistance      =  40       ;how far the animal will run once spooked
      WanderPercentage  =   5       ;percentage of the time we should move
      MaxWanderDistance =  20       ;maximum distance to move at once
      MaxWanderRadius   =  20       ;how far to wander on our own
      UpdateTimer       =  11       ;how often do we want to check for enemies
      AfraidOfCastles   =  No 
    End
  End
END

Object Chicken
  ReplaceModule ModuleTagWanderAround
    Behavior = AnimalAIUpdate ModuleTag_WanderAroundButNotSoMuch
      FleeRange         =  10       ;how close enemies have to be before we panic
      FleeDistance      =  20       ;how far the animal will run once spooked
      WanderPercentage  =   5       ;percentage of the time we should move
      MaxWanderDistance =  10       ;maximum distance to move at once
      MaxWanderRadius   =  10       ;how far to wander on our own
      UpdateTimer       =  11       ;how often do we want to check for enemies
      AfraidOfCastles   =  No 
    End
  End
END

Object Pig
  ReplaceModule ModuleTagWanderAround
    Behavior = AnimalAIUpdate ModuleTag_WanderAroundButNotSoMuch
      FleeRange         =  10       ;how close enemies have to be before we panic
      FleeDistance      =  20       ;how far the animal will run once spooked
      WanderPercentage  =   5       ;percentage of the time we should move
      MaxWanderDistance =  10       ;maximum distance to move at once
      MaxWanderRadius   =  10       ;how far to wander on our own
      UpdateTimer       =  11       ;how often do we want to check for enemies
      AfraidOfCastles   =  No 
    End
  End
END

Object Dog
  ReplaceModule ModuleTagWanderAround
    Behavior = AnimalAIUpdate ModuleTag_WanderAroundButNotSoMuch
      FleeRange         =  10       ;how close enemies have to be before we panic
      FleeDistance      =  20       ;how far the animal will run once spooked
      WanderPercentage  =   5       ;percentage of the time we should move
      MaxWanderDistance =  10       ;maximum distance to move at once
      MaxWanderRadius   =  10       ;how far to wander on our own
      UpdateTimer       =  11       ;how often do we want to check for enemies
      AfraidOfCastles   =  No 
    End
  End
END

Object Rabbit
  ReplaceModule ModuleTagWanderAround
    Behavior = AnimalAIUpdate ModuleTag_WanderAroundButNotSoMuch
      FleeRange         =  10       ;how close enemies have to be before we panic
      FleeDistance      =  20       ;how far the animal will run once spooked
      WanderPercentage  =   5       ;percentage of the time we should move
      MaxWanderDistance =  10       ;maximum distance to move at once
      MaxWanderRadius   =  10       ;how far to wander on our own
      UpdateTimer       =  11       ;how often do we want to check for enemies
      AfraidOfCastles   =  No 
    End
  End
END
















